   1              		.syntax unified
   2              		.cpu cortex-m3
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 6
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.thumb
  14              		.file	"IEEE802154_security.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.section	.rodata
  19              		.align	2
  22              	rreg_uriquery:
  23 0000 683D7563 		.ascii	"h=ucb\000"
  23      6200
  24 0006 0000     		.align	2
  27              	infoBoardname:
  28 0008 43433235 		.ascii	"CC2538\000"
  28      333800
  29 000f 00       		.align	2
  32              	infouCName:
  33 0010 43433235 		.ascii	"CC2538\000"
  33      333800
  34 0017 00       		.align	2
  37              	infoRadioName:
  38 0018 43433235 		.ascii	"CC2538 SoC\000"
  38      33382053 
  38      6F4300
  39 0023 00       		.align	2
  42              	infoStackName:
  43 0024 4F70656E 		.ascii	"OpenWSN \000"
  43      57534E20 
  43      00
  44 002d 000000   		.align	2
  47              	chTemplate_default:
  48 0030 05       		.byte	5
  49 0031 06       		.byte	6
  50 0032 0C       		.byte	12
  51 0033 07       		.byte	7
  52 0034 0F       		.byte	15
  53 0035 04       		.byte	4
  54 0036 0E       		.byte	14
  55 0037 0B       		.byte	11
  56 0038 08       		.byte	8
  57 0039 00       		.byte	0
  58 003a 01       		.byte	1
  59 003b 02       		.byte	2
  60 003c 0D       		.byte	13
  61 003d 03       		.byte	3
  62 003e 09       		.byte	9
  63 003f 0A       		.byte	10
  64              		.align	2
  67              	all_routers_multicast:
  68 0040 FF       		.byte	-1
  69 0041 02       		.byte	2
  70 0042 00       		.byte	0
  71 0043 00       		.byte	0
  72 0044 00       		.byte	0
  73 0045 00       		.byte	0
  74 0046 00       		.byte	0
  75 0047 00       		.byte	0
  76 0048 00       		.byte	0
  77 0049 00       		.byte	0
  78 004a 00       		.byte	0
  79 004b 00       		.byte	0
  80 004c 00       		.byte	0
  81 004d 00       		.byte	0
  82 004e 00       		.byte	0
  83 004f 1A       		.byte	26
  84              		.comm	ieee802154_security_vars,1164,4
  85              		.text
  86              		.align	2
  87              		.global	IEEE802154_security_init
  88              		.thumb
  89              		.thumb_func
  91              	IEEE802154_security_init:
  92              	.LFB0:
  93              		.file 1 "build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c"
   1:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** /**
   2:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** \brief Security operations defined by IEEE802.15.4e standard
   3:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
   4:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** \author Savio Sciancalepore <savio.sciancalepore@poliba.it>, June 2015.
   5:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** \author Giuseppe Piro <giuseppe.piro@poliba.it> June 2015.
   6:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** \author Gennaro Boggia <gennaro.boggia@poliba.it> June 2015.
   7:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** \author Luigi Alfredo Grieco <alfredo.grieco@poliba.it>, June 2015.
   8:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** \author Malisa Vucinic <malishav@gmail.com>, June 2015.
   9:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** */
  10:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
  11:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** #include "packetfunctions.h"
  12:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** #include "crypto_engine.h"
  13:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** #include "IEEE802154.h"
  14:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** #include "IEEE802154E.h"
  15:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** #include "idmanager.h"
  16:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** #include "openserial.h"
  17:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** #include "IEEE802154_security.h"
  18:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
  19:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** //=============================define==========================================
  20:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
  21:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** //=========================== variables =======================================
  22:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
  23:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** ieee802154_security_vars_t ieee802154_security_vars;
  24:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
  25:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** //=========================== prototypes ======================================
  26:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
  27:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** void IEEE802154_security_getFrameCounter(macFrameCounter_t reference,
  28:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                          uint8_t*          array);
  29:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** uint8_t IEEE802154_security_authLengthChecking(uint8_t securityLevel);
  30:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
  31:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** uint8_t IEEE802154_security_auxLengthChecking(uint8_t KeyIdMode,
  32:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                               uint8_t    frameCounterSuppression,
  33:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                               uint8_t frameCounterSize);
  34:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
  35:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** bool IEEE802154_security_incomingKeyUsagePolicyChecking(m_keyDescriptor* keydesc,
  36:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                         uint8_t          frameType,
  37:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                         uint8_t          cfi);
  38:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
  39:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** bool IEEE802154_security_incomingSecurityLevelChecking(m_securityLevelDescriptor* secLevDesc,
  40:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                        uint8_t                    secLevel,
  41:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                        bool                       exempt);
  42:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
  43:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** m_securityLevelDescriptor* IEEE802154_security_securityLevelDescriptorLookup(uint8_t frameType,
  44:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                                              uint8_t cfi);
  45:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
  46:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** m_deviceDescriptor* IEEE802154_security_deviceDescriptorLookup(open_addr_t*     address,
  47:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                                open_addr_t*     PANID,
  48:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                                m_keyDescriptor* keyDescriptor);
  49:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
  50:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** m_keyDescriptor* IEEE802154_security_keyDescriptorLookup(uint8_t      KeyIdMode,
  51:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                          open_addr_t* keySource,
  52:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                          uint8_t      KeyIndex,
  53:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                          open_addr_t* DeviceAddress,
  54:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                          open_addr_t* panID,
  55:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                          uint8_t      frameType);
  56:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
  57:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** //=========================== admin ===========================================
  58:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
  59:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** /**
  60:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** \brief Initialization of security tables and parameters.
  61:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** */
  62:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** void IEEE802154_security_init(void) {
  94              		.loc 1 62 0
  95              		.cfi_startproc
  96              		@ args = 0, pretend = 0, frame = 8
  97              		@ frame_needed = 1, uses_anonymous_args = 0
  98 0000 B0B5     		push	{r4, r5, r7, lr}
  99              		.cfi_def_cfa_offset 16
 100              		.cfi_offset 4, -16
 101              		.cfi_offset 5, -12
 102              		.cfi_offset 7, -8
 103              		.cfi_offset 14, -4
 104 0002 82B0     		sub	sp, sp, #8
 105              		.cfi_def_cfa_offset 24
 106 0004 00AF     		add	r7, sp, #0
 107              		.cfi_def_cfa_register 7
  63:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t i;
  64:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
  65:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //Setting UP Phase
  66:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
  67:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //KEY 1: '6TiSCH minimal15' - used to authenticate beacon frames
  68:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    memset(&ieee802154_security_vars.Key_1[0], 0, 16);
 108              		.loc 1 68 0
 109 0006 4A48     		ldr	r0, .L6
 110 0008 0021     		movs	r1, #0
 111 000a 1022     		movs	r2, #16
 112 000c FFF7FEFF 		bl	memset
  69:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_1[0] = 0x36;
 113              		.loc 1 69 0
 114 0010 484B     		ldr	r3, .L6+4
 115 0012 3622     		movs	r2, #54
 116 0014 83F86A24 		strb	r2, [r3, #1130]
  70:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_1[1] = 0x54;
 117              		.loc 1 70 0
 118 0018 464B     		ldr	r3, .L6+4
 119 001a 5422     		movs	r2, #84
 120 001c 83F86B24 		strb	r2, [r3, #1131]
  71:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_1[2] = 0x69;
 121              		.loc 1 71 0
 122 0020 444B     		ldr	r3, .L6+4
 123 0022 6922     		movs	r2, #105
 124 0024 83F86C24 		strb	r2, [r3, #1132]
  72:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_1[3] = 0x53;
 125              		.loc 1 72 0
 126 0028 424B     		ldr	r3, .L6+4
 127 002a 5322     		movs	r2, #83
 128 002c 83F86D24 		strb	r2, [r3, #1133]
  73:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_1[4] = 0x43;
 129              		.loc 1 73 0
 130 0030 404B     		ldr	r3, .L6+4
 131 0032 4322     		movs	r2, #67
 132 0034 83F86E24 		strb	r2, [r3, #1134]
  74:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_1[5] = 0x48;
 133              		.loc 1 74 0
 134 0038 3E4B     		ldr	r3, .L6+4
 135 003a 4822     		movs	r2, #72
 136 003c 83F86F24 		strb	r2, [r3, #1135]
  75:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_1[6] = 0x20;
 137              		.loc 1 75 0
 138 0040 3C4B     		ldr	r3, .L6+4
 139 0042 2022     		movs	r2, #32
 140 0044 83F87024 		strb	r2, [r3, #1136]
  76:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_1[7] = 0x6d;
 141              		.loc 1 76 0
 142 0048 3A4B     		ldr	r3, .L6+4
 143 004a 6D22     		movs	r2, #109
 144 004c 83F87124 		strb	r2, [r3, #1137]
  77:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_1[8] = 0x69;
 145              		.loc 1 77 0
 146 0050 384B     		ldr	r3, .L6+4
 147 0052 6922     		movs	r2, #105
 148 0054 83F87224 		strb	r2, [r3, #1138]
  78:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_1[9] = 0x6e;
 149              		.loc 1 78 0
 150 0058 364B     		ldr	r3, .L6+4
 151 005a 6E22     		movs	r2, #110
 152 005c 83F87324 		strb	r2, [r3, #1139]
  79:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_1[10] = 0x69;
 153              		.loc 1 79 0
 154 0060 344B     		ldr	r3, .L6+4
 155 0062 6922     		movs	r2, #105
 156 0064 83F87424 		strb	r2, [r3, #1140]
  80:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_1[11] = 0x6d;
 157              		.loc 1 80 0
 158 0068 324B     		ldr	r3, .L6+4
 159 006a 6D22     		movs	r2, #109
 160 006c 83F87524 		strb	r2, [r3, #1141]
  81:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_1[12] = 0x61;
 161              		.loc 1 81 0
 162 0070 304B     		ldr	r3, .L6+4
 163 0072 6122     		movs	r2, #97
 164 0074 83F87624 		strb	r2, [r3, #1142]
  82:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_1[13] = 0x6c;
 165              		.loc 1 82 0
 166 0078 2E4B     		ldr	r3, .L6+4
 167 007a 6C22     		movs	r2, #108
 168 007c 83F87724 		strb	r2, [r3, #1143]
  83:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_1[14] = 0x31;
 169              		.loc 1 83 0
 170 0080 2C4B     		ldr	r3, .L6+4
 171 0082 3122     		movs	r2, #49
 172 0084 83F87824 		strb	r2, [r3, #1144]
  84:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_1[15] = 0x35;
 173              		.loc 1 84 0
 174 0088 2A4B     		ldr	r3, .L6+4
 175 008a 3522     		movs	r2, #53
 176 008c 83F87924 		strb	r2, [r3, #1145]
  85:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
  86:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //Initialization of the MAC Security Level Table
  87:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    for (i = 0; i < IEEE154_TYPE_UNDEFINED; i++) { // iterate through all frame types
 177              		.loc 1 87 0
 178 0090 0023     		movs	r3, #0
 179 0092 FB71     		strb	r3, [r7, #7]
 180 0094 83E0     		b	.L2
 181              	.L5:
  88:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i].FrameType = i;
 182              		.loc 1 88 0
 183 0096 FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 184 0098 2649     		ldr	r1, .L6+4
 185 009a 1346     		mov	r3, r2
 186 009c 9B00     		lsls	r3, r3, #2
 187 009e 1344     		add	r3, r3, r2
 188 00a0 5B00     		lsls	r3, r3, #1
 189 00a2 1344     		add	r3, r3, r2
 190 00a4 0B44     		add	r3, r3, r1
 191 00a6 03F58663 		add	r3, r3, #1072
 192 00aa FA79     		ldrb	r2, [r7, #7]
 193 00ac DA70     		strb	r2, [r3, #3]
  89:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i].CommandFrameIdentif
 194              		.loc 1 89 0
 195 00ae FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 196 00b0 2049     		ldr	r1, .L6+4
 197 00b2 1346     		mov	r3, r2
 198 00b4 9B00     		lsls	r3, r3, #2
 199 00b6 1344     		add	r3, r3, r2
 200 00b8 5B00     		lsls	r3, r3, #1
 201 00ba 1344     		add	r3, r3, r2
 202 00bc 0B44     		add	r3, r3, r1
 203 00be 03F58663 		add	r3, r3, #1072
 204 00c2 0022     		movs	r2, #0
 205 00c4 1A71     		strb	r2, [r3, #4]
  90:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i].DeviceOverrideSecur
 206              		.loc 1 90 0
 207 00c6 FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 208 00c8 1A49     		ldr	r1, .L6+4
 209 00ca 1346     		mov	r3, r2
 210 00cc 9B00     		lsls	r3, r3, #2
 211 00ce 1344     		add	r3, r3, r2
 212 00d0 5B00     		lsls	r3, r3, #1
 213 00d2 1344     		add	r3, r3, r2
 214 00d4 0B44     		add	r3, r3, r1
 215 00d6 03F58663 		add	r3, r3, #1072
 216 00da 0022     		movs	r2, #0
 217 00dc 9A71     		strb	r2, [r3, #6]
  91:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       //list of allowed security levels
  92:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if (i == IEEE154_TYPE_BEACON){   // beacons can only be authenticated but not encrypted
 218              		.loc 1 92 0
 219 00de FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 220 00e0 002B     		cmp	r3, #0
 221 00e2 29D1     		bne	.L3
  93:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i].AllowedSecurityL
 222              		.loc 1 93 0
 223 00e4 FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 224 00e6 1349     		ldr	r1, .L6+4
 225 00e8 1346     		mov	r3, r2
 226 00ea 9B00     		lsls	r3, r3, #2
 227 00ec 1344     		add	r3, r3, r2
 228 00ee 5B00     		lsls	r3, r3, #1
 229 00f0 1344     		add	r3, r3, r2
 230 00f2 0B44     		add	r3, r3, r1
 231 00f4 03F58663 		add	r3, r3, #1072
 232 00f8 0122     		movs	r2, #1
 233 00fa DA71     		strb	r2, [r3, #7]
  94:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i].AllowedSecurityL
 234              		.loc 1 94 0
 235 00fc FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 236 00fe 0D49     		ldr	r1, .L6+4
 237 0100 1346     		mov	r3, r2
 238 0102 9B00     		lsls	r3, r3, #2
 239 0104 1344     		add	r3, r3, r2
 240 0106 5B00     		lsls	r3, r3, #1
 241 0108 1344     		add	r3, r3, r2
 242 010a 0B44     		add	r3, r3, r1
 243 010c 03F23143 		addw	r3, r3, #1073
 244 0110 0222     		movs	r2, #2
 245 0112 DA71     		strb	r2, [r3, #7]
  95:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i].AllowedSecurityL
 246              		.loc 1 95 0
 247 0114 FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 248 0116 0749     		ldr	r1, .L6+4
 249 0118 1346     		mov	r3, r2
 250 011a 9B00     		lsls	r3, r3, #2
 251 011c 1344     		add	r3, r3, r2
 252 011e 5B00     		lsls	r3, r3, #1
 253 0120 1344     		add	r3, r3, r2
 254 0122 0B44     		add	r3, r3, r1
 255 0124 03F23243 		addw	r3, r3, #1074
 256 0128 0322     		movs	r2, #3
 257 012a DA71     		strb	r2, [r3, #7]
 258 012c 28E0     		b	.L4
 259              	.L7:
 260 012e 00BF     		.align	2
 261              	.L6:
 262 0130 6A040000 		.word	ieee802154_security_vars+1130
 263 0134 00000000 		.word	ieee802154_security_vars
 264              	.L3:
  96:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       } else { // all other frame types are encrypted + authenticated
  97:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i].AllowedSecurityL
 265              		.loc 1 97 0
 266 0138 FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 267 013a A749     		ldr	r1, .L8
 268 013c 1346     		mov	r3, r2
 269 013e 9B00     		lsls	r3, r3, #2
 270 0140 1344     		add	r3, r3, r2
 271 0142 5B00     		lsls	r3, r3, #1
 272 0144 1344     		add	r3, r3, r2
 273 0146 0B44     		add	r3, r3, r1
 274 0148 03F58663 		add	r3, r3, #1072
 275 014c 0522     		movs	r2, #5
 276 014e DA71     		strb	r2, [r3, #7]
  98:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i].AllowedSecurityL
 277              		.loc 1 98 0
 278 0150 FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 279 0152 A149     		ldr	r1, .L8
 280 0154 1346     		mov	r3, r2
 281 0156 9B00     		lsls	r3, r3, #2
 282 0158 1344     		add	r3, r3, r2
 283 015a 5B00     		lsls	r3, r3, #1
 284 015c 1344     		add	r3, r3, r2
 285 015e 0B44     		add	r3, r3, r1
 286 0160 03F23143 		addw	r3, r3, #1073
 287 0164 0622     		movs	r2, #6
 288 0166 DA71     		strb	r2, [r3, #7]
  99:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i].AllowedSecurityL
 289              		.loc 1 99 0
 290 0168 FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 291 016a 9B49     		ldr	r1, .L8
 292 016c 1346     		mov	r3, r2
 293 016e 9B00     		lsls	r3, r3, #2
 294 0170 1344     		add	r3, r3, r2
 295 0172 5B00     		lsls	r3, r3, #1
 296 0174 1344     		add	r3, r3, r2
 297 0176 0B44     		add	r3, r3, r1
 298 0178 03F23243 		addw	r3, r3, #1074
 299 017c 0722     		movs	r2, #7
 300 017e DA71     		strb	r2, [r3, #7]
 301              	.L4:
 100:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       }
 101:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i].SecurityMinimum = I
 302              		.loc 1 101 0 discriminator 2
 303 0180 FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 304 0182 9549     		ldr	r1, .L8
 305 0184 1346     		mov	r3, r2
 306 0186 9B00     		lsls	r3, r3, #2
 307 0188 1344     		add	r3, r3, r2
 308 018a 5B00     		lsls	r3, r3, #1
 309 018c 1344     		add	r3, r3, r2
 310 018e 0B44     		add	r3, r3, r1
 311 0190 03F58663 		add	r3, r3, #1072
 312 0194 0522     		movs	r2, #5
 313 0196 5A71     		strb	r2, [r3, #5]
  87:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i].FrameType = i;
 314              		.loc 1 87 0 discriminator 2
 315 0198 FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 316 019a 0133     		adds	r3, r3, #1
 317 019c FB71     		strb	r3, [r7, #7]
 318              	.L2:
  87:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i].FrameType = i;
 319              		.loc 1 87 0 is_stmt 0 discriminator 1
 320 019e FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 321 01a0 042B     		cmp	r3, #4
 322 01a2 7FF678AF 		bls	.L5
 102:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 103:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 104:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //Initialization of MAC KEY TABLE
 105:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    memset(&ieee802154_security_vars.MacKeyTable,
 323              		.loc 1 105 0 is_stmt 1
 324 01a6 8D48     		ldr	r0, .L8+4
 325 01a8 0021     		movs	r1, #0
 326 01aa 4FF45272 		mov	r2, #840
 327 01ae FFF7FEFF 		bl	memset
 106:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****           0,
 107:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****           sizeof(m_macKeyTable));
 108:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 109:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //Initialization of MAC DEVICE TABLE
 110:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    memset(&ieee802154_security_vars.MacDeviceTable,
 328              		.loc 1 110 0
 329 01b2 8B48     		ldr	r0, .L8+8
 330 01b4 0021     		movs	r1, #0
 331 01b6 CF22     		movs	r2, #207
 332 01b8 FFF7FEFF 		bl	memset
 111:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****           0,
 112:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****           sizeof(m_macDeviceTable));
 113:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 114:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //Initialization of Frame Counter
 115:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.m_macFrameCounterMode = 0x05; // For TSCH, we use implicit 5 byte Frame
 333              		.loc 1 115 0
 334 01bc 864B     		ldr	r3, .L8
 335 01be 0522     		movs	r2, #5
 336 01c0 5A71     		strb	r2, [r3, #5]
 116:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 117:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //macDefaultKeySource - shared
 118:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.m_macDefaultKeySource.type = ADDR_64B;
 337              		.loc 1 118 0
 338 01c2 854B     		ldr	r3, .L8
 339 01c4 0222     		movs	r2, #2
 340 01c6 5A72     		strb	r2, [r3, #9]
 119:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.m_macDefaultKeySource.addr_64b[0] = 0x14;
 341              		.loc 1 119 0
 342 01c8 834B     		ldr	r3, .L8
 343 01ca 1422     		movs	r2, #20
 344 01cc 9A72     		strb	r2, [r3, #10]
 120:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.m_macDefaultKeySource.addr_64b[1] = 0x15;
 345              		.loc 1 120 0
 346 01ce 824B     		ldr	r3, .L8
 347 01d0 1522     		movs	r2, #21
 348 01d2 DA72     		strb	r2, [r3, #11]
 121:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.m_macDefaultKeySource.addr_64b[2] = 0x92;
 349              		.loc 1 121 0
 350 01d4 804B     		ldr	r3, .L8
 351 01d6 9222     		movs	r2, #146
 352 01d8 1A73     		strb	r2, [r3, #12]
 122:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.m_macDefaultKeySource.addr_64b[3] = 0x00;
 353              		.loc 1 122 0
 354 01da 7F4B     		ldr	r3, .L8
 355 01dc 0022     		movs	r2, #0
 356 01de 5A73     		strb	r2, [r3, #13]
 123:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.m_macDefaultKeySource.addr_64b[4] = 0x00;
 357              		.loc 1 123 0
 358 01e0 7D4B     		ldr	r3, .L8
 359 01e2 0022     		movs	r2, #0
 360 01e4 9A73     		strb	r2, [r3, #14]
 124:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.m_macDefaultKeySource.addr_64b[5] = 0x15;
 361              		.loc 1 124 0
 362 01e6 7C4B     		ldr	r3, .L8
 363 01e8 1522     		movs	r2, #21
 364 01ea DA73     		strb	r2, [r3, #15]
 125:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.m_macDefaultKeySource.addr_64b[6] = 0x16;
 365              		.loc 1 125 0
 366 01ec 7A4B     		ldr	r3, .L8
 367 01ee 1622     		movs	r2, #22
 368 01f0 1A74     		strb	r2, [r3, #16]
 126:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.m_macDefaultKeySource.addr_64b[7] = 0x5a;
 369              		.loc 1 126 0
 370 01f2 794B     		ldr	r3, .L8
 371 01f4 5A22     		movs	r2, #90
 372 01f6 5A74     		strb	r2, [r3, #17]
 127:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 128:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //store the key and related attributes
 129:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //Creation of the KeyDescriptor
 130:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[0].KeyIdLookupList.KeyIdMode = IEEE154
 373              		.loc 1 130 0
 374 01f8 774B     		ldr	r3, .L8
 375 01fa 0122     		movs	r2, #1
 376 01fc 1A77     		strb	r2, [r3, #28]
 131:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[0].KeyIdLookupList.KeyIndex = IEEE8021
 377              		.loc 1 131 0
 378 01fe 764B     		ldr	r3, .L8
 379 0200 0022     		movs	r2, #0
 380 0202 5A77     		strb	r2, [r3, #29]
 132:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[0].KeyIdLookupList.KeySource.type = AD
 381              		.loc 1 132 0
 382 0204 744B     		ldr	r3, .L8
 383 0206 0222     		movs	r2, #2
 384 0208 9A77     		strb	r2, [r3, #30]
 133:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[0].KeyIdLookupList.KeySource = ieee802
 385              		.loc 1 133 0
 386 020a 734B     		ldr	r3, .L8
 387 020c 724A     		ldr	r2, .L8
 388 020e 1E33     		adds	r3, r3, #30
 389 0210 0932     		adds	r2, r2, #9
 390 0212 1568     		ldr	r5, [r2]	@ unaligned
 391 0214 5468     		ldr	r4, [r2, #4]	@ unaligned
 392 0216 9068     		ldr	r0, [r2, #8]	@ unaligned
 393 0218 D168     		ldr	r1, [r2, #12]	@ unaligned
 394 021a 1D60     		str	r5, [r3]	@ unaligned
 395 021c 5C60     		str	r4, [r3, #4]	@ unaligned
 396 021e 9860     		str	r0, [r3, #8]	@ unaligned
 397 0220 D960     		str	r1, [r3, #12]	@ unaligned
 398 0222 127C     		ldrb	r2, [r2, #16]
 399 0224 1A74     		strb	r2, [r3, #16]
 134:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 135:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[0].KeyIdLookupList.Address = ieee80215
 400              		.loc 1 135 0
 401 0226 6C4A     		ldr	r2, .L8
 402 0228 6B4B     		ldr	r3, .L8
 403 022a 02F14004 		add	r4, r2, #64
 404 022e 03F10905 		add	r5, r3, #9
 405 0232 2868     		ldr	r0, [r5]	@ unaligned
 406 0234 6968     		ldr	r1, [r5, #4]	@ unaligned
 407 0236 AA68     		ldr	r2, [r5, #8]	@ unaligned
 408 0238 EB68     		ldr	r3, [r5, #12]	@ unaligned
 409 023a 0FC4     		stmia	r4!, {r0, r1, r2, r3}
 410 023c 2B7C     		ldrb	r3, [r5, #16]
 411 023e 2370     		strb	r3, [r4]
 136:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[0].KeyIdLookupList.PANId = *(idmanager
 412              		.loc 1 136 0
 413 0240 0420     		movs	r0, #4
 414 0242 FFF7FEFF 		bl	idmanager_getMyID
 415 0246 0246     		mov	r2, r0
 416 0248 634B     		ldr	r3, .L8
 417 024a 2F33     		adds	r3, r3, #47
 418 024c 1568     		ldr	r5, [r2]	@ unaligned
 419 024e 5468     		ldr	r4, [r2, #4]	@ unaligned
 420 0250 9068     		ldr	r0, [r2, #8]	@ unaligned
 421 0252 D168     		ldr	r1, [r2, #12]	@ unaligned
 422 0254 1D60     		str	r5, [r3]	@ unaligned
 423 0256 5C60     		str	r4, [r3, #4]	@ unaligned
 424 0258 9860     		str	r0, [r3, #8]	@ unaligned
 425 025a D960     		str	r1, [r3, #12]	@ unaligned
 426 025c 127C     		ldrb	r2, [r2, #16]
 427 025e 1A74     		strb	r2, [r3, #16]
 137:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[0].KeyUsageList[0].FrameType = IEEE154
 428              		.loc 1 137 0
 429 0260 5D4B     		ldr	r3, .L8
 430 0262 0022     		movs	r2, #0
 431 0264 83F85820 		strb	r2, [r3, #88]
 138:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 139:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    memcpy(&ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[0].key[0],
 432              		.loc 1 139 0
 433 0268 5E48     		ldr	r0, .L8+12
 434 026a 5F49     		ldr	r1, .L8+16
 435 026c 1022     		movs	r2, #16
 436 026e FFF7FEFF 		bl	memcpy
 140:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****           &ieee802154_security_vars.Key_1[0],
 141:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****           16);
 142:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 143:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.MacDeviceTable.DeviceDescriptorEntry[0].deviceAddress = ieee802154_secu
 437              		.loc 1 143 0
 438 0272 594A     		ldr	r2, .L8
 439 0274 584B     		ldr	r3, .L8
 440 0276 02F55974 		add	r4, r2, #868
 441 027a 03F10905 		add	r5, r3, #9
 442 027e 2868     		ldr	r0, [r5]	@ unaligned
 443 0280 6968     		ldr	r1, [r5, #4]	@ unaligned
 444 0282 AA68     		ldr	r2, [r5, #8]	@ unaligned
 445 0284 EB68     		ldr	r3, [r5, #12]	@ unaligned
 446 0286 0FC4     		stmia	r4!, {r0, r1, r2, r3}
 447 0288 2B7C     		ldrb	r3, [r5, #16]
 448 028a 2370     		strb	r3, [r4]
 144:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[0].DeviceTable = &ieee802154_security_
 449              		.loc 1 144 0
 450 028c 524B     		ldr	r3, .L8
 451 028e 544A     		ldr	r2, .L8+8
 452 0290 5A65     		str	r2, [r3, #84]
 145:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 146:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //KEY 2: 'deadbeeffacecafedeadbeeffacecafe'
 147:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    memset(&ieee802154_security_vars.Key_2[0], 0, 16);
 453              		.loc 1 147 0
 454 0292 5648     		ldr	r0, .L8+20
 455 0294 0021     		movs	r1, #0
 456 0296 1022     		movs	r2, #16
 457 0298 FFF7FEFF 		bl	memset
 148:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_2[0] = 0xde;
 458              		.loc 1 148 0
 459 029c 4E4B     		ldr	r3, .L8
 460 029e DE22     		movs	r2, #222
 461 02a0 83F87A24 		strb	r2, [r3, #1146]
 149:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_2[1] = 0xad;
 462              		.loc 1 149 0
 463 02a4 4C4B     		ldr	r3, .L8
 464 02a6 AD22     		movs	r2, #173
 465 02a8 83F87B24 		strb	r2, [r3, #1147]
 150:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_2[2] = 0xbe;
 466              		.loc 1 150 0
 467 02ac 4A4B     		ldr	r3, .L8
 468 02ae BE22     		movs	r2, #190
 469 02b0 83F87C24 		strb	r2, [r3, #1148]
 151:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_2[3] = 0xef;
 470              		.loc 1 151 0
 471 02b4 484B     		ldr	r3, .L8
 472 02b6 EF22     		movs	r2, #239
 473 02b8 83F87D24 		strb	r2, [r3, #1149]
 152:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_2[4] = 0xfa;
 474              		.loc 1 152 0
 475 02bc 464B     		ldr	r3, .L8
 476 02be FA22     		movs	r2, #250
 477 02c0 83F87E24 		strb	r2, [r3, #1150]
 153:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_2[5] = 0xce;
 478              		.loc 1 153 0
 479 02c4 444B     		ldr	r3, .L8
 480 02c6 CE22     		movs	r2, #206
 481 02c8 83F87F24 		strb	r2, [r3, #1151]
 154:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_2[6] = 0xca;
 482              		.loc 1 154 0
 483 02cc 424B     		ldr	r3, .L8
 484 02ce CA22     		movs	r2, #202
 485 02d0 83F88024 		strb	r2, [r3, #1152]
 155:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_2[7] = 0xfe;
 486              		.loc 1 155 0
 487 02d4 404B     		ldr	r3, .L8
 488 02d6 FE22     		movs	r2, #254
 489 02d8 83F88124 		strb	r2, [r3, #1153]
 156:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_2[8] = 0xde;
 490              		.loc 1 156 0
 491 02dc 3E4B     		ldr	r3, .L8
 492 02de DE22     		movs	r2, #222
 493 02e0 83F88224 		strb	r2, [r3, #1154]
 157:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_2[9] = 0xad;
 494              		.loc 1 157 0
 495 02e4 3C4B     		ldr	r3, .L8
 496 02e6 AD22     		movs	r2, #173
 497 02e8 83F88324 		strb	r2, [r3, #1155]
 158:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_2[10] = 0xbe;
 498              		.loc 1 158 0
 499 02ec 3A4B     		ldr	r3, .L8
 500 02ee BE22     		movs	r2, #190
 501 02f0 83F88424 		strb	r2, [r3, #1156]
 159:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_2[11] = 0xef;
 502              		.loc 1 159 0
 503 02f4 384B     		ldr	r3, .L8
 504 02f6 EF22     		movs	r2, #239
 505 02f8 83F88524 		strb	r2, [r3, #1157]
 160:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_2[12] = 0xfa;
 506              		.loc 1 160 0
 507 02fc 364B     		ldr	r3, .L8
 508 02fe FA22     		movs	r2, #250
 509 0300 83F88624 		strb	r2, [r3, #1158]
 161:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_2[13] = 0xce;
 510              		.loc 1 161 0
 511 0304 344B     		ldr	r3, .L8
 512 0306 CE22     		movs	r2, #206
 513 0308 83F88724 		strb	r2, [r3, #1159]
 162:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_2[14] = 0xca;
 514              		.loc 1 162 0
 515 030c 324B     		ldr	r3, .L8
 516 030e CA22     		movs	r2, #202
 517 0310 83F88824 		strb	r2, [r3, #1160]
 163:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.Key_2[15] = 0xfe;
 518              		.loc 1 163 0
 519 0314 304B     		ldr	r3, .L8
 520 0316 FE22     		movs	r2, #254
 521 0318 83F88924 		strb	r2, [r3, #1161]
 164:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 165:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //store the key 2 and related attributes
 166:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //Creation of the KeyDescriptor - Key 2 should be used to encrypt and authenticate data, command
 167:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[1].KeyIdLookupList.KeyIdMode = IEEE154
 522              		.loc 1 167 0
 523 031c 2E4B     		ldr	r3, .L8
 524 031e 0122     		movs	r2, #1
 525 0320 83F87020 		strb	r2, [r3, #112]
 168:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[1].KeyIdLookupList.KeyIndex = IEEE8021
 526              		.loc 1 168 0
 527 0324 2C4B     		ldr	r3, .L8
 528 0326 0022     		movs	r2, #0
 529 0328 83F87120 		strb	r2, [r3, #113]
 169:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[1].KeyIdLookupList.KeySource.type = AD
 530              		.loc 1 169 0
 531 032c 2A4B     		ldr	r3, .L8
 532 032e 0222     		movs	r2, #2
 533 0330 83F87220 		strb	r2, [r3, #114]
 170:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[1].KeyIdLookupList.KeySource = ieee802
 534              		.loc 1 170 0
 535 0334 284B     		ldr	r3, .L8
 536 0336 284A     		ldr	r2, .L8
 537 0338 7233     		adds	r3, r3, #114
 538 033a 0932     		adds	r2, r2, #9
 539 033c 1568     		ldr	r5, [r2]	@ unaligned
 540 033e 5468     		ldr	r4, [r2, #4]	@ unaligned
 541 0340 9068     		ldr	r0, [r2, #8]	@ unaligned
 542 0342 D168     		ldr	r1, [r2, #12]	@ unaligned
 543 0344 1D60     		str	r5, [r3]	@ unaligned
 544 0346 5C60     		str	r4, [r3, #4]	@ unaligned
 545 0348 9860     		str	r0, [r3, #8]	@ unaligned
 546 034a D960     		str	r1, [r3, #12]	@ unaligned
 547 034c 127C     		ldrb	r2, [r2, #16]
 548 034e 1A74     		strb	r2, [r3, #16]
 171:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 172:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[1].KeyIdLookupList.Address = ieee80215
 549              		.loc 1 172 0
 550 0350 214A     		ldr	r2, .L8
 551 0352 214B     		ldr	r3, .L8
 552 0354 02F19404 		add	r4, r2, #148
 553 0358 03F10905 		add	r5, r3, #9
 554 035c 2868     		ldr	r0, [r5]	@ unaligned
 555 035e 6968     		ldr	r1, [r5, #4]	@ unaligned
 556 0360 AA68     		ldr	r2, [r5, #8]	@ unaligned
 557 0362 EB68     		ldr	r3, [r5, #12]	@ unaligned
 558 0364 0FC4     		stmia	r4!, {r0, r1, r2, r3}
 559 0366 2B7C     		ldrb	r3, [r5, #16]
 560 0368 2370     		strb	r3, [r4]
 173:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[1].KeyIdLookupList.PANId = *(idmanager
 561              		.loc 1 173 0
 562 036a 0420     		movs	r0, #4
 563 036c FFF7FEFF 		bl	idmanager_getMyID
 564 0370 0246     		mov	r2, r0
 565 0372 194B     		ldr	r3, .L8
 566 0374 8333     		adds	r3, r3, #131
 567 0376 1568     		ldr	r5, [r2]	@ unaligned
 568 0378 5468     		ldr	r4, [r2, #4]	@ unaligned
 569 037a 9068     		ldr	r0, [r2, #8]	@ unaligned
 570 037c D168     		ldr	r1, [r2, #12]	@ unaligned
 571 037e 1D60     		str	r5, [r3]	@ unaligned
 572 0380 5C60     		str	r4, [r3, #4]	@ unaligned
 573 0382 9860     		str	r0, [r3, #8]	@ unaligned
 574 0384 D960     		str	r1, [r3, #12]	@ unaligned
 575 0386 127C     		ldrb	r2, [r2, #16]
 576 0388 1A74     		strb	r2, [r3, #16]
 174:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[1].KeyUsageList[0].FrameType = IEEE154
 577              		.loc 1 174 0
 578 038a 134B     		ldr	r3, .L8
 579 038c 0122     		movs	r2, #1
 580 038e 83F8AC20 		strb	r2, [r3, #172]
 175:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[1].KeyUsageList[1].FrameType = IEEE154
 581              		.loc 1 175 0
 582 0392 114B     		ldr	r3, .L8
 583 0394 0222     		movs	r2, #2
 584 0396 83F8AE20 		strb	r2, [r3, #174]
 176:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[1].KeyUsageList[2].FrameType = IEEE154
 585              		.loc 1 176 0
 586 039a 0F4B     		ldr	r3, .L8
 587 039c 0322     		movs	r2, #3
 588 039e 83F8B020 		strb	r2, [r3, #176]
 177:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 178:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    memcpy(&ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[1].key[0],
 589              		.loc 1 178 0
 590 03a2 1348     		ldr	r0, .L8+24
 591 03a4 1149     		ldr	r1, .L8+20
 592 03a6 1022     		movs	r2, #16
 593 03a8 FFF7FEFF 		bl	memcpy
 179:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****           &ieee802154_security_vars.Key_2[0],
 180:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****           16);
 181:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 182:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.MacDeviceTable.DeviceDescriptorEntry[1].deviceAddress = ieee802154_secu
 594              		.loc 1 182 0
 595 03ac 0A4B     		ldr	r3, .L8
 596 03ae 0A4A     		ldr	r2, .L8
 597 03b0 03F27B33 		addw	r3, r3, #891
 598 03b4 0932     		adds	r2, r2, #9
 599 03b6 1568     		ldr	r5, [r2]	@ unaligned
 600 03b8 5468     		ldr	r4, [r2, #4]	@ unaligned
 601 03ba 9068     		ldr	r0, [r2, #8]	@ unaligned
 602 03bc D168     		ldr	r1, [r2, #12]	@ unaligned
 603 03be 1D60     		str	r5, [r3]	@ unaligned
 604 03c0 5C60     		str	r4, [r3, #4]	@ unaligned
 605 03c2 9860     		str	r0, [r3, #8]	@ unaligned
 606 03c4 D960     		str	r1, [r3, #12]	@ unaligned
 607 03c6 127C     		ldrb	r2, [r2, #16]
 608 03c8 1A74     		strb	r2, [r3, #16]
 183:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[1].DeviceTable = &ieee802154_security_
 609              		.loc 1 183 0
 610 03ca 034B     		ldr	r3, .L8
 611 03cc 044A     		ldr	r2, .L8+8
 612 03ce C3F8A820 		str	r2, [r3, #168]
 184:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** }
 613              		.loc 1 184 0
 614 03d2 0837     		adds	r7, r7, #8
 615              		.cfi_def_cfa_offset 16
 616 03d4 BD46     		mov	sp, r7
 617              		.cfi_def_cfa_register 13
 618              		@ sp needed
 619 03d6 B0BD     		pop	{r4, r5, r7, pc}
 620              	.L9:
 621              		.align	2
 622              	.L8:
 623 03d8 00000000 		.word	ieee802154_security_vars
 624 03dc 1C000000 		.word	ieee802154_security_vars+28
 625 03e0 64030000 		.word	ieee802154_security_vars+868
 626 03e4 5E000000 		.word	ieee802154_security_vars+94
 627 03e8 6A040000 		.word	ieee802154_security_vars+1130
 628 03ec 7A040000 		.word	ieee802154_security_vars+1146
 629 03f0 B2000000 		.word	ieee802154_security_vars+178
 630              		.cfi_endproc
 631              	.LFE0:
 633              		.align	2
 634              		.global	IEEE802154_security_prependAuxiliarySecurityHeader
 635              		.thumb
 636              		.thumb_func
 638              	IEEE802154_security_prependAuxiliarySecurityHeader:
 639              	.LFB1:
 185:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 186:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** //=========================== public ==========================================
 187:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** /**
 188:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** \brief Adding of Auxiliary Security Header to the IEEE802.15.4 MAC header
 189:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** */
 190:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** void IEEE802154_security_prependAuxiliarySecurityHeader(OpenQueueEntry_t* msg){
 640              		.loc 1 190 0
 641              		.cfi_startproc
 642              		@ args = 0, pretend = 0, frame = 16
 643              		@ frame_needed = 1, uses_anonymous_args = 0
 644 03f4 B0B5     		push	{r4, r5, r7, lr}
 645              		.cfi_def_cfa_offset 16
 646              		.cfi_offset 4, -16
 647              		.cfi_offset 5, -12
 648              		.cfi_offset 7, -8
 649              		.cfi_offset 14, -4
 650 03f6 84B0     		sub	sp, sp, #16
 651              		.cfi_def_cfa_offset 32
 652 03f8 00AF     		add	r7, sp, #0
 653              		.cfi_def_cfa_register 7
 654 03fa 7860     		str	r0, [r7, #4]
 191:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 192:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t frameCounterSuppression;
 193:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t temp8b;
 194:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    open_addr_t* temp_keySource;
 195:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t auxiliaryLength;
 196:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 197:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    frameCounterSuppression = IEEE154_ASH_FRAMECOUNTER_SUPPRESSED; //the frame counter is carried in
 655              		.loc 1 197 0
 656 03fc 0123     		movs	r3, #1
 657 03fe BB73     		strb	r3, [r7, #14]
 198:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 199:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //max length of MAC frames
 200:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    // length of authentication Tag
 201:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    msg->l2_authenticationLength = IEEE802154_security_authLengthChecking(msg->l2_securityLevel);
 658              		.loc 1 201 0
 659 0400 7B68     		ldr	r3, [r7, #4]
 660 0402 93F86A30 		ldrb	r3, [r3, #106]	@ zero_extendqisi2
 661 0406 1846     		mov	r0, r3
 662 0408 FFF7FEFF 		bl	IEEE802154_security_authLengthChecking
 663 040c 0346     		mov	r3, r0
 664 040e 1A46     		mov	r2, r3
 665 0410 7B68     		ldr	r3, [r7, #4]
 666 0412 83F87E20 		strb	r2, [r3, #126]
 202:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 203:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //length of auxiliary security header
 204:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    auxiliaryLength = IEEE802154_security_auxLengthChecking(msg->l2_keyIdMode,
 667              		.loc 1 204 0
 668 0416 7B68     		ldr	r3, [r7, #4]
 669 0418 93F86B10 		ldrb	r1, [r3, #107]	@ zero_extendqisi2
 670 041c 584B     		ldr	r3, .L24
 671 041e 5B79     		ldrb	r3, [r3, #5]	@ zero_extendqisi2
 672 0420 BA7B     		ldrb	r2, [r7, #14]	@ zero_extendqisi2
 673 0422 0846     		mov	r0, r1
 674 0424 1146     		mov	r1, r2
 675 0426 1A46     		mov	r2, r3
 676 0428 FFF7FEFF 		bl	IEEE802154_security_auxLengthChecking
 677 042c 0346     		mov	r3, r0
 678 042e 7B73     		strb	r3, [r7, #13]
 205:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                            frameCounterSuppression,
 206:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                            ieee802154_security_vars.m_macFrameCount
 207:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 208:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 209:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if ((msg->length+auxiliaryLength+msg->l2_authenticationLength+2) >= 128 ){ //2 bytes of CRC, 127
 679              		.loc 1 209 0
 680 0430 7B68     		ldr	r3, [r7, #4]
 681 0432 1B7A     		ldrb	r3, [r3, #8]	@ zero_extendqisi2
 682 0434 1A46     		mov	r2, r3
 683 0436 7B7B     		ldrb	r3, [r7, #13]	@ zero_extendqisi2
 684 0438 1344     		add	r3, r3, r2
 685 043a 7A68     		ldr	r2, [r7, #4]
 686 043c 92F87E20 		ldrb	r2, [r2, #126]	@ zero_extendqisi2
 687 0440 1344     		add	r3, r3, r2
 688 0442 0233     		adds	r3, r3, #2
 689 0444 7F2B     		cmp	r3, #127
 690 0446 00DD     		ble	.L11
 210:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       return;
 691              		.loc 1 210 0
 692 0448 97E0     		b	.L10
 693              	.L11:
 211:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 212:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 213:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //start setting the Auxiliary Security Header
 214:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (msg->l2_keyIdMode != IEEE154_ASH_KEYIDMODE_IMPLICIT){//if the KeyIdMode is zero, keyIndex an
 694              		.loc 1 214 0
 695 044a 7B68     		ldr	r3, [r7, #4]
 696 044c 93F86B30 		ldrb	r3, [r3, #107]	@ zero_extendqisi2
 697 0450 002B     		cmp	r3, #0
 698 0452 0BD0     		beq	.L13
 215:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       temp8b = msg->l2_keyIndex; //key index field
 699              		.loc 1 215 0
 700 0454 7B68     		ldr	r3, [r7, #4]
 701 0456 93F86C30 		ldrb	r3, [r3, #108]
 702 045a FB73     		strb	r3, [r7, #15]
 216:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       packetfunctions_reserveHeaderSize(msg, sizeof(uint8_t));
 703              		.loc 1 216 0
 704 045c 7868     		ldr	r0, [r7, #4]
 705 045e 0121     		movs	r1, #1
 706 0460 FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 217:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       *((uint8_t*)(msg->payload)) = temp8b;
 707              		.loc 1 217 0
 708 0464 7B68     		ldr	r3, [r7, #4]
 709 0466 5B68     		ldr	r3, [r3, #4]
 710 0468 FA7B     		ldrb	r2, [r7, #15]
 711 046a 1A70     		strb	r2, [r3]
 712              	.L13:
 218:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 219:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 220:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //insert the keyIdMode field
 221:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    switch (msg->l2_keyIdMode){
 713              		.loc 1 221 0
 714 046c 7B68     		ldr	r3, [r7, #4]
 715 046e 93F86B30 		ldrb	r3, [r3, #107]	@ zero_extendqisi2
 716 0472 032B     		cmp	r3, #3
 717 0474 42D8     		bhi	.L14
 718 0476 01A2     		adr	r2, .L16
 719 0478 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 720              		.p2align 2
 721              	.L16:
 722 047c 8D040000 		.word	.L15+1
 723 0480 A1040000 		.word	.L17+1
 724 0484 BF040000 		.word	.L18+1
 725 0488 EB040000 		.word	.L19+1
 726              		.p2align 1
 727              	.L15:
 222:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_KEYIDMODE_IMPLICIT: //no KeyIDMode field - implicit
 223:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****     	 temp_keySource = &ieee802154_security_vars.m_macDefaultKeySource;
 728              		.loc 1 223 0
 729 048c 3D4B     		ldr	r3, .L24+4
 730 048e BB60     		str	r3, [r7, #8]
 224:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          memcpy(&(msg->l2_keySource), temp_keySource, sizeof(open_addr_t));
 731              		.loc 1 224 0
 732 0490 7B68     		ldr	r3, [r7, #4]
 733 0492 6D33     		adds	r3, r3, #109
 734 0494 1846     		mov	r0, r3
 735 0496 B968     		ldr	r1, [r7, #8]
 736 0498 1122     		movs	r2, #17
 737 049a FFF7FEFF 		bl	memcpy
 225:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 738              		.loc 1 225 0
 739 049e 38E0     		b	.L20
 740              	.L17:
 226:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_KEYIDMODE_DEFAULTKEYSOURCE:// macDefaultKeySource
 227:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          msg->l2_keySource = ieee802154_security_vars.m_macDefaultKeySource;
 741              		.loc 1 227 0
 742 04a0 7B68     		ldr	r3, [r7, #4]
 743 04a2 374A     		ldr	r2, .L24
 744 04a4 6D33     		adds	r3, r3, #109
 745 04a6 0932     		adds	r2, r2, #9
 746 04a8 1568     		ldr	r5, [r2]	@ unaligned
 747 04aa 5468     		ldr	r4, [r2, #4]	@ unaligned
 748 04ac 9068     		ldr	r0, [r2, #8]	@ unaligned
 749 04ae D168     		ldr	r1, [r2, #12]	@ unaligned
 750 04b0 1D60     		str	r5, [r3]	@ unaligned
 751 04b2 5C60     		str	r4, [r3, #4]	@ unaligned
 752 04b4 9860     		str	r0, [r3, #8]	@ unaligned
 753 04b6 D960     		str	r1, [r3, #12]	@ unaligned
 754 04b8 127C     		ldrb	r2, [r2, #16]
 755 04ba 1A74     		strb	r2, [r3, #16]
 228:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 756              		.loc 1 228 0
 757 04bc 29E0     		b	.L20
 758              	.L18:
 229:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_KEYIDMODE_EXPLICIT_16: //keySource with 16b address
 230:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          temp_keySource = &msg->l2_keySource;
 759              		.loc 1 230 0
 760 04be 7B68     		ldr	r3, [r7, #4]
 761 04c0 6D33     		adds	r3, r3, #109
 762 04c2 BB60     		str	r3, [r7, #8]
 231:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          packetfunctions_reserveHeaderSize(msg, sizeof(uint8_t));
 763              		.loc 1 231 0
 764 04c4 7868     		ldr	r0, [r7, #4]
 765 04c6 0121     		movs	r1, #1
 766 04c8 FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 232:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          *((uint8_t*)(msg->payload)) = temp_keySource->addr_64b[6];
 767              		.loc 1 232 0
 768 04cc 7B68     		ldr	r3, [r7, #4]
 769 04ce 5B68     		ldr	r3, [r3, #4]
 770 04d0 BA68     		ldr	r2, [r7, #8]
 771 04d2 D279     		ldrb	r2, [r2, #7]	@ zero_extendqisi2
 772 04d4 1A70     		strb	r2, [r3]
 233:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          packetfunctions_reserveHeaderSize(msg, sizeof(uint8_t));
 773              		.loc 1 233 0
 774 04d6 7868     		ldr	r0, [r7, #4]
 775 04d8 0121     		movs	r1, #1
 776 04da FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 234:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          *((uint8_t*)(msg->payload)) = temp_keySource->addr_64b[7];
 777              		.loc 1 234 0
 778 04de 7B68     		ldr	r3, [r7, #4]
 779 04e0 5B68     		ldr	r3, [r3, #4]
 780 04e2 BA68     		ldr	r2, [r7, #8]
 781 04e4 127A     		ldrb	r2, [r2, #8]	@ zero_extendqisi2
 782 04e6 1A70     		strb	r2, [r3]
 235:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 783              		.loc 1 235 0
 784 04e8 13E0     		b	.L20
 785              	.L19:
 236:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_KEYIDMODE_EXPLICIT_64: //keySource with 64b address
 237:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          temp_keySource = &msg->l2_keySource;
 786              		.loc 1 237 0
 787 04ea 7B68     		ldr	r3, [r7, #4]
 788 04ec 6D33     		adds	r3, r3, #109
 789 04ee BB60     		str	r3, [r7, #8]
 238:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          packetfunctions_writeAddress(msg,temp_keySource,OW_LITTLE_ENDIAN);
 790              		.loc 1 238 0
 791 04f0 7868     		ldr	r0, [r7, #4]
 792 04f2 B968     		ldr	r1, [r7, #8]
 793 04f4 0122     		movs	r2, #1
 794 04f6 FFF7FEFF 		bl	packetfunctions_writeAddress
 239:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 795              		.loc 1 239 0
 796 04fa 0AE0     		b	.L20
 797              	.L14:
 240:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       default://error
 241:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 242:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                               (errorparameter_t)msg->l2_frameType,
 798              		.loc 1 242 0
 799 04fc 7B68     		ldr	r3, [r7, #4]
 800 04fe 93F84930 		ldrb	r3, [r3, #73]	@ zero_extendqisi2
 241:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                               (errorparameter_t)msg->l2_frameType,
 801              		.loc 1 241 0
 802 0502 9BB2     		uxth	r3, r3
 803 0504 2620     		movs	r0, #38
 804 0506 3B21     		movs	r1, #59
 805 0508 1A46     		mov	r2, r3
 806 050a 0023     		movs	r3, #0
 807 050c FFF7FEFF 		bl	openserial_printError
 243:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                               (errorparameter_t)0);
 244:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          return;
 808              		.loc 1 244 0
 809 0510 33E0     		b	.L10
 810              	.L20:
 245:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 246:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 247:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //Frame Counter
 248:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (frameCounterSuppression == IEEE154_ASH_FRAMECOUNTER_PRESENT){
 811              		.loc 1 248 0
 812 0512 BB7B     		ldrb	r3, [r7, #14]	@ zero_extendqisi2
 813 0514 002B     		cmp	r3, #0
 814 0516 08D1     		bne	.L21
 249:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       //here I have to insert the ASN: I can only reserve the space and
 250:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       //save the pointer. The ASN will be added by IEEE802.15.4e
 251:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 252:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       // reserve space
 253:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       packetfunctions_reserveHeaderSize(msg,sizeof(macFrameCounter_t));
 815              		.loc 1 253 0
 816 0518 7868     		ldr	r0, [r7, #4]
 817 051a 0521     		movs	r1, #5
 818 051c FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 254:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 255:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       // Keep a pointer to where the ASN will be
 256:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       // Note: the actual value of the current ASN will be written by the
 257:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       //    IEEE802.15.4e when transmitting
 258:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       msg->l2_FrameCounter = msg->payload;
 819              		.loc 1 258 0
 820 0520 7B68     		ldr	r3, [r7, #4]
 821 0522 5A68     		ldr	r2, [r3, #4]
 822 0524 7B68     		ldr	r3, [r7, #4]
 823 0526 C3F88020 		str	r2, [r3, #128]
 824              	.L21:
 259:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 260:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 261:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //security control field
 262:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    packetfunctions_reserveHeaderSize(msg, sizeof(uint8_t));
 825              		.loc 1 262 0
 826 052a 7868     		ldr	r0, [r7, #4]
 827 052c 0121     		movs	r1, #1
 828 052e FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 263:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****  
 264:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    temp8b = 0;
 829              		.loc 1 264 0
 830 0532 0023     		movs	r3, #0
 831 0534 FB73     		strb	r3, [r7, #15]
 265:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    temp8b |= msg->l2_securityLevel << IEEE154_ASH_SCF_SECURITY_LEVEL;//3b
 832              		.loc 1 265 0
 833 0536 7B68     		ldr	r3, [r7, #4]
 834 0538 93F86A20 		ldrb	r2, [r3, #106]	@ zero_extendqisi2
 835 053c FB7B     		ldrb	r3, [r7, #15]
 836 053e 1343     		orrs	r3, r3, r2
 837 0540 FB73     		strb	r3, [r7, #15]
 266:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    temp8b |= msg->l2_keyIdMode << IEEE154_ASH_SCF_KEY_IDENTIFIER_MODE;//2b
 838              		.loc 1 266 0
 839 0542 7B68     		ldr	r3, [r7, #4]
 840 0544 93F86B30 		ldrb	r3, [r3, #107]	@ zero_extendqisi2
 841 0548 DB00     		lsls	r3, r3, #3
 842 054a DAB2     		uxtb	r2, r3
 843 054c FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 844 054e 1343     		orrs	r3, r3, r2
 845 0550 DBB2     		uxtb	r3, r3
 846 0552 FB73     		strb	r3, [r7, #15]
 267:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    temp8b |= frameCounterSuppression << IEEE154_ASH_SCF_FRAME_CNT_MODE; //1b
 847              		.loc 1 267 0
 848 0554 BB7B     		ldrb	r3, [r7, #14]	@ zero_extendqisi2
 849 0556 5B01     		lsls	r3, r3, #5
 850 0558 DAB2     		uxtb	r2, r3
 851 055a FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 852 055c 1343     		orrs	r3, r3, r2
 853 055e DBB2     		uxtb	r3, r3
 854 0560 FB73     		strb	r3, [r7, #15]
 268:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 269:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (ieee802154_security_vars.m_macFrameCounterMode == 0x04) { // 4 byte Frame Counter
 855              		.loc 1 269 0
 856 0562 074B     		ldr	r3, .L24
 857 0564 5B79     		ldrb	r3, [r3, #5]	@ zero_extendqisi2
 858 0566 042B     		cmp	r3, #4
 859 0568 03D0     		beq	.L23
 270:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       temp8b |= 0 << IEEE154_ASH_SCF_FRAME_CNT_SIZE; //1b
 271:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    } else { // 5 byte Frame Counter
 272:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       temp8b |= 1 << IEEE154_ASH_SCF_FRAME_CNT_SIZE; //1b
 860              		.loc 1 272 0
 861 056a FB7B     		ldrb	r3, [r7, #15]
 862 056c 43F04003 		orr	r3, r3, #64
 863 0570 FB73     		strb	r3, [r7, #15]
 864              	.L23:
 273:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 274:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 275:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    temp8b |= 0 << 1;//1b reserved
 276:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    *((uint8_t*)(msg->payload)) = temp8b;
 865              		.loc 1 276 0
 866 0572 7B68     		ldr	r3, [r7, #4]
 867 0574 5B68     		ldr	r3, [r3, #4]
 868 0576 FA7B     		ldrb	r2, [r7, #15]
 869 0578 1A70     		strb	r2, [r3]
 870              	.L10:
 277:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** }
 871              		.loc 1 277 0
 872 057a 1037     		adds	r7, r7, #16
 873              		.cfi_def_cfa_offset 16
 874 057c BD46     		mov	sp, r7
 875              		.cfi_def_cfa_register 13
 876              		@ sp needed
 877 057e B0BD     		pop	{r4, r5, r7, pc}
 878              	.L25:
 879              		.align	2
 880              	.L24:
 881 0580 00000000 		.word	ieee802154_security_vars
 882 0584 09000000 		.word	ieee802154_security_vars+9
 883              		.cfi_endproc
 884              	.LFE1:
 886              		.align	2
 887              		.global	IEEE802154_security_outgoingFrameSecurity
 888              		.thumb
 889              		.thumb_func
 891              	IEEE802154_security_outgoingFrameSecurity:
 892              	.LFB2:
 278:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 279:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** /**
 280:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** \brief Key searching and encryption/authentication operations.
 281:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** */
 282:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** owerror_t IEEE802154_security_outgoingFrameSecurity(OpenQueueEntry_t*   msg){
 893              		.loc 1 282 0
 894              		.cfi_startproc
 895              		@ args = 0, pretend = 0, frame = 80
 896              		@ frame_needed = 1, uses_anonymous_args = 0
 897 0588 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 898              		.cfi_def_cfa_offset 24
 899              		.cfi_offset 4, -24
 900              		.cfi_offset 5, -20
 901              		.cfi_offset 6, -16
 902              		.cfi_offset 7, -12
 903              		.cfi_offset 8, -8
 904              		.cfi_offset 14, -4
 905 058c 98B0     		sub	sp, sp, #96
 906              		.cfi_def_cfa_offset 120
 907 058e 04AF     		add	r7, sp, #16
 908              		.cfi_def_cfa 7, 104
 909 0590 7860     		str	r0, [r7, #4]
 283:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t frameCounterSuppression;
 284:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    m_keyDescriptor* keyDescriptor;
 285:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t i;
 286:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t j;
 287:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t nonce[13];
 288:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t key[16];
 289:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    owerror_t outStatus;
 290:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t* a;
 291:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t len_a;
 292:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t* m;
 293:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t len_m;
 294:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 295:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //the frame counter is carried in the frame, otherwise 1;
 296:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    frameCounterSuppression = IEEE154_ASH_FRAMECOUNTER_SUPPRESSED;
 910              		.loc 1 296 0
 911 0592 0123     		movs	r3, #1
 912 0594 87F83F30 		strb	r3, [r7, #63]
 297:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 298:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //search for a key
 299:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    keyDescriptor = IEEE802154_security_keyDescriptorLookup(msg->l2_keyIdMode,
 913              		.loc 1 299 0
 914 0598 7B68     		ldr	r3, [r7, #4]
 915 059a 93F86B80 		ldrb	r8, [r3, #107]	@ zero_extendqisi2
 916 059e 7B68     		ldr	r3, [r7, #4]
 917 05a0 03F16D06 		add	r6, r3, #109
 918 05a4 7B68     		ldr	r3, [r7, #4]
 919 05a6 93F86C50 		ldrb	r5, [r3, #108]	@ zero_extendqisi2
 920 05aa 7B68     		ldr	r3, [r7, #4]
 921 05ac 03F16D04 		add	r4, r3, #109
 922 05b0 0420     		movs	r0, #4
 923 05b2 FFF7FEFF 		bl	idmanager_getMyID
 924 05b6 0246     		mov	r2, r0
 925 05b8 7B68     		ldr	r3, [r7, #4]
 926 05ba 93F84930 		ldrb	r3, [r3, #73]	@ zero_extendqisi2
 927 05be 0092     		str	r2, [sp]
 928 05c0 0193     		str	r3, [sp, #4]
 929 05c2 4046     		mov	r0, r8
 930 05c4 3146     		mov	r1, r6
 931 05c6 2A46     		mov	r2, r5
 932 05c8 2346     		mov	r3, r4
 933 05ca FFF7FEFF 		bl	IEEE802154_security_keyDescriptorLookup
 934 05ce B863     		str	r0, [r7, #56]
 300:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                            &msg->l2_keySource,
 301:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                            msg->l2_keyIndex,
 302:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                            &msg->l2_keySource,
 303:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                            (idmanager_getMyID(ADDR_PANID)),
 304:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                            msg->l2_frameType);
 305:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 306:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (keyDescriptor==NULL){//key not found
 935              		.loc 1 306 0
 936 05d0 BB6B     		ldr	r3, [r7, #56]
 937 05d2 002B     		cmp	r3, #0
 938 05d4 0BD1     		bne	.L27
 307:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 308:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                            (errorparameter_t)msg->l2_frameType,
 939              		.loc 1 308 0
 940 05d6 7B68     		ldr	r3, [r7, #4]
 941 05d8 93F84930 		ldrb	r3, [r3, #73]	@ zero_extendqisi2
 307:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 942              		.loc 1 307 0
 943 05dc 9BB2     		uxth	r3, r3
 944 05de 2620     		movs	r0, #38
 945 05e0 3B21     		movs	r1, #59
 946 05e2 1A46     		mov	r2, r3
 947 05e4 0123     		movs	r3, #1
 948 05e6 FFF7FEFF 		bl	openserial_printError
 309:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                            (errorparameter_t)1);
 310:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       return E_FAIL;
 949              		.loc 1 310 0
 950 05ea 0123     		movs	r3, #1
 951 05ec F6E0     		b	.L43
 952              	.L27:
 311:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 312:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 313:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    for (j=0;j<16;j++){
 953              		.loc 1 313 0
 954 05ee 0023     		movs	r3, #0
 955 05f0 87F84E30 		strb	r3, [r7, #78]
 956 05f4 11E0     		b	.L29
 957              	.L30:
 314:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       key[j] = keyDescriptor->key[j];
 958              		.loc 1 314 0 discriminator 3
 959 05f6 97F84E30 		ldrb	r3, [r7, #78]	@ zero_extendqisi2
 960 05fa 97F84E20 		ldrb	r2, [r7, #78]	@ zero_extendqisi2
 961 05fe B96B     		ldr	r1, [r7, #56]
 962 0600 0A44     		add	r2, r2, r1
 963 0602 92F84220 		ldrb	r2, [r2, #66]	@ zero_extendqisi2
 964 0606 07F15001 		add	r1, r7, #80
 965 060a 0B44     		add	r3, r3, r1
 966 060c 03F8382C 		strb	r2, [r3, #-56]
 313:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       key[j] = keyDescriptor->key[j];
 967              		.loc 1 313 0 discriminator 3
 968 0610 97F84E30 		ldrb	r3, [r7, #78]	@ zero_extendqisi2
 969 0614 0133     		adds	r3, r3, #1
 970 0616 87F84E30 		strb	r3, [r7, #78]
 971              	.L29:
 313:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       key[j] = keyDescriptor->key[j];
 972              		.loc 1 313 0 is_stmt 0 discriminator 1
 973 061a 97F84E30 		ldrb	r3, [r7, #78]	@ zero_extendqisi2
 974 061e 0F2B     		cmp	r3, #15
 975 0620 E9D9     		bls	.L30
 315:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 316:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 317:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t vectASN[5];
 318:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    macFrameCounter_t l2_frameCounter;
 319:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee154e_getAsn(vectASN);//gets asn from mac layer.
 976              		.loc 1 319 0 is_stmt 1
 977 0622 07F11003 		add	r3, r7, #16
 978 0626 1846     		mov	r0, r3
 979 0628 FFF7FEFF 		bl	ieee154e_getAsn
 320:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (frameCounterSuppression == IEEE154_ASH_FRAMECOUNTER_PRESENT){//the frame Counter is carried 
 980              		.loc 1 320 0
 981 062c 97F83F30 		ldrb	r3, [r7, #63]	@ zero_extendqisi2
 982 0630 002B     		cmp	r3, #0
 983 0632 1ED1     		bne	.L31
 321:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       //save the frame counter of the current frame
 322:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       l2_frameCounter.bytes0and1 = vectASN[0]+256*vectASN[1];
 984              		.loc 1 322 0
 985 0634 3B7C     		ldrb	r3, [r7, #16]	@ zero_extendqisi2
 986 0636 9AB2     		uxth	r2, r3
 987 0638 7B7C     		ldrb	r3, [r7, #17]	@ zero_extendqisi2
 988 063a 9BB2     		uxth	r3, r3
 989 063c 1B02     		lsls	r3, r3, #8
 990 063e 9BB2     		uxth	r3, r3
 991 0640 1344     		add	r3, r3, r2
 992 0642 9BB2     		uxth	r3, r3
 993 0644 A7F80B30 		strh	r3, [r7, #11]	@ unaligned
 323:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       l2_frameCounter.bytes2and3 = vectASN[2]+256*vectASN[3];
 994              		.loc 1 323 0
 995 0648 BB7C     		ldrb	r3, [r7, #18]	@ zero_extendqisi2
 996 064a 9AB2     		uxth	r2, r3
 997 064c FB7C     		ldrb	r3, [r7, #19]	@ zero_extendqisi2
 998 064e 9BB2     		uxth	r3, r3
 999 0650 1B02     		lsls	r3, r3, #8
 1000 0652 9BB2     		uxth	r3, r3
 1001 0654 1344     		add	r3, r3, r2
 1002 0656 9BB2     		uxth	r3, r3
 1003 0658 A7F80930 		strh	r3, [r7, #9]	@ unaligned
 324:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       l2_frameCounter.byte4 = vectASN[4];
 1004              		.loc 1 324 0
 1005 065c 3B7D     		ldrb	r3, [r7, #20]	@ zero_extendqisi2
 1006 065e 3B72     		strb	r3, [r7, #8]
 325:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 326:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       IEEE802154_security_getFrameCounter(l2_frameCounter,
 1007              		.loc 1 326 0
 1008 0660 7B68     		ldr	r3, [r7, #4]
 1009 0662 D3F88020 		ldr	r2, [r3, #128]
 1010 0666 07F10803 		add	r3, r7, #8
 1011 066a 93E80300 		ldmia	r3, {r0, r1}
 1012 066e FFF7FEFF 		bl	IEEE802154_security_getFrameCounter
 1013              	.L31:
 327:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                          msg->l2_FrameCounter);
 328:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    } //otherwise the frame counter is not in the frame
 329:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 330:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //nonce creation
 331:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    memset(&nonce[0], 0, 13);
 1014              		.loc 1 331 0
 1015 0672 07F12803 		add	r3, r7, #40
 1016 0676 1846     		mov	r0, r3
 1017 0678 0021     		movs	r1, #0
 1018 067a 0D22     		movs	r2, #13
 1019 067c FFF7FEFF 		bl	memset
 332:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //first 8 bytes of the nonce are always the source address of the frame
 333:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    memcpy(&nonce[0],idmanager_getMyID(ADDR_64B)->addr_64b,8);
 1020              		.loc 1 333 0
 1021 0680 0220     		movs	r0, #2
 1022 0682 FFF7FEFF 		bl	idmanager_getMyID
 1023 0686 0346     		mov	r3, r0
 1024 0688 0133     		adds	r3, r3, #1
 1025 068a 07F12802 		add	r2, r7, #40
 1026 068e 1046     		mov	r0, r2
 1027 0690 1946     		mov	r1, r3
 1028 0692 0822     		movs	r2, #8
 1029 0694 FFF7FEFF 		bl	memcpy
 334:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 335:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //Frame Counter (ASN)
 336:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    for (i=0;i<5;i++){
 1030              		.loc 1 336 0
 1031 0698 0023     		movs	r3, #0
 1032 069a 87F84F30 		strb	r3, [r7, #79]
 1033 069e 13E0     		b	.L32
 1034              	.L33:
 337:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       nonce[8+i] = vectASN[i];
 1035              		.loc 1 337 0 discriminator 3
 1036 06a0 97F84F30 		ldrb	r3, [r7, #79]	@ zero_extendqisi2
 1037 06a4 0833     		adds	r3, r3, #8
 1038 06a6 97F84F20 		ldrb	r2, [r7, #79]	@ zero_extendqisi2
 1039 06aa 07F15001 		add	r1, r7, #80
 1040 06ae 0A44     		add	r2, r2, r1
 1041 06b0 12F8402C 		ldrb	r2, [r2, #-64]	@ zero_extendqisi2
 1042 06b4 07F15001 		add	r1, r7, #80
 1043 06b8 0B44     		add	r3, r3, r1
 1044 06ba 03F8282C 		strb	r2, [r3, #-40]
 336:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       nonce[8+i] = vectASN[i];
 1045              		.loc 1 336 0 discriminator 3
 1046 06be 97F84F30 		ldrb	r3, [r7, #79]	@ zero_extendqisi2
 1047 06c2 0133     		adds	r3, r3, #1
 1048 06c4 87F84F30 		strb	r3, [r7, #79]
 1049              	.L32:
 336:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       nonce[8+i] = vectASN[i];
 1050              		.loc 1 336 0 is_stmt 0 discriminator 1
 1051 06c8 97F84F30 		ldrb	r3, [r7, #79]	@ zero_extendqisi2
 1052 06cc 042B     		cmp	r3, #4
 1053 06ce E7D9     		bls	.L33
 338:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 339:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 340:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //identify data to be authenticated and data to be encrypted
 341:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    switch (msg->l2_securityLevel) {
 1054              		.loc 1 341 0 is_stmt 1
 1055 06d0 7B68     		ldr	r3, [r7, #4]
 1056 06d2 93F86A30 		ldrb	r3, [r3, #106]	@ zero_extendqisi2
 1057 06d6 013B     		subs	r3, r3, #1
 1058 06d8 062B     		cmp	r3, #6
 1059 06da 36D8     		bhi	.L34
 1060 06dc 01A2     		adr	r2, .L36
 1061 06de 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 1062 06e2 00BF     		.p2align 2
 1063              	.L36:
 1064 06e4 01070000 		.word	.L35+1
 1065 06e8 01070000 		.word	.L35+1
 1066 06ec 01070000 		.word	.L35+1
 1067 06f0 47070000 		.word	.L37+1
 1068 06f4 21070000 		.word	.L38+1
 1069 06f8 21070000 		.word	.L38+1
 1070 06fc 21070000 		.word	.L38+1
 1071              		.p2align 1
 1072              	.L35:
 342:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_MIC_32:  // authentication only cases
 343:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_MIC_64:
 344:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_MIC_128: 
 345:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          a = msg->payload;             // first byte of the frame
 1073              		.loc 1 345 0
 1074 0700 7B68     		ldr	r3, [r7, #4]
 1075 0702 5B68     		ldr	r3, [r3, #4]
 1076 0704 BB64     		str	r3, [r7, #72]
 346:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          len_a = msg->length;          // whole frame
 1077              		.loc 1 346 0
 1078 0706 7B68     		ldr	r3, [r7, #4]
 1079 0708 1B7A     		ldrb	r3, [r3, #8]
 1080 070a 87F84730 		strb	r3, [r7, #71]
 347:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          m = &msg->payload[len_a];     // concatenate MIC at the end of the frame
 1081              		.loc 1 347 0
 1082 070e 7B68     		ldr	r3, [r7, #4]
 1083 0710 5A68     		ldr	r2, [r3, #4]
 1084 0712 97F84730 		ldrb	r3, [r7, #71]	@ zero_extendqisi2
 1085 0716 1344     		add	r3, r3, r2
 1086 0718 3B64     		str	r3, [r7, #64]
 348:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          len_m = 0;                    // length of the encrypted part
 1087              		.loc 1 348 0
 1088 071a 0023     		movs	r3, #0
 1089 071c FB75     		strb	r3, [r7, #23]
 349:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 1090              		.loc 1 349 0
 1091 071e 16E0     		b	.L39
 1092              	.L38:
 350:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_ENC_MIC_32:  // authentication + encryption cases
 351:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_ENC_MIC_64:
 352:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_ENC_MIC_128:
 353:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          a = msg->payload;             // first byte of the frame
 1093              		.loc 1 353 0
 1094 0720 7B68     		ldr	r3, [r7, #4]
 1095 0722 5B68     		ldr	r3, [r3, #4]
 1096 0724 BB64     		str	r3, [r7, #72]
 354:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          m = msg->l2_payload;          // first byte where we should start encrypting (see 15.4 std
 1097              		.loc 1 354 0
 1098 0726 7B68     		ldr	r3, [r7, #4]
 1099 0728 5B6D     		ldr	r3, [r3, #84]
 1100 072a 3B64     		str	r3, [r7, #64]
 355:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          len_a = m - a;                // part that is only authenticated is the difference of two 
 1101              		.loc 1 355 0
 1102 072c 3A6C     		ldr	r2, [r7, #64]
 1103 072e BB6C     		ldr	r3, [r7, #72]
 1104 0730 D31A     		subs	r3, r2, r3
 1105 0732 87F84730 		strb	r3, [r7, #71]
 356:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          len_m = msg->length - len_a;  // part that is encrypted+authenticated is the rest of the f
 1106              		.loc 1 356 0
 1107 0736 7B68     		ldr	r3, [r7, #4]
 1108 0738 1A7A     		ldrb	r2, [r3, #8]	@ zero_extendqisi2
 1109 073a 97F84730 		ldrb	r3, [r7, #71]
 1110 073e D31A     		subs	r3, r2, r3
 1111 0740 DBB2     		uxtb	r3, r3
 1112 0742 FB75     		strb	r3, [r7, #23]
 357:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 1113              		.loc 1 357 0
 1114 0744 03E0     		b	.L39
 1115              	.L37:
 358:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****     case IEEE154_ASH_SLF_TYPE_ENC:    // encryption only
 359:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          // unsecure, should not support it
 360:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          return E_FAIL;
 1116              		.loc 1 360 0
 1117 0746 0123     		movs	r3, #1
 1118 0748 48E0     		b	.L43
 1119              	.L34:
 361:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****     default:
 362:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          // reject anything else
 363:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          return E_FAIL;
 1120              		.loc 1 363 0
 1121 074a 0123     		movs	r3, #1
 1122 074c 46E0     		b	.L43
 1123              	.L39:
 364:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 365:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 366:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    // assert
 367:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (len_a + len_m > 125) {
 1124              		.loc 1 367 0
 1125 074e 97F84730 		ldrb	r3, [r7, #71]	@ zero_extendqisi2
 1126 0752 FA7D     		ldrb	r2, [r7, #23]	@ zero_extendqisi2
 1127 0754 1344     		add	r3, r3, r2
 1128 0756 7D2B     		cmp	r3, #125
 1129 0758 0BDD     		ble	.L40
 368:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 369:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                            (errorparameter_t)msg->l2_frameType,
 1130              		.loc 1 369 0
 1131 075a 7B68     		ldr	r3, [r7, #4]
 1132 075c 93F84930 		ldrb	r3, [r3, #73]	@ zero_extendqisi2
 368:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 1133              		.loc 1 368 0
 1134 0760 9BB2     		uxth	r3, r3
 1135 0762 2620     		movs	r0, #38
 1136 0764 3B21     		movs	r1, #59
 1137 0766 1A46     		mov	r2, r3
 1138 0768 0223     		movs	r3, #2
 1139 076a FFF7FEFF 		bl	openserial_printError
 370:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                            (errorparameter_t)2);
 371:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       return E_FAIL;
 1140              		.loc 1 371 0
 1141 076e 0123     		movs	r3, #1
 1142 0770 34E0     		b	.L43
 1143              	.L40:
 372:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 373:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 374:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (msg->l2_authenticationLength != 0) {
 1144              		.loc 1 374 0
 1145 0772 7B68     		ldr	r3, [r7, #4]
 1146 0774 93F87E30 		ldrb	r3, [r3, #126]	@ zero_extendqisi2
 1147 0778 002B     		cmp	r3, #0
 1148 077a 06D0     		beq	.L41
 375:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       //update the length of the packet
 376:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       packetfunctions_reserveFooterSize(msg,msg->l2_authenticationLength);
 1149              		.loc 1 376 0
 1150 077c 7B68     		ldr	r3, [r7, #4]
 1151 077e 93F87E30 		ldrb	r3, [r3, #126]	@ zero_extendqisi2
 1152 0782 7868     		ldr	r0, [r7, #4]
 1153 0784 1946     		mov	r1, r3
 1154 0786 FFF7FEFF 		bl	packetfunctions_reserveFooterSize
 1155              	.L41:
 377:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 378:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 379:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //Encryption and/or authentication
 380:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    // CRYPTO_ENGINE overwrites m[] with ciphertext and appends the MIC
 381:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    outStatus = CRYPTO_ENGINE.aes_ccms_enc(a,
 1156              		.loc 1 381 0
 1157 078a 174B     		ldr	r3, .L44
 1158 078c 1C68     		ldr	r4, [r3]
 1159 078e 7B68     		ldr	r3, [r7, #4]
 1160 0790 93F87E30 		ldrb	r3, [r3, #126]	@ zero_extendqisi2
 1161 0794 97F84710 		ldrb	r1, [r7, #71]	@ zero_extendqisi2
 1162 0798 07F11705 		add	r5, r7, #23
 1163 079c 07F12802 		add	r2, r7, #40
 1164 07a0 0092     		str	r2, [sp]
 1165 07a2 0222     		movs	r2, #2
 1166 07a4 0192     		str	r2, [sp, #4]
 1167 07a6 07F11802 		add	r2, r7, #24
 1168 07aa 0292     		str	r2, [sp, #8]
 1169 07ac 0393     		str	r3, [sp, #12]
 1170 07ae B86C     		ldr	r0, [r7, #72]
 1171 07b0 3A6C     		ldr	r2, [r7, #64]
 1172 07b2 2B46     		mov	r3, r5
 1173 07b4 A047     		blx	r4
 1174 07b6 0346     		mov	r3, r0
 1175 07b8 87F83730 		strb	r3, [r7, #55]
 382:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                           len_a,
 383:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                           m,
 384:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                           &len_m,
 385:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                           nonce,
 386:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                           2, // L=2 in 15.4 std
 387:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                           key,
 388:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                           msg->l2_authenticationLength);
 389:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 390:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //verify that no errors occurred
 391:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (outStatus != E_SUCCESS) {
 1176              		.loc 1 391 0
 1177 07bc 97F83730 		ldrb	r3, [r7, #55]	@ zero_extendqisi2
 1178 07c0 002B     		cmp	r3, #0
 1179 07c2 09D0     		beq	.L42
 392:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 393:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       (errorparameter_t)msg->l2_frameType,
 1180              		.loc 1 393 0
 1181 07c4 7B68     		ldr	r3, [r7, #4]
 1182 07c6 93F84930 		ldrb	r3, [r3, #73]	@ zero_extendqisi2
 392:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 1183              		.loc 1 392 0
 1184 07ca 9BB2     		uxth	r3, r3
 1185 07cc 2620     		movs	r0, #38
 1186 07ce 3B21     		movs	r1, #59
 1187 07d0 1A46     		mov	r2, r3
 1188 07d2 0323     		movs	r3, #3
 1189 07d4 FFF7FEFF 		bl	openserial_printError
 1190              	.L42:
 394:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       (errorparameter_t)3);
 395:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 396:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 397:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    return outStatus;
 1191              		.loc 1 397 0
 1192 07d8 97F83730 		ldrb	r3, [r7, #55]	@ zero_extendqisi2
 1193              	.L43:
 398:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** }
 1194              		.loc 1 398 0 discriminator 1
 1195 07dc 1846     		mov	r0, r3
 1196 07de 5037     		adds	r7, r7, #80
 1197              		.cfi_def_cfa_offset 24
 1198 07e0 BD46     		mov	sp, r7
 1199              		.cfi_def_cfa_register 13
 1200              		@ sp needed
 1201 07e2 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1202              	.L45:
 1203 07e6 00BF     		.align	2
 1204              	.L44:
 1205 07e8 00000000 		.word	board_crypto_engine
 1206              		.cfi_endproc
 1207              	.LFE2:
 1209              		.align	2
 1210              		.global	IEEE802154_security_retrieveAuxiliarySecurityHeader
 1211              		.thumb
 1212              		.thumb_func
 1214              	IEEE802154_security_retrieveAuxiliarySecurityHeader:
 1215              	.LFB3:
 399:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 400:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** /**
 401:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** \brief Parsing of IEEE802.15.4 Auxiliary Security Header.
 402:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** */
 403:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** void IEEE802154_security_retrieveAuxiliarySecurityHeader(OpenQueueEntry_t*      msg, 
 404:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                         ieee802154_header_iht* tempheader){
 1216              		.loc 1 404 0
 1217              		.cfi_startproc
 1218              		@ args = 0, pretend = 0, frame = 32
 1219              		@ frame_needed = 1, uses_anonymous_args = 0
 1220 07ec B0B5     		push	{r4, r5, r7, lr}
 1221              		.cfi_def_cfa_offset 16
 1222              		.cfi_offset 4, -16
 1223              		.cfi_offset 5, -12
 1224              		.cfi_offset 7, -8
 1225              		.cfi_offset 14, -4
 1226 07ee 88B0     		sub	sp, sp, #32
 1227              		.cfi_def_cfa_offset 48
 1228 07f0 00AF     		add	r7, sp, #0
 1229              		.cfi_def_cfa_register 7
 1230 07f2 7860     		str	r0, [r7, #4]
 1231 07f4 3960     		str	r1, [r7]
 405:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 406:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t frameCnt_Suppression;
 407:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t frameCnt_Size;
 408:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t temp8b;
 409:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t i;
 410:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t receivedASN[5];
 411:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    open_addr_t* temp_addr;
 412:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 413:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //Retrieve the Security Control field
 414:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //1byte, Security Control Field
 415:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    temp8b = *((uint8_t*)(msg->payload)+tempheader->headerLength);
 1232              		.loc 1 415 0
 1233 07f6 7B68     		ldr	r3, [r7, #4]
 1234 07f8 5B68     		ldr	r3, [r3, #4]
 1235 07fa 3A68     		ldr	r2, [r7]
 1236 07fc 5278     		ldrb	r2, [r2, #1]	@ zero_extendqisi2
 1237 07fe 1344     		add	r3, r3, r2
 1238 0800 1B78     		ldrb	r3, [r3]
 1239 0802 7B77     		strb	r3, [r7, #29]
 416:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    msg->l2_securityLevel = (temp8b >> IEEE154_ASH_SCF_SECURITY_LEVEL)& 0x07;//3b
 1240              		.loc 1 416 0
 1241 0804 7B7F     		ldrb	r3, [r7, #29]
 1242 0806 03F00703 		and	r3, r3, #7
 1243 080a DAB2     		uxtb	r2, r3
 1244 080c 7B68     		ldr	r3, [r7, #4]
 1245 080e 83F86A20 		strb	r2, [r3, #106]
 417:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 418:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //identify the length of the MIC looking the security level
 419:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    msg->l2_authenticationLength = IEEE802154_security_authLengthChecking(msg->l2_securityLevel);
 1246              		.loc 1 419 0
 1247 0812 7B68     		ldr	r3, [r7, #4]
 1248 0814 93F86A30 		ldrb	r3, [r3, #106]	@ zero_extendqisi2
 1249 0818 1846     		mov	r0, r3
 1250 081a FFF7FEFF 		bl	IEEE802154_security_authLengthChecking
 1251 081e 0346     		mov	r3, r0
 1252 0820 1A46     		mov	r2, r3
 1253 0822 7B68     		ldr	r3, [r7, #4]
 1254 0824 83F87E20 		strb	r2, [r3, #126]
 420:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 421:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //retrieve the KeyIdMode field
 422:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    msg->l2_keyIdMode = (temp8b >> IEEE154_ASH_SCF_KEY_IDENTIFIER_MODE)& 0x03;//2b
 1255              		.loc 1 422 0
 1256 0828 7B7F     		ldrb	r3, [r7, #29]	@ zero_extendqisi2
 1257 082a DB08     		lsrs	r3, r3, #3
 1258 082c DBB2     		uxtb	r3, r3
 1259 082e 03F00303 		and	r3, r3, #3
 1260 0832 DAB2     		uxtb	r2, r3
 1261 0834 7B68     		ldr	r3, [r7, #4]
 1262 0836 83F86B20 		strb	r2, [r3, #107]
 423:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 424:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //retrieve information on the Frame Counter Mode
 425:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    frameCnt_Suppression = (temp8b >> IEEE154_ASH_SCF_FRAME_CNT_MODE)& 0x01;//1b
 1263              		.loc 1 425 0
 1264 083a 7B7F     		ldrb	r3, [r7, #29]	@ zero_extendqisi2
 1265 083c 5B09     		lsrs	r3, r3, #5
 1266 083e DBB2     		uxtb	r3, r3
 1267 0840 03F00103 		and	r3, r3, #1
 1268 0844 3B77     		strb	r3, [r7, #28]
 426:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    frameCnt_Size = (temp8b >> IEEE154_ASH_SCF_FRAME_CNT_SIZE)& 0x01;//1b
 1269              		.loc 1 426 0
 1270 0846 7B7F     		ldrb	r3, [r7, #29]	@ zero_extendqisi2
 1271 0848 9B09     		lsrs	r3, r3, #6
 1272 084a DBB2     		uxtb	r3, r3
 1273 084c 03F00103 		and	r3, r3, #1
 1274 0850 FB77     		strb	r3, [r7, #31]
 427:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 428:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //if the frame counter is zero, it is 4-bytes long, 5 otherwise
 429:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (frameCnt_Size == IEEE154_ASH_FRAMECOUNTER_COUNTER) {
 1275              		.loc 1 429 0
 1276 0852 FB7F     		ldrb	r3, [r7, #31]	@ zero_extendqisi2
 1277 0854 002B     		cmp	r3, #0
 1278 0856 02D1     		bne	.L47
 430:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       frameCnt_Size = 4;
 1279              		.loc 1 430 0
 1280 0858 0423     		movs	r3, #4
 1281 085a FB77     		strb	r3, [r7, #31]
 1282 085c 01E0     		b	.L48
 1283              	.L47:
 431:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    } else {
 432:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       frameCnt_Size = 5;
 1284              		.loc 1 432 0
 1285 085e 0523     		movs	r3, #5
 1286 0860 FB77     		strb	r3, [r7, #31]
 1287              	.L48:
 433:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 434:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 435:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    tempheader->headerLength++;
 1288              		.loc 1 435 0
 1289 0862 3B68     		ldr	r3, [r7]
 1290 0864 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 1291 0866 0133     		adds	r3, r3, #1
 1292 0868 DAB2     		uxtb	r2, r3
 1293 086a 3B68     		ldr	r3, [r7]
 1294 086c 5A70     		strb	r2, [r3, #1]
 436:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 437:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //Frame Counter field
 438:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    macFrameCounter_t l2_frameCounter;
 439:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (frameCnt_Suppression == IEEE154_ASH_FRAMECOUNTER_PRESENT){//the frame counter is here
 1295              		.loc 1 439 0
 1296 086e 3B7F     		ldrb	r3, [r7, #28]	@ zero_extendqisi2
 1297 0870 002B     		cmp	r3, #0
 1298 0872 42D1     		bne	.L49
 440:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       //the frame counter size can be 4 or 5 bytes
 441:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       for (i=0;i<frameCnt_Size;i++){
 1299              		.loc 1 441 0
 1300 0874 0023     		movs	r3, #0
 1301 0876 BB77     		strb	r3, [r7, #30]
 1302 0878 14E0     		b	.L50
 1303              	.L51:
 442:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****           receivedASN[i] = *((uint8_t*)(msg->payload)+tempheader->headerLength);
 1304              		.loc 1 442 0 discriminator 3
 1305 087a BB7F     		ldrb	r3, [r7, #30]	@ zero_extendqisi2
 1306 087c 7A68     		ldr	r2, [r7, #4]
 1307 087e 5268     		ldr	r2, [r2, #4]
 1308 0880 3968     		ldr	r1, [r7]
 1309 0882 4978     		ldrb	r1, [r1, #1]	@ zero_extendqisi2
 1310 0884 0A44     		add	r2, r2, r1
 1311 0886 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 1312 0888 07F12001 		add	r1, r7, #32
 1313 088c 0B44     		add	r3, r3, r1
 1314 088e 03F8102C 		strb	r2, [r3, #-16]
 443:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****           tempheader->headerLength++;
 1315              		.loc 1 443 0 discriminator 3
 1316 0892 3B68     		ldr	r3, [r7]
 1317 0894 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 1318 0896 0133     		adds	r3, r3, #1
 1319 0898 DAB2     		uxtb	r2, r3
 1320 089a 3B68     		ldr	r3, [r7]
 1321 089c 5A70     		strb	r2, [r3, #1]
 441:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****           receivedASN[i] = *((uint8_t*)(msg->payload)+tempheader->headerLength);
 1322              		.loc 1 441 0 discriminator 3
 1323 089e BB7F     		ldrb	r3, [r7, #30]	@ zero_extendqisi2
 1324 08a0 0133     		adds	r3, r3, #1
 1325 08a2 BB77     		strb	r3, [r7, #30]
 1326              	.L50:
 441:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****           receivedASN[i] = *((uint8_t*)(msg->payload)+tempheader->headerLength);
 1327              		.loc 1 441 0 is_stmt 0 discriminator 1
 1328 08a4 BA7F     		ldrb	r2, [r7, #30]	@ zero_extendqisi2
 1329 08a6 FB7F     		ldrb	r3, [r7, #31]	@ zero_extendqisi2
 1330 08a8 9A42     		cmp	r2, r3
 1331 08aa E6D3     		bcc	.L51
 444:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       }
 445:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 446:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       l2_frameCounter.bytes0and1 = receivedASN[0]+256*receivedASN[1];
 1332              		.loc 1 446 0 is_stmt 1
 1333 08ac 3B7C     		ldrb	r3, [r7, #16]	@ zero_extendqisi2
 1334 08ae 9AB2     		uxth	r2, r3
 1335 08b0 7B7C     		ldrb	r3, [r7, #17]	@ zero_extendqisi2
 1336 08b2 9BB2     		uxth	r3, r3
 1337 08b4 1B02     		lsls	r3, r3, #8
 1338 08b6 9BB2     		uxth	r3, r3
 1339 08b8 1344     		add	r3, r3, r2
 1340 08ba 9BB2     		uxth	r3, r3
 1341 08bc A7F80B30 		strh	r3, [r7, #11]	@ unaligned
 447:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       l2_frameCounter.bytes2and3 = receivedASN[2]+256*receivedASN[3];
 1342              		.loc 1 447 0
 1343 08c0 BB7C     		ldrb	r3, [r7, #18]	@ zero_extendqisi2
 1344 08c2 9AB2     		uxth	r2, r3
 1345 08c4 FB7C     		ldrb	r3, [r7, #19]	@ zero_extendqisi2
 1346 08c6 9BB2     		uxth	r3, r3
 1347 08c8 1B02     		lsls	r3, r3, #8
 1348 08ca 9BB2     		uxth	r3, r3
 1349 08cc 1344     		add	r3, r3, r2
 1350 08ce 9BB2     		uxth	r3, r3
 1351 08d0 A7F80930 		strh	r3, [r7, #9]	@ unaligned
 448:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if (frameCnt_Size == 5){ //we have the ASN as the frame counter
 1352              		.loc 1 448 0
 1353 08d4 FB7F     		ldrb	r3, [r7, #31]	@ zero_extendqisi2
 1354 08d6 052B     		cmp	r3, #5
 1355 08d8 01D1     		bne	.L52
 449:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          l2_frameCounter.byte4 = receivedASN[4];
 1356              		.loc 1 449 0
 1357 08da 3B7D     		ldrb	r3, [r7, #20]	@ zero_extendqisi2
 1358 08dc 3B72     		strb	r3, [r7, #8]
 1359              	.L52:
 450:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       }
 451:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 452:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if (l2_frameCounter.byte4 == 0xff){ //frame counter overflow
 1360              		.loc 1 452 0
 1361 08de 3B7A     		ldrb	r3, [r7, #8]	@ zero_extendqisi2
 1362 08e0 FF2B     		cmp	r3, #255
 1363 08e2 0AD1     		bne	.L49
 453:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 454:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                               (errorparameter_t)msg->l2_frameType,
 1364              		.loc 1 454 0
 1365 08e4 7B68     		ldr	r3, [r7, #4]
 1366 08e6 93F84930 		ldrb	r3, [r3, #73]	@ zero_extendqisi2
 453:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 1367              		.loc 1 453 0
 1368 08ea 9BB2     		uxth	r3, r3
 1369 08ec 2620     		movs	r0, #38
 1370 08ee 3B21     		movs	r1, #59
 1371 08f0 1A46     		mov	r2, r3
 1372 08f2 0423     		movs	r3, #4
 1373 08f4 FFF7FEFF 		bl	openserial_printError
 455:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                               (errorparameter_t)4);
 456:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          return;
 1374              		.loc 1 456 0
 1375 08f8 77E0     		b	.L46
 1376              	.L49:
 457:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       }
 458:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 459:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 460:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 461:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //retrieve the Key Identifier field
 462:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    switch (msg->l2_keyIdMode){
 1377              		.loc 1 462 0
 1378 08fa 7B68     		ldr	r3, [r7, #4]
 1379 08fc 93F86B30 		ldrb	r3, [r3, #107]	@ zero_extendqisi2
 1380 0900 032B     		cmp	r3, #3
 1381 0902 4CD8     		bhi	.L54
 1382 0904 01A2     		adr	r2, .L56
 1383 0906 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 1384 090a 00BF     		.p2align 2
 1385              	.L56:
 1386 090c 1D090000 		.word	.L55+1
 1387 0910 31090000 		.word	.L57+1
 1388 0914 4F090000 		.word	.L58+1
 1389 0918 77090000 		.word	.L59+1
 1390              		.p2align 1
 1391              	.L55:
 463:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_KEYIDMODE_IMPLICIT:
 464:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          //key is derived implicitly
 465:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          temp_addr = &ieee802154_security_vars.m_macDefaultKeySource;
 1392              		.loc 1 465 0
 1393 091c 344B     		ldr	r3, .L64
 1394 091e BB61     		str	r3, [r7, #24]
 466:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          memcpy(&(msg->l2_keySource), temp_addr, sizeof(open_addr_t));
 1395              		.loc 1 466 0
 1396 0920 7B68     		ldr	r3, [r7, #4]
 1397 0922 6D33     		adds	r3, r3, #109
 1398 0924 1846     		mov	r0, r3
 1399 0926 B969     		ldr	r1, [r7, #24]
 1400 0928 1122     		movs	r2, #17
 1401 092a FFF7FEFF 		bl	memcpy
 467:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 1402              		.loc 1 467 0
 1403 092e 41E0     		b	.L60
 1404              	.L57:
 468:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_KEYIDMODE_DEFAULTKEYSOURCE:
 469:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          msg->l2_keySource = ieee802154_security_vars.m_macDefaultKeySource;
 1405              		.loc 1 469 0
 1406 0930 7B68     		ldr	r3, [r7, #4]
 1407 0932 304A     		ldr	r2, .L64+4
 1408 0934 6D33     		adds	r3, r3, #109
 1409 0936 0932     		adds	r2, r2, #9
 1410 0938 1568     		ldr	r5, [r2]	@ unaligned
 1411 093a 5468     		ldr	r4, [r2, #4]	@ unaligned
 1412 093c 9068     		ldr	r0, [r2, #8]	@ unaligned
 1413 093e D168     		ldr	r1, [r2, #12]	@ unaligned
 1414 0940 1D60     		str	r5, [r3]	@ unaligned
 1415 0942 5C60     		str	r4, [r3, #4]	@ unaligned
 1416 0944 9860     		str	r0, [r3, #8]	@ unaligned
 1417 0946 D960     		str	r1, [r3, #12]	@ unaligned
 1418 0948 127C     		ldrb	r2, [r2, #16]
 1419 094a 1A74     		strb	r2, [r3, #16]
 470:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 1420              		.loc 1 470 0
 1421 094c 32E0     		b	.L60
 1422              	.L58:
 471:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_KEYIDMODE_EXPLICIT_16:
 472:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          packetfunctions_readAddress(((uint8_t*)(msg->payload)+tempheader->headerLength),
 1423              		.loc 1 472 0
 1424 094e 7B68     		ldr	r3, [r7, #4]
 1425 0950 5B68     		ldr	r3, [r3, #4]
 1426 0952 3A68     		ldr	r2, [r7]
 1427 0954 5278     		ldrb	r2, [r2, #1]	@ zero_extendqisi2
 1428 0956 1A44     		add	r2, r2, r3
 1429 0958 7B68     		ldr	r3, [r7, #4]
 1430 095a 6D33     		adds	r3, r3, #109
 1431 095c 1046     		mov	r0, r2
 1432 095e 0121     		movs	r1, #1
 1433 0960 1A46     		mov	r2, r3
 1434 0962 0123     		movs	r3, #1
 1435 0964 FFF7FEFF 		bl	packetfunctions_readAddress
 473:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                      ADDR_16B,
 474:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                      &msg->l2_keySource,
 475:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                      OW_LITTLE_ENDIAN);
 476:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          tempheader->headerLength+=2;
 1436              		.loc 1 476 0
 1437 0968 3B68     		ldr	r3, [r7]
 1438 096a 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 1439 096c 0233     		adds	r3, r3, #2
 1440 096e DAB2     		uxtb	r2, r3
 1441 0970 3B68     		ldr	r3, [r7]
 1442 0972 5A70     		strb	r2, [r3, #1]
 477:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 1443              		.loc 1 477 0
 1444 0974 1EE0     		b	.L60
 1445              	.L59:
 478:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_KEYIDMODE_EXPLICIT_64:
 479:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          packetfunctions_readAddress(((uint8_t*)(msg->payload)+tempheader->headerLength),
 1446              		.loc 1 479 0
 1447 0976 7B68     		ldr	r3, [r7, #4]
 1448 0978 5B68     		ldr	r3, [r3, #4]
 1449 097a 3A68     		ldr	r2, [r7]
 1450 097c 5278     		ldrb	r2, [r2, #1]	@ zero_extendqisi2
 1451 097e 1A44     		add	r2, r2, r3
 1452 0980 7B68     		ldr	r3, [r7, #4]
 1453 0982 6D33     		adds	r3, r3, #109
 1454 0984 1046     		mov	r0, r2
 1455 0986 0221     		movs	r1, #2
 1456 0988 1A46     		mov	r2, r3
 1457 098a 0123     		movs	r3, #1
 1458 098c FFF7FEFF 		bl	packetfunctions_readAddress
 480:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                      ADDR_64B,
 481:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                      &msg->l2_keySource,
 482:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                      OW_LITTLE_ENDIAN);
 483:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          tempheader->headerLength+=8;
 1459              		.loc 1 483 0
 1460 0990 3B68     		ldr	r3, [r7]
 1461 0992 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 1462 0994 0833     		adds	r3, r3, #8
 1463 0996 DAB2     		uxtb	r2, r3
 1464 0998 3B68     		ldr	r3, [r7]
 1465 099a 5A70     		strb	r2, [r3, #1]
 484:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 1466              		.loc 1 484 0
 1467 099c 0AE0     		b	.L60
 1468              	.L54:
 485:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       default: //error
 486:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 487:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                               (errorparameter_t)msg->l2_frameType,
 1469              		.loc 1 487 0
 1470 099e 7B68     		ldr	r3, [r7, #4]
 1471 09a0 93F84930 		ldrb	r3, [r3, #73]	@ zero_extendqisi2
 486:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                               (errorparameter_t)msg->l2_frameType,
 1472              		.loc 1 486 0
 1473 09a4 9BB2     		uxth	r3, r3
 1474 09a6 2620     		movs	r0, #38
 1475 09a8 3B21     		movs	r1, #59
 1476 09aa 1A46     		mov	r2, r3
 1477 09ac 0523     		movs	r3, #5
 1478 09ae FFF7FEFF 		bl	openserial_printError
 488:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                               (errorparameter_t)5);
 489:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          return;
 1479              		.loc 1 489 0
 1480 09b2 1AE0     		b	.L46
 1481              	.L60:
 490:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       }
 491:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 492:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //retrieve the KeyIndex
 493:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (msg->l2_keyIdMode != IEEE154_ASH_KEYIDMODE_IMPLICIT){
 1482              		.loc 1 493 0
 1483 09b4 7B68     		ldr	r3, [r7, #4]
 1484 09b6 93F86B30 		ldrb	r3, [r3, #107]	@ zero_extendqisi2
 1485 09ba 002B     		cmp	r3, #0
 1486 09bc 11D0     		beq	.L61
 494:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       temp8b = *((uint8_t*)(msg->payload)+tempheader->headerLength);
 1487              		.loc 1 494 0
 1488 09be 7B68     		ldr	r3, [r7, #4]
 1489 09c0 5B68     		ldr	r3, [r3, #4]
 1490 09c2 3A68     		ldr	r2, [r7]
 1491 09c4 5278     		ldrb	r2, [r2, #1]	@ zero_extendqisi2
 1492 09c6 1344     		add	r3, r3, r2
 1493 09c8 1B78     		ldrb	r3, [r3]
 1494 09ca 7B77     		strb	r3, [r7, #29]
 495:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       msg->l2_keyIndex = (temp8b);
 1495              		.loc 1 495 0
 1496 09cc 7B68     		ldr	r3, [r7, #4]
 1497 09ce 7A7F     		ldrb	r2, [r7, #29]
 1498 09d0 83F86C20 		strb	r2, [r3, #108]
 496:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       tempheader->headerLength++;
 1499              		.loc 1 496 0
 1500 09d4 3B68     		ldr	r3, [r7]
 1501 09d6 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 1502 09d8 0133     		adds	r3, r3, #1
 1503 09da DAB2     		uxtb	r2, r3
 1504 09dc 3B68     		ldr	r3, [r7]
 1505 09de 5A70     		strb	r2, [r3, #1]
 1506 09e0 03E0     		b	.L46
 1507              	.L61:
 497:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    } else {
 498:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       //key is derived implicitly
 499:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       msg->l2_keyIndex = 1;
 1508              		.loc 1 499 0
 1509 09e2 7B68     		ldr	r3, [r7, #4]
 1510 09e4 0122     		movs	r2, #1
 1511 09e6 83F86C20 		strb	r2, [r3, #108]
 1512              	.L46:
 500:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 501:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 502:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** }
 1513              		.loc 1 502 0
 1514 09ea 2037     		adds	r7, r7, #32
 1515              		.cfi_def_cfa_offset 16
 1516 09ec BD46     		mov	sp, r7
 1517              		.cfi_def_cfa_register 13
 1518              		@ sp needed
 1519 09ee B0BD     		pop	{r4, r5, r7, pc}
 1520              	.L65:
 1521              		.align	2
 1522              	.L64:
 1523 09f0 09000000 		.word	ieee802154_security_vars+9
 1524 09f4 00000000 		.word	ieee802154_security_vars
 1525              		.cfi_endproc
 1526              	.LFE3:
 1528              		.align	2
 1529              		.global	IEEE802154_security_incomingFrame
 1530              		.thumb
 1531              		.thumb_func
 1533              	IEEE802154_security_incomingFrame:
 1534              	.LFB4:
 503:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 504:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** /**
 505:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** \brief Identification of the key used to protect the frame and unsecuring operations.
 506:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** */
 507:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** owerror_t IEEE802154_security_incomingFrame(OpenQueueEntry_t* msg){
 1535              		.loc 1 507 0
 1536              		.cfi_startproc
 1537              		@ args = 0, pretend = 0, frame = 64
 1538              		@ frame_needed = 1, uses_anonymous_args = 0
 1539 09f8 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 1540              		.cfi_def_cfa_offset 24
 1541              		.cfi_offset 4, -24
 1542              		.cfi_offset 5, -20
 1543              		.cfi_offset 6, -16
 1544              		.cfi_offset 7, -12
 1545              		.cfi_offset 8, -8
 1546              		.cfi_offset 14, -4
 1547 09fc 94B0     		sub	sp, sp, #80
 1548              		.cfi_def_cfa_offset 104
 1549 09fe 04AF     		add	r7, sp, #16
 1550              		.cfi_def_cfa 7, 88
 1551 0a00 7860     		str	r0, [r7, #4]
 508:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    
 509:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    m_deviceDescriptor*        deviceDescriptor;
 510:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    m_keyDescriptor*           keyDescriptor;
 511:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    m_securityLevelDescriptor* securityLevelDescriptor;
 512:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t nonce[13];
 513:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t i;
 514:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t myASN[5];
 515:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    owerror_t outStatus;
 516:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t* a;
 517:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t len_a;
 518:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t* c;
 519:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t len_c;
 520:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 521:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //key descriptor lookup procedure
 522:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    keyDescriptor = IEEE802154_security_keyDescriptorLookup(msg->l2_keyIdMode,
 1552              		.loc 1 522 0
 1553 0a02 7B68     		ldr	r3, [r7, #4]
 1554 0a04 93F86B80 		ldrb	r8, [r3, #107]	@ zero_extendqisi2
 1555 0a08 7B68     		ldr	r3, [r7, #4]
 1556 0a0a 03F16D06 		add	r6, r3, #109
 1557 0a0e 7B68     		ldr	r3, [r7, #4]
 1558 0a10 93F86C50 		ldrb	r5, [r3, #108]	@ zero_extendqisi2
 1559 0a14 7B68     		ldr	r3, [r7, #4]
 1560 0a16 03F16D04 		add	r4, r3, #109
 1561 0a1a 0420     		movs	r0, #4
 1562 0a1c FFF7FEFF 		bl	idmanager_getMyID
 1563 0a20 0246     		mov	r2, r0
 1564 0a22 7B68     		ldr	r3, [r7, #4]
 1565 0a24 93F84930 		ldrb	r3, [r3, #73]	@ zero_extendqisi2
 1566 0a28 0092     		str	r2, [sp]
 1567 0a2a 0193     		str	r3, [sp, #4]
 1568 0a2c 4046     		mov	r0, r8
 1569 0a2e 3146     		mov	r1, r6
 1570 0a30 2A46     		mov	r2, r5
 1571 0a32 2346     		mov	r3, r4
 1572 0a34 FFF7FEFF 		bl	IEEE802154_security_keyDescriptorLookup
 1573 0a38 F862     		str	r0, [r7, #44]
 523:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                           &msg->l2_keySource,
 524:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                           msg->l2_keyIndex,
 525:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                           &msg->l2_keySource,
 526:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                           idmanager_getMyID(ADDR_PANID),
 527:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                           msg->l2_frameType);
 528:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 529:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (keyDescriptor==NULL){//can't find the key
 1574              		.loc 1 529 0
 1575 0a3a FB6A     		ldr	r3, [r7, #44]
 1576 0a3c 002B     		cmp	r3, #0
 1577 0a3e 0BD1     		bne	.L67
 530:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 531:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                            (errorparameter_t)msg->l2_frameType,
 1578              		.loc 1 531 0
 1579 0a40 7B68     		ldr	r3, [r7, #4]
 1580 0a42 93F84930 		ldrb	r3, [r3, #73]	@ zero_extendqisi2
 530:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 1581              		.loc 1 530 0
 1582 0a46 9BB2     		uxth	r3, r3
 1583 0a48 2620     		movs	r0, #38
 1584 0a4a 3B21     		movs	r1, #59
 1585 0a4c 1A46     		mov	r2, r3
 1586 0a4e 0623     		movs	r3, #6
 1587 0a50 FFF7FEFF 		bl	openserial_printError
 532:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                            (errorparameter_t)6);
 533:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       return E_FAIL;
 1588              		.loc 1 533 0
 1589 0a54 0123     		movs	r3, #1
 1590 0a56 26E1     		b	.L83
 1591              	.L67:
 534:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 535:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 536:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //device descriptor lookup
 537:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    deviceDescriptor = IEEE802154_security_deviceDescriptorLookup(&msg->l2_keySource,
 1592              		.loc 1 537 0
 1593 0a58 7B68     		ldr	r3, [r7, #4]
 1594 0a5a 03F16D04 		add	r4, r3, #109
 1595 0a5e 0420     		movs	r0, #4
 1596 0a60 FFF7FEFF 		bl	idmanager_getMyID
 1597 0a64 0346     		mov	r3, r0
 1598 0a66 2046     		mov	r0, r4
 1599 0a68 1946     		mov	r1, r3
 1600 0a6a FA6A     		ldr	r2, [r7, #44]
 1601 0a6c FFF7FEFF 		bl	IEEE802154_security_deviceDescriptorLookup
 1602 0a70 B862     		str	r0, [r7, #40]
 538:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                                 idmanager_getMyID(ADDR_PANID),
 539:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                                 keyDescriptor);
 540:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 541:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (deviceDescriptor==NULL){//can't find the device in the list of authorized neighbors
 1603              		.loc 1 541 0
 1604 0a72 BB6A     		ldr	r3, [r7, #40]
 1605 0a74 002B     		cmp	r3, #0
 1606 0a76 0BD1     		bne	.L69
 542:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 543:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                            (errorparameter_t)msg->l2_frameType,
 1607              		.loc 1 543 0
 1608 0a78 7B68     		ldr	r3, [r7, #4]
 1609 0a7a 93F84930 		ldrb	r3, [r3, #73]	@ zero_extendqisi2
 542:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 1610              		.loc 1 542 0
 1611 0a7e 9BB2     		uxth	r3, r3
 1612 0a80 2620     		movs	r0, #38
 1613 0a82 3B21     		movs	r1, #59
 1614 0a84 1A46     		mov	r2, r3
 1615 0a86 0723     		movs	r3, #7
 1616 0a88 FFF7FEFF 		bl	openserial_printError
 544:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                            (errorparameter_t)7);
 545:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       return E_FAIL;
 1617              		.loc 1 545 0
 1618 0a8c 0123     		movs	r3, #1
 1619 0a8e 0AE1     		b	.L83
 1620              	.L69:
 546:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 547:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 548:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //Security Level Descriptorlookup
 549:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    securityLevelDescriptor = IEEE802154_security_securityLevelDescriptorLookup(msg->l2_frameType,
 1621              		.loc 1 549 0
 1622 0a90 7B68     		ldr	r3, [r7, #4]
 1623 0a92 93F84920 		ldrb	r2, [r3, #73]	@ zero_extendqisi2
 1624 0a96 7B68     		ldr	r3, [r7, #4]
 1625 0a98 93F87F30 		ldrb	r3, [r3, #127]	@ zero_extendqisi2
 1626 0a9c 1046     		mov	r0, r2
 1627 0a9e 1946     		mov	r1, r3
 1628 0aa0 FFF7FEFF 		bl	IEEE802154_security_securityLevelDescriptorLookup
 1629 0aa4 7862     		str	r0, [r7, #36]
 550:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                                               msg->commandFrameIden
 551:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 552:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (securityLevelDescriptor == NULL){//can't find the frame type in the list of allowed frame ty
 1630              		.loc 1 552 0
 1631 0aa6 7B6A     		ldr	r3, [r7, #36]
 1632 0aa8 002B     		cmp	r3, #0
 1633 0aaa 0BD1     		bne	.L70
 553:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 554:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                            (errorparameter_t)msg->l2_frameType,
 1634              		.loc 1 554 0
 1635 0aac 7B68     		ldr	r3, [r7, #4]
 1636 0aae 93F84930 		ldrb	r3, [r3, #73]	@ zero_extendqisi2
 553:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 1637              		.loc 1 553 0
 1638 0ab2 9BB2     		uxth	r3, r3
 1639 0ab4 2620     		movs	r0, #38
 1640 0ab6 3B21     		movs	r1, #59
 1641 0ab8 1A46     		mov	r2, r3
 1642 0aba 0823     		movs	r3, #8
 1643 0abc FFF7FEFF 		bl	openserial_printError
 555:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                            (errorparameter_t)8);
 556:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       return E_FAIL;
 1644              		.loc 1 556 0
 1645 0ac0 0123     		movs	r3, #1
 1646 0ac2 F0E0     		b	.L83
 1647              	.L70:
 557:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 558:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 559:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //incoming security level checking
 560:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    outStatus = IEEE802154_security_incomingSecurityLevelChecking(securityLevelDescriptor,
 1648              		.loc 1 560 0
 1649 0ac4 7B68     		ldr	r3, [r7, #4]
 1650 0ac6 93F86A20 		ldrb	r2, [r3, #106]	@ zero_extendqisi2
 1651 0aca BB6A     		ldr	r3, [r7, #40]
 1652 0acc 9B7D     		ldrb	r3, [r3, #22]	@ zero_extendqisi2
 1653 0ace 786A     		ldr	r0, [r7, #36]
 1654 0ad0 1146     		mov	r1, r2
 1655 0ad2 1A46     		mov	r2, r3
 1656 0ad4 FFF7FEFF 		bl	IEEE802154_security_incomingSecurityLevelChecking
 1657 0ad8 0346     		mov	r3, r0
 1658 0ada 87F82330 		strb	r3, [r7, #35]
 561:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                                  msg->l2_securityLevel,
 562:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                                  deviceDescriptor->Exempt);
 563:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 564:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if(outStatus == FALSE) {//security level not allowed according to local security policies
 1659              		.loc 1 564 0
 1660 0ade 97F82330 		ldrb	r3, [r7, #35]	@ zero_extendqisi2
 1661 0ae2 002B     		cmp	r3, #0
 1662 0ae4 0BD1     		bne	.L71
 565:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 566:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                            (errorparameter_t)msg->l2_frameType,
 1663              		.loc 1 566 0
 1664 0ae6 7B68     		ldr	r3, [r7, #4]
 1665 0ae8 93F84930 		ldrb	r3, [r3, #73]	@ zero_extendqisi2
 565:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 1666              		.loc 1 565 0
 1667 0aec 9BB2     		uxth	r3, r3
 1668 0aee 2620     		movs	r0, #38
 1669 0af0 3B21     		movs	r1, #59
 1670 0af2 1A46     		mov	r2, r3
 1671 0af4 0923     		movs	r3, #9
 1672 0af6 FFF7FEFF 		bl	openserial_printError
 567:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                            (errorparameter_t)9);
 568:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       return E_FAIL;
 1673              		.loc 1 568 0
 1674 0afa 0123     		movs	r3, #1
 1675 0afc D3E0     		b	.L83
 1676              	.L71:
 569:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 570:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 571:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //incoming key usage policy checking
 572:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    outStatus = IEEE802154_security_incomingKeyUsagePolicyChecking(keyDescriptor,
 1677              		.loc 1 572 0
 1678 0afe 7B68     		ldr	r3, [r7, #4]
 1679 0b00 93F84930 		ldrb	r3, [r3, #73]	@ zero_extendqisi2
 1680 0b04 F86A     		ldr	r0, [r7, #44]
 1681 0b06 1946     		mov	r1, r3
 1682 0b08 0022     		movs	r2, #0
 1683 0b0a FFF7FEFF 		bl	IEEE802154_security_incomingKeyUsagePolicyChecking
 1684 0b0e 0346     		mov	r3, r0
 1685 0b10 87F82330 		strb	r3, [r7, #35]
 573:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                                   msg->l2_frameType,
 574:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                                   0);
 575:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if(outStatus == FALSE){// improper use of the key, according to local security policies
 1686              		.loc 1 575 0
 1687 0b14 97F82330 		ldrb	r3, [r7, #35]	@ zero_extendqisi2
 1688 0b18 002B     		cmp	r3, #0
 1689 0b1a 0BD1     		bne	.L72
 576:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****      openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 577:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                           (errorparameter_t)msg->l2_frameType,
 1690              		.loc 1 577 0
 1691 0b1c 7B68     		ldr	r3, [r7, #4]
 1692 0b1e 93F84930 		ldrb	r3, [r3, #73]	@ zero_extendqisi2
 576:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****      openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 1693              		.loc 1 576 0
 1694 0b22 9BB2     		uxth	r3, r3
 1695 0b24 2620     		movs	r0, #38
 1696 0b26 3B21     		movs	r1, #59
 1697 0b28 1A46     		mov	r2, r3
 1698 0b2a 0A23     		movs	r3, #10
 1699 0b2c FFF7FEFF 		bl	openserial_printError
 578:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                           (errorparameter_t)10);
 579:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****      return E_FAIL;
 1700              		.loc 1 579 0
 1701 0b30 0123     		movs	r3, #1
 1702 0b32 B8E0     		b	.L83
 1703              	.L72:
 580:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 581:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 582:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //create nonce
 583:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    memset(&nonce[0], 0, 13);
 1704              		.loc 1 583 0
 1705 0b34 07F11403 		add	r3, r7, #20
 1706 0b38 1846     		mov	r0, r3
 1707 0b3a 0021     		movs	r1, #0
 1708 0b3c 0D22     		movs	r2, #13
 1709 0b3e FFF7FEFF 		bl	memset
 584:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //first 8 bytes of the nonce are always the source address of the frame
 585:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    memcpy(&nonce[0],msg->l2_nextORpreviousHop.addr_64b,8);
 1710              		.loc 1 585 0
 1711 0b42 7B68     		ldr	r3, [r7, #4]
 1712 0b44 3933     		adds	r3, r3, #57
 1713 0b46 07F11402 		add	r2, r7, #20
 1714 0b4a 1046     		mov	r0, r2
 1715 0b4c 1946     		mov	r1, r3
 1716 0b4e 0822     		movs	r2, #8
 1717 0b50 FFF7FEFF 		bl	memcpy
 586:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 587:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //Frame Counter (ASN)
 588:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ieee154e_getAsn(myASN);
 1718              		.loc 1 588 0
 1719 0b54 07F10C03 		add	r3, r7, #12
 1720 0b58 1846     		mov	r0, r3
 1721 0b5a FFF7FEFF 		bl	ieee154e_getAsn
 589:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    for (i=0;i<5;i++){
 1722              		.loc 1 589 0
 1723 0b5e 0023     		movs	r3, #0
 1724 0b60 87F83F30 		strb	r3, [r7, #63]
 1725 0b64 13E0     		b	.L73
 1726              	.L74:
 590:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       nonce[8+i] = myASN[i];
 1727              		.loc 1 590 0 discriminator 3
 1728 0b66 97F83F30 		ldrb	r3, [r7, #63]	@ zero_extendqisi2
 1729 0b6a 0833     		adds	r3, r3, #8
 1730 0b6c 97F83F20 		ldrb	r2, [r7, #63]	@ zero_extendqisi2
 1731 0b70 07F14001 		add	r1, r7, #64
 1732 0b74 0A44     		add	r2, r2, r1
 1733 0b76 12F8342C 		ldrb	r2, [r2, #-52]	@ zero_extendqisi2
 1734 0b7a 07F14001 		add	r1, r7, #64
 1735 0b7e 0B44     		add	r3, r3, r1
 1736 0b80 03F82C2C 		strb	r2, [r3, #-44]
 589:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    for (i=0;i<5;i++){
 1737              		.loc 1 589 0 discriminator 3
 1738 0b84 97F83F30 		ldrb	r3, [r7, #63]	@ zero_extendqisi2
 1739 0b88 0133     		adds	r3, r3, #1
 1740 0b8a 87F83F30 		strb	r3, [r7, #63]
 1741              	.L73:
 589:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    for (i=0;i<5;i++){
 1742              		.loc 1 589 0 is_stmt 0 discriminator 1
 1743 0b8e 97F83F30 		ldrb	r3, [r7, #63]	@ zero_extendqisi2
 1744 0b92 042B     		cmp	r3, #4
 1745 0b94 E7D9     		bls	.L74
 591:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 592:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 593:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //identify data to be authenticated and data to be decrypted
 594:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    switch (msg->l2_securityLevel) {
 1746              		.loc 1 594 0 is_stmt 1
 1747 0b96 7B68     		ldr	r3, [r7, #4]
 1748 0b98 93F86A30 		ldrb	r3, [r3, #106]	@ zero_extendqisi2
 1749 0b9c 013B     		subs	r3, r3, #1
 1750 0b9e 062B     		cmp	r3, #6
 1751 0ba0 3BD8     		bhi	.L75
 1752 0ba2 01A2     		adr	r2, .L77
 1753 0ba4 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 1754              		.p2align 2
 1755              	.L77:
 1756 0ba8 C50B0000 		.word	.L76+1
 1757 0bac C50B0000 		.word	.L76+1
 1758 0bb0 C50B0000 		.word	.L76+1
 1759 0bb4 170C0000 		.word	.L78+1
 1760 0bb8 F10B0000 		.word	.L79+1
 1761 0bbc F10B0000 		.word	.L79+1
 1762 0bc0 F10B0000 		.word	.L79+1
 1763              		.p2align 1
 1764              	.L76:
 595:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_MIC_32:  // authentication only cases
 596:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_MIC_64:
 597:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_MIC_128: 
 598:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          a = msg->payload;                                           // first byte of the frame
 1765              		.loc 1 598 0
 1766 0bc4 7B68     		ldr	r3, [r7, #4]
 1767 0bc6 5B68     		ldr	r3, [r3, #4]
 1768 0bc8 BB63     		str	r3, [r7, #56]
 599:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          len_a = msg->length-msg->l2_authenticationLength;           // whole frame
 1769              		.loc 1 599 0
 1770 0bca 7B68     		ldr	r3, [r7, #4]
 1771 0bcc 1A7A     		ldrb	r2, [r3, #8]	@ zero_extendqisi2
 1772 0bce 7B68     		ldr	r3, [r7, #4]
 1773 0bd0 93F87E30 		ldrb	r3, [r3, #126]	@ zero_extendqisi2
 1774 0bd4 D31A     		subs	r3, r2, r3
 1775 0bd6 87F83730 		strb	r3, [r7, #55]
 600:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          c = &msg->payload[len_a];                                   // MIC is at the end of the fr
 1776              		.loc 1 600 0
 1777 0bda 7B68     		ldr	r3, [r7, #4]
 1778 0bdc 5A68     		ldr	r2, [r3, #4]
 1779 0bde 97F83730 		ldrb	r3, [r7, #55]	@ zero_extendqisi2
 1780 0be2 1344     		add	r3, r3, r2
 1781 0be4 3B63     		str	r3, [r7, #48]
 601:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          len_c = msg->l2_authenticationLength;                       // length of the encrypted par
 1782              		.loc 1 601 0
 1783 0be6 7B68     		ldr	r3, [r7, #4]
 1784 0be8 93F87E30 		ldrb	r3, [r3, #126]	@ zero_extendqisi2
 1785 0bec FB72     		strb	r3, [r7, #11]
 602:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 1786              		.loc 1 602 0
 1787 0bee 16E0     		b	.L80
 1788              	.L79:
 603:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_ENC_MIC_32:  // authentication + encryption cases
 604:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_ENC_MIC_64:
 605:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_ENC_MIC_128:
 606:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          a = msg->payload;             // first byte of the frame
 1789              		.loc 1 606 0
 1790 0bf0 7B68     		ldr	r3, [r7, #4]
 1791 0bf2 5B68     		ldr	r3, [r3, #4]
 1792 0bf4 BB63     		str	r3, [r7, #56]
 607:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          c = msg->l2_payload;          // first byte where we should start decrypting 
 1793              		.loc 1 607 0
 1794 0bf6 7B68     		ldr	r3, [r7, #4]
 1795 0bf8 5B6D     		ldr	r3, [r3, #84]
 1796 0bfa 3B63     		str	r3, [r7, #48]
 608:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          len_a = c - a;                // part that is only authenticated is the difference of two 
 1797              		.loc 1 608 0
 1798 0bfc 3A6B     		ldr	r2, [r7, #48]
 1799 0bfe BB6B     		ldr	r3, [r7, #56]
 1800 0c00 D31A     		subs	r3, r2, r3
 1801 0c02 87F83730 		strb	r3, [r7, #55]
 609:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          len_c = msg->length - len_a;  // part that is decrypted+authenticated is the rest of the f
 1802              		.loc 1 609 0
 1803 0c06 7B68     		ldr	r3, [r7, #4]
 1804 0c08 1A7A     		ldrb	r2, [r3, #8]	@ zero_extendqisi2
 1805 0c0a 97F83730 		ldrb	r3, [r7, #55]
 1806 0c0e D31A     		subs	r3, r2, r3
 1807 0c10 DBB2     		uxtb	r3, r3
 1808 0c12 FB72     		strb	r3, [r7, #11]
 610:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 1809              		.loc 1 610 0
 1810 0c14 03E0     		b	.L80
 1811              	.L78:
 611:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_ENC:    // encryption only
 612:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          // unsecure, should not support it
 613:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          return E_FAIL;
 1812              		.loc 1 613 0
 1813 0c16 0123     		movs	r3, #1
 1814 0c18 45E0     		b	.L83
 1815              	.L75:
 614:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       default:
 615:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          // reject anything else
 616:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          return E_FAIL;
 1816              		.loc 1 616 0
 1817 0c1a 0123     		movs	r3, #1
 1818 0c1c 43E0     		b	.L83
 1819              	.L80:
 617:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****     }
 618:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 619:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    // assert
 620:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (len_a + len_c > 125) {
 1820              		.loc 1 620 0
 1821 0c1e 97F83730 		ldrb	r3, [r7, #55]	@ zero_extendqisi2
 1822 0c22 FA7A     		ldrb	r2, [r7, #11]	@ zero_extendqisi2
 1823 0c24 1344     		add	r3, r3, r2
 1824 0c26 7D2B     		cmp	r3, #125
 1825 0c28 0BDD     		ble	.L81
 621:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 622:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                            (errorparameter_t)msg->l2_frameType,
 1826              		.loc 1 622 0
 1827 0c2a 7B68     		ldr	r3, [r7, #4]
 1828 0c2c 93F84930 		ldrb	r3, [r3, #73]	@ zero_extendqisi2
 621:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 1829              		.loc 1 621 0
 1830 0c30 9BB2     		uxth	r3, r3
 1831 0c32 2620     		movs	r0, #38
 1832 0c34 3B21     		movs	r1, #59
 1833 0c36 1A46     		mov	r2, r3
 1834 0c38 0B23     		movs	r3, #11
 1835 0c3a FFF7FEFF 		bl	openserial_printError
 623:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                            (errorparameter_t)11);
 624:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       return E_FAIL;
 1836              		.loc 1 624 0
 1837 0c3e 0123     		movs	r3, #1
 1838 0c40 31E0     		b	.L83
 1839              	.L81:
 625:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 626:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 627:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //decrypt and/or verify authenticity of the frame
 628:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    outStatus = CRYPTO_ENGINE.aes_ccms_dec(a,
 1840              		.loc 1 628 0
 1841 0c42 1B4B     		ldr	r3, .L84
 1842 0c44 5C68     		ldr	r4, [r3, #4]
 629:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                           len_a,
 630:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                           c,
 631:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                           &len_c,
 632:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                           nonce,
 633:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                           2,
 634:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                           keyDescriptor->key,
 1843              		.loc 1 634 0
 1844 0c46 FB6A     		ldr	r3, [r7, #44]
 1845 0c48 03F14202 		add	r2, r3, #66
 628:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                           len_a,
 1846              		.loc 1 628 0
 1847 0c4c 7B68     		ldr	r3, [r7, #4]
 1848 0c4e 93F87E30 		ldrb	r3, [r3, #126]	@ zero_extendqisi2
 1849 0c52 97F83760 		ldrb	r6, [r7, #55]	@ zero_extendqisi2
 1850 0c56 07F10B05 		add	r5, r7, #11
 1851 0c5a 07F11401 		add	r1, r7, #20
 1852 0c5e 0091     		str	r1, [sp]
 1853 0c60 0221     		movs	r1, #2
 1854 0c62 0191     		str	r1, [sp, #4]
 1855 0c64 0292     		str	r2, [sp, #8]
 1856 0c66 0393     		str	r3, [sp, #12]
 1857 0c68 B86B     		ldr	r0, [r7, #56]
 1858 0c6a 3146     		mov	r1, r6
 1859 0c6c 3A6B     		ldr	r2, [r7, #48]
 1860 0c6e 2B46     		mov	r3, r5
 1861 0c70 A047     		blx	r4
 1862 0c72 0346     		mov	r3, r0
 1863 0c74 87F82330 		strb	r3, [r7, #35]
 635:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                           msg->l2_authenticationLength);
 636:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 637:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //verify if any error occurs
 638:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (outStatus != E_SUCCESS){
 1864              		.loc 1 638 0
 1865 0c78 97F82330 		ldrb	r3, [r7, #35]	@ zero_extendqisi2
 1866 0c7c 002B     		cmp	r3, #0
 1867 0c7e 09D0     		beq	.L82
 639:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 640:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                            (errorparameter_t)msg->l2_frameType,
 1868              		.loc 1 640 0
 1869 0c80 7B68     		ldr	r3, [r7, #4]
 1870 0c82 93F84930 		ldrb	r3, [r3, #73]	@ zero_extendqisi2
 639:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       openserial_printError(COMPONENT_SECURITY,ERR_SECURITY,
 1871              		.loc 1 639 0
 1872 0c86 9BB2     		uxth	r3, r3
 1873 0c88 2620     		movs	r0, #38
 1874 0c8a 3B21     		movs	r1, #59
 1875 0c8c 1A46     		mov	r2, r3
 1876 0c8e 0C23     		movs	r3, #12
 1877 0c90 FFF7FEFF 		bl	openserial_printError
 1878              	.L82:
 641:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                            (errorparameter_t)12);
 642:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 643:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 644:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    packetfunctions_tossFooter(msg,msg->l2_authenticationLength);
 1879              		.loc 1 644 0
 1880 0c94 7B68     		ldr	r3, [r7, #4]
 1881 0c96 93F87E30 		ldrb	r3, [r3, #126]	@ zero_extendqisi2
 1882 0c9a 7868     		ldr	r0, [r7, #4]
 1883 0c9c 1946     		mov	r1, r3
 1884 0c9e FFF7FEFF 		bl	packetfunctions_tossFooter
 645:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    return outStatus;
 1885              		.loc 1 645 0
 1886 0ca2 97F82330 		ldrb	r3, [r7, #35]	@ zero_extendqisi2
 1887              	.L83:
 646:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** }
 1888              		.loc 1 646 0 discriminator 1
 1889 0ca6 1846     		mov	r0, r3
 1890 0ca8 4037     		adds	r7, r7, #64
 1891              		.cfi_def_cfa_offset 24
 1892 0caa BD46     		mov	sp, r7
 1893              		.cfi_def_cfa_register 13
 1894              		@ sp needed
 1895 0cac BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1896              	.L85:
 1897              		.align	2
 1898              	.L84:
 1899 0cb0 00000000 		.word	board_crypto_engine
 1900              		.cfi_endproc
 1901              	.LFE4:
 1903              		.align	2
 1904              		.global	IEEE802154_security_authLengthChecking
 1905              		.thumb
 1906              		.thumb_func
 1908              	IEEE802154_security_authLengthChecking:
 1909              	.LFB5:
 647:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 648:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** //=========================== private =========================================
 649:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 650:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** /**
 651:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** \brief Identification of the length of the MIC based on the security Level in the frame
 652:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** */
 653:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** uint8_t IEEE802154_security_authLengthChecking(uint8_t securityLevel){
 1910              		.loc 1 653 0
 1911              		.cfi_startproc
 1912              		@ args = 0, pretend = 0, frame = 16
 1913              		@ frame_needed = 1, uses_anonymous_args = 0
 1914              		@ link register save eliminated.
 1915 0cb4 80B4     		push	{r7}
 1916              		.cfi_def_cfa_offset 4
 1917              		.cfi_offset 7, -4
 1918 0cb6 85B0     		sub	sp, sp, #20
 1919              		.cfi_def_cfa_offset 24
 1920 0cb8 00AF     		add	r7, sp, #0
 1921              		.cfi_def_cfa_register 7
 1922 0cba 0346     		mov	r3, r0
 1923 0cbc FB71     		strb	r3, [r7, #7]
 654:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 655:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t authlen;
 656:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    switch (securityLevel) {
 1924              		.loc 1 656 0
 1925 0cbe FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 1926 0cc0 072B     		cmp	r3, #7
 1927 0cc2 1FD8     		bhi	.L87
 1928 0cc4 01A2     		adr	r2, .L89
 1929 0cc6 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 1930 0cca 00BF     		.p2align 2
 1931              	.L89:
 1932 0ccc ED0C0000 		.word	.L88+1
 1933 0cd0 F30C0000 		.word	.L90+1
 1934 0cd4 F90C0000 		.word	.L91+1
 1935 0cd8 FF0C0000 		.word	.L92+1
 1936 0cdc ED0C0000 		.word	.L88+1
 1937 0ce0 F30C0000 		.word	.L90+1
 1938 0ce4 F90C0000 		.word	.L91+1
 1939 0ce8 FF0C0000 		.word	.L92+1
 1940              		.p2align 1
 1941              	.L88:
 657:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_NOSEC:
 658:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_ENC:
 659:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          authlen = 0;
 1942              		.loc 1 659 0
 1943 0cec 0023     		movs	r3, #0
 1944 0cee FB73     		strb	r3, [r7, #15]
 660:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 1945              		.loc 1 660 0
 1946 0cf0 08E0     		b	.L87
 1947              	.L90:
 661:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_MIC_32:
 662:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_ENC_MIC_32:
 663:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          authlen = 4;
 1948              		.loc 1 663 0
 1949 0cf2 0423     		movs	r3, #4
 1950 0cf4 FB73     		strb	r3, [r7, #15]
 664:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 1951              		.loc 1 664 0
 1952 0cf6 05E0     		b	.L87
 1953              	.L91:
 665:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_MIC_64:
 666:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_ENC_MIC_64:
 667:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          authlen = 8;
 1954              		.loc 1 667 0
 1955 0cf8 0823     		movs	r3, #8
 1956 0cfa FB73     		strb	r3, [r7, #15]
 668:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 1957              		.loc 1 668 0
 1958 0cfc 02E0     		b	.L87
 1959              	.L92:
 669:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_MIC_128:
 670:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_SLF_TYPE_ENC_MIC_128:
 671:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          authlen = 16;
 1960              		.loc 1 671 0
 1961 0cfe 1023     		movs	r3, #16
 1962 0d00 FB73     		strb	r3, [r7, #15]
 672:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 1963              		.loc 1 672 0
 1964 0d02 00BF     		nop
 1965              	.L87:
 673:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       }
 674:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 675:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    return authlen;
 1966              		.loc 1 675 0
 1967 0d04 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 676:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** }
 1968              		.loc 1 676 0
 1969 0d06 1846     		mov	r0, r3
 1970 0d08 1437     		adds	r7, r7, #20
 1971              		.cfi_def_cfa_offset 4
 1972 0d0a BD46     		mov	sp, r7
 1973              		.cfi_def_cfa_register 13
 1974              		@ sp needed
 1975 0d0c 5DF8047B 		ldr	r7, [sp], #4
 1976              		.cfi_restore 7
 1977              		.cfi_def_cfa_offset 0
 1978 0d10 7047     		bx	lr
 1979              		.cfi_endproc
 1980              	.LFE5:
 1982 0d12 00BF     		.align	2
 1983              		.global	IEEE802154_security_auxLengthChecking
 1984              		.thumb
 1985              		.thumb_func
 1987              	IEEE802154_security_auxLengthChecking:
 1988              	.LFB6:
 677:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 678:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** /**
 679:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** \brief Identification of the length of the IEEE802.15.4 Auxiliary Security Header.
 680:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** */
 681:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** uint8_t IEEE802154_security_auxLengthChecking(uint8_t KeyIdMode, 
 682:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                              uint8_t frameCounterSuppression, 
 683:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                              uint8_t frameCounterSize){
 1989              		.loc 1 683 0
 1990              		.cfi_startproc
 1991              		@ args = 0, pretend = 0, frame = 16
 1992              		@ frame_needed = 1, uses_anonymous_args = 0
 1993              		@ link register save eliminated.
 1994 0d14 80B4     		push	{r7}
 1995              		.cfi_def_cfa_offset 4
 1996              		.cfi_offset 7, -4
 1997 0d16 85B0     		sub	sp, sp, #20
 1998              		.cfi_def_cfa_offset 24
 1999 0d18 00AF     		add	r7, sp, #0
 2000              		.cfi_def_cfa_register 7
 2001 0d1a 0346     		mov	r3, r0
 2002 0d1c FB71     		strb	r3, [r7, #7]
 2003 0d1e 0B46     		mov	r3, r1
 2004 0d20 BB71     		strb	r3, [r7, #6]
 2005 0d22 1346     		mov	r3, r2
 2006 0d24 7B71     		strb	r3, [r7, #5]
 684:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t auxilary_len;
 685:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t frameCntLength;
 686:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (frameCounterSuppression == IEEE154_ASH_FRAMECOUNTER_PRESENT){
 2007              		.loc 1 686 0
 2008 0d26 BB79     		ldrb	r3, [r7, #6]	@ zero_extendqisi2
 2009 0d28 002B     		cmp	r3, #0
 2010 0d2a 08D1     		bne	.L95
 687:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if (frameCounterSize == 4){
 2011              		.loc 1 687 0
 2012 0d2c 7B79     		ldrb	r3, [r7, #5]	@ zero_extendqisi2
 2013 0d2e 042B     		cmp	r3, #4
 2014 0d30 02D1     		bne	.L96
 688:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          frameCntLength = 4;
 2015              		.loc 1 688 0
 2016 0d32 0423     		movs	r3, #4
 2017 0d34 BB73     		strb	r3, [r7, #14]
 2018 0d36 04E0     		b	.L98
 2019              	.L96:
 689:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       } else {
 690:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          frameCntLength = 5;
 2020              		.loc 1 690 0
 2021 0d38 0523     		movs	r3, #5
 2022 0d3a BB73     		strb	r3, [r7, #14]
 2023 0d3c 01E0     		b	.L98
 2024              	.L95:
 691:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       }
 692:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    } else {
 693:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       frameCntLength = 0;
 2025              		.loc 1 693 0
 2026 0d3e 0023     		movs	r3, #0
 2027 0d40 BB73     		strb	r3, [r7, #14]
 2028              	.L98:
 694:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 695:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 696:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    switch (KeyIdMode){
 2029              		.loc 1 696 0
 2030 0d42 FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 2031 0d44 032B     		cmp	r3, #3
 2032 0d46 1BD8     		bhi	.L107
 2033 0d48 01A2     		adr	r2, .L101
 2034 0d4a 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 2035 0d4e 00BF     		.p2align 2
 2036              	.L101:
 2037 0d50 610D0000 		.word	.L100+1
 2038 0d54 690D0000 		.word	.L102+1
 2039 0d58 710D0000 		.word	.L103+1
 2040 0d5c 790D0000 		.word	.L104+1
 2041              		.p2align 1
 2042              	.L100:
 697:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_KEYIDMODE_IMPLICIT:
 698:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          auxilary_len = frameCntLength + 1; //only SecLev and FrameCnt
 2043              		.loc 1 698 0
 2044 0d60 BB7B     		ldrb	r3, [r7, #14]
 2045 0d62 0133     		adds	r3, r3, #1
 2046 0d64 FB73     		strb	r3, [r7, #15]
 699:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 2047              		.loc 1 699 0
 2048 0d66 0CE0     		b	.L105
 2049              	.L102:
 700:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_KEYIDMODE_DEFAULTKEYSOURCE:
 701:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          auxilary_len = frameCntLength + 1 + 1; //SecLev, FrameCnt, KeyIndex
 2050              		.loc 1 701 0
 2051 0d68 BB7B     		ldrb	r3, [r7, #14]
 2052 0d6a 0233     		adds	r3, r3, #2
 2053 0d6c FB73     		strb	r3, [r7, #15]
 702:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 2054              		.loc 1 702 0
 2055 0d6e 08E0     		b	.L105
 2056              	.L103:
 703:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_KEYIDMODE_EXPLICIT_16:
 704:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          auxilary_len = frameCntLength + 1 + 3; //SecLev, FrameCnt, KeyIdMode (2 bytes) and KeyInde
 2057              		.loc 1 704 0
 2058 0d70 BB7B     		ldrb	r3, [r7, #14]
 2059 0d72 0433     		adds	r3, r3, #4
 2060 0d74 FB73     		strb	r3, [r7, #15]
 705:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 2061              		.loc 1 705 0
 2062 0d76 04E0     		b	.L105
 2063              	.L104:
 706:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       case IEEE154_ASH_KEYIDMODE_EXPLICIT_64:
 707:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          auxilary_len = frameCntLength + 1 + 9; //SecLev, FrameCnt, KeyIdMode (8 bytes) and KeyInde
 2064              		.loc 1 707 0
 2065 0d78 BB7B     		ldrb	r3, [r7, #14]
 2066 0d7a 0A33     		adds	r3, r3, #10
 2067 0d7c FB73     		strb	r3, [r7, #15]
 708:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 2068              		.loc 1 708 0
 2069 0d7e 00E0     		b	.L105
 2070              	.L107:
 709:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       default:
 710:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          break;
 2071              		.loc 1 710 0
 2072 0d80 00BF     		nop
 2073              	.L105:
 711:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 712:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 713:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    return auxilary_len;
 2074              		.loc 1 713 0
 2075 0d82 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 714:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** }
 2076              		.loc 1 714 0
 2077 0d84 1846     		mov	r0, r3
 2078 0d86 1437     		adds	r7, r7, #20
 2079              		.cfi_def_cfa_offset 4
 2080 0d88 BD46     		mov	sp, r7
 2081              		.cfi_def_cfa_register 13
 2082              		@ sp needed
 2083 0d8a 5DF8047B 		ldr	r7, [sp], #4
 2084              		.cfi_restore 7
 2085              		.cfi_def_cfa_offset 0
 2086 0d8e 7047     		bx	lr
 2087              		.cfi_endproc
 2088              	.LFE6:
 2090              		.align	2
 2091              		.global	IEEE802154_security_incomingKeyUsagePolicyChecking
 2092              		.thumb
 2093              		.thumb_func
 2095              	IEEE802154_security_incomingKeyUsagePolicyChecking:
 2096              	.LFB7:
 715:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 716:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** /**
 717:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** \brief Verify if the key used to protect the frame has been used properly.
 718:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****        Each key can be used to secure a particular frame type, according to
 719:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****        security policies defined in the initialization phase and stored in the
 720:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****        Mac Key Table.
 721:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****        The procedure verifies if the frame type parameter associated to the key
 722:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****        is the same than the packet for which the key has been used and returns
 723:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****        TRUE if the check is verified, FALSE otherwise.
 724:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** */
 725:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** bool IEEE802154_security_incomingKeyUsagePolicyChecking(m_keyDescriptor* keyDescriptor,
 726:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                        uint8_t          frameType,
 727:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                        uint8_t          cfi){
 2097              		.loc 1 727 0
 2098              		.cfi_startproc
 2099              		@ args = 0, pretend = 0, frame = 16
 2100              		@ frame_needed = 1, uses_anonymous_args = 0
 2101 0d90 80B5     		push	{r7, lr}
 2102              		.cfi_def_cfa_offset 8
 2103              		.cfi_offset 7, -8
 2104              		.cfi_offset 14, -4
 2105 0d92 84B0     		sub	sp, sp, #16
 2106              		.cfi_def_cfa_offset 24
 2107 0d94 00AF     		add	r7, sp, #0
 2108              		.cfi_def_cfa_register 7
 2109 0d96 7860     		str	r0, [r7, #4]
 2110 0d98 0B46     		mov	r3, r1
 2111 0d9a FB70     		strb	r3, [r7, #3]
 2112 0d9c 1346     		mov	r3, r2
 2113 0d9e BB70     		strb	r3, [r7, #2]
 728:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t i;
 729:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    INTERRUPT_DECLARATION();
 730:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    DISABLE_INTERRUPTS();
 2114              		.loc 1 730 0
 2115 0da0 FFF7FEFF 		bl	IntMasterDisable
 731:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    for (i=0; i<MAXNUMNEIGHBORS; i++){
 2116              		.loc 1 731 0
 2117 0da4 0023     		movs	r3, #0
 2118 0da6 FB73     		strb	r3, [r7, #15]
 2119 0da8 2BE0     		b	.L109
 2120              	.L113:
 732:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if (frameType != IEEE154_TYPE_CMD && frameType == keyDescriptor->KeyUsageList[i].FrameType){
 2121              		.loc 1 732 0
 2122 0daa FB78     		ldrb	r3, [r7, #3]	@ zero_extendqisi2
 2123 0dac 032B     		cmp	r3, #3
 2124 0dae 0CD0     		beq	.L110
 2125              		.loc 1 732 0 is_stmt 0 discriminator 1
 2126 0db0 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 2127 0db2 7A68     		ldr	r2, [r7, #4]
 2128 0db4 1C33     		adds	r3, r3, #28
 2129 0db6 5B00     		lsls	r3, r3, #1
 2130 0db8 1344     		add	r3, r3, r2
 2131 0dba 1B79     		ldrb	r3, [r3, #4]	@ zero_extendqisi2
 2132 0dbc FA78     		ldrb	r2, [r7, #3]	@ zero_extendqisi2
 2133 0dbe 9A42     		cmp	r2, r3
 2134 0dc0 03D1     		bne	.L110
 733:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          ENABLE_INTERRUPTS();
 2135              		.loc 1 733 0 is_stmt 1
 2136 0dc2 FFF7FEFF 		bl	IntMasterEnable
 734:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          return TRUE;
 2137              		.loc 1 734 0
 2138 0dc6 0123     		movs	r3, #1
 2139 0dc8 21E0     		b	.L111
 2140              	.L110:
 735:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       }
 736:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 737:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if (frameType == IEEE154_TYPE_CMD && frameType == keyDescriptor->KeyUsageList[i].FrameType &&
 2141              		.loc 1 737 0
 2142 0dca FB78     		ldrb	r3, [r7, #3]	@ zero_extendqisi2
 2143 0dcc 032B     		cmp	r3, #3
 2144 0dce 15D1     		bne	.L112
 2145              		.loc 1 737 0 is_stmt 0 discriminator 1
 2146 0dd0 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 2147 0dd2 7A68     		ldr	r2, [r7, #4]
 2148 0dd4 1C33     		adds	r3, r3, #28
 2149 0dd6 5B00     		lsls	r3, r3, #1
 2150 0dd8 1344     		add	r3, r3, r2
 2151 0dda 1B79     		ldrb	r3, [r3, #4]	@ zero_extendqisi2
 2152 0ddc FA78     		ldrb	r2, [r7, #3]	@ zero_extendqisi2
 2153 0dde 9A42     		cmp	r2, r3
 2154 0de0 0CD1     		bne	.L112
 738:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          cfi == keyDescriptor->KeyUsageList[i].CommandFrameIdentifier){
 2155              		.loc 1 738 0 is_stmt 1 discriminator 2
 2156 0de2 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 2157 0de4 7A68     		ldr	r2, [r7, #4]
 2158 0de6 1C33     		adds	r3, r3, #28
 2159 0de8 5B00     		lsls	r3, r3, #1
 2160 0dea 1344     		add	r3, r3, r2
 2161 0dec 5B79     		ldrb	r3, [r3, #5]	@ zero_extendqisi2
 737:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          cfi == keyDescriptor->KeyUsageList[i].CommandFrameIdentifier){
 2162              		.loc 1 737 0 discriminator 2
 2163 0dee BA78     		ldrb	r2, [r7, #2]	@ zero_extendqisi2
 2164 0df0 9A42     		cmp	r2, r3
 2165 0df2 03D1     		bne	.L112
 739:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          ENABLE_INTERRUPTS();
 2166              		.loc 1 739 0
 2167 0df4 FFF7FEFF 		bl	IntMasterEnable
 740:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          return TRUE;
 2168              		.loc 1 740 0
 2169 0df8 0123     		movs	r3, #1
 2170 0dfa 08E0     		b	.L111
 2171              	.L112:
 731:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if (frameType != IEEE154_TYPE_CMD && frameType == keyDescriptor->KeyUsageList[i].FrameType){
 2172              		.loc 1 731 0 discriminator 2
 2173 0dfc FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 2174 0dfe 0133     		adds	r3, r3, #1
 2175 0e00 FB73     		strb	r3, [r7, #15]
 2176              	.L109:
 731:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if (frameType != IEEE154_TYPE_CMD && frameType == keyDescriptor->KeyUsageList[i].FrameType){
 2177              		.loc 1 731 0 is_stmt 0 discriminator 1
 2178 0e02 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 2179 0e04 092B     		cmp	r3, #9
 2180 0e06 D0D9     		bls	.L113
 741:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       }
 742:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 743:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 744:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ENABLE_INTERRUPTS();
 2181              		.loc 1 744 0 is_stmt 1
 2182 0e08 FFF7FEFF 		bl	IntMasterEnable
 745:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    return FALSE;
 2183              		.loc 1 745 0
 2184 0e0c 0023     		movs	r3, #0
 2185              	.L111:
 746:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** }
 2186              		.loc 1 746 0
 2187 0e0e 1846     		mov	r0, r3
 2188 0e10 1037     		adds	r7, r7, #16
 2189              		.cfi_def_cfa_offset 8
 2190 0e12 BD46     		mov	sp, r7
 2191              		.cfi_def_cfa_register 13
 2192              		@ sp needed
 2193 0e14 80BD     		pop	{r7, pc}
 2194              		.cfi_endproc
 2195              	.LFE7:
 2197 0e16 00BF     		.align	2
 2198              		.global	IEEE802154_security_incomingSecurityLevelChecking
 2199              		.thumb
 2200              		.thumb_func
 2202              	IEEE802154_security_incomingSecurityLevelChecking:
 2203              	.LFB8:
 747:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 748:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** /**
 749:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** \brief Verify if the Security Level of the incoming Frame conforms to local
 750:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****        security policies, i.e., it is between the allowed security levels.
 751:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** */
 752:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** bool IEEE802154_security_incomingSecurityLevelChecking(m_securityLevelDescriptor* seclevdesc,
 753:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                        uint8_t                    seclevel,
 754:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                        bool                       exempt){
 2204              		.loc 1 754 0
 2205              		.cfi_startproc
 2206              		@ args = 0, pretend = 0, frame = 16
 2207              		@ frame_needed = 1, uses_anonymous_args = 0
 2208              		@ link register save eliminated.
 2209 0e18 80B4     		push	{r7}
 2210              		.cfi_def_cfa_offset 4
 2211              		.cfi_offset 7, -4
 2212 0e1a 85B0     		sub	sp, sp, #20
 2213              		.cfi_def_cfa_offset 24
 2214 0e1c 00AF     		add	r7, sp, #0
 2215              		.cfi_def_cfa_register 7
 2216 0e1e 7860     		str	r0, [r7, #4]
 2217 0e20 0B46     		mov	r3, r1
 2218 0e22 FB70     		strb	r3, [r7, #3]
 2219 0e24 1346     		mov	r3, r2
 2220 0e26 BB70     		strb	r3, [r7, #2]
 755:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 756:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t i;
 757:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (seclevdesc->AllowedSecurityLevels == 0){
 2221              		.loc 1 757 0
 2222 0e28 7B68     		ldr	r3, [r7, #4]
 2223 0e2a 0433     		adds	r3, r3, #4
 2224 0e2c 002B     		cmp	r3, #0
 2225 0e2e 08D1     		bne	.L115
 758:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if (seclevel <= seclevdesc->SecurityMinimum){
 2226              		.loc 1 758 0
 2227 0e30 7B68     		ldr	r3, [r7, #4]
 2228 0e32 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
 2229 0e34 FA78     		ldrb	r2, [r7, #3]	@ zero_extendqisi2
 2230 0e36 9A42     		cmp	r2, r3
 2231 0e38 01D8     		bhi	.L116
 759:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          return TRUE;
 2232              		.loc 1 759 0
 2233 0e3a 0123     		movs	r3, #1
 2234 0e3c 25E0     		b	.L117
 2235              	.L116:
 760:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       } else {
 761:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          return FALSE;
 2236              		.loc 1 761 0
 2237 0e3e 0023     		movs	r3, #0
 2238 0e40 23E0     		b	.L117
 2239              	.L115:
 762:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       }
 763:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 764:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 765:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    for (i=0;i<7;i++){
 2240              		.loc 1 765 0
 2241 0e42 0023     		movs	r3, #0
 2242 0e44 FB73     		strb	r3, [r7, #15]
 2243 0e46 0BE0     		b	.L118
 2244              	.L120:
 766:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if (seclevel == seclevdesc->AllowedSecurityLevels[i]){
 2245              		.loc 1 766 0
 2246 0e48 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 2247 0e4a 7A68     		ldr	r2, [r7, #4]
 2248 0e4c 1344     		add	r3, r3, r2
 2249 0e4e 1B79     		ldrb	r3, [r3, #4]	@ zero_extendqisi2
 2250 0e50 FA78     		ldrb	r2, [r7, #3]	@ zero_extendqisi2
 2251 0e52 9A42     		cmp	r2, r3
 2252 0e54 01D1     		bne	.L119
 767:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          return TRUE;
 2253              		.loc 1 767 0
 2254 0e56 0123     		movs	r3, #1
 2255 0e58 17E0     		b	.L117
 2256              	.L119:
 765:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if (seclevel == seclevdesc->AllowedSecurityLevels[i]){
 2257              		.loc 1 765 0 discriminator 2
 2258 0e5a FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 2259 0e5c 0133     		adds	r3, r3, #1
 2260 0e5e FB73     		strb	r3, [r7, #15]
 2261              	.L118:
 765:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if (seclevel == seclevdesc->AllowedSecurityLevels[i]){
 2262              		.loc 1 765 0 is_stmt 0 discriminator 1
 2263 0e60 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 2264 0e62 062B     		cmp	r3, #6
 2265 0e64 F0D9     		bls	.L120
 768:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       }
 769:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 770:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 771:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (seclevel == 0 && seclevdesc->DeviceOverrideSecurityMinimum ==TRUE ){
 2266              		.loc 1 771 0 is_stmt 1
 2267 0e66 FB78     		ldrb	r3, [r7, #3]	@ zero_extendqisi2
 2268 0e68 002B     		cmp	r3, #0
 2269 0e6a 0DD1     		bne	.L121
 2270              		.loc 1 771 0 is_stmt 0 discriminator 1
 2271 0e6c 7B68     		ldr	r3, [r7, #4]
 2272 0e6e DB78     		ldrb	r3, [r3, #3]	@ zero_extendqisi2
 2273 0e70 002B     		cmp	r3, #0
 2274 0e72 09D0     		beq	.L121
 772:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if (exempt == FALSE){
 2275              		.loc 1 772 0 is_stmt 1
 2276 0e74 BB78     		ldrb	r3, [r7, #2]
 2277 0e76 83F00103 		eor	r3, r3, #1
 2278 0e7a DBB2     		uxtb	r3, r3
 2279 0e7c 002B     		cmp	r3, #0
 2280 0e7e 01D0     		beq	.L122
 773:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          return FALSE;
 2281              		.loc 1 773 0
 2282 0e80 0023     		movs	r3, #0
 2283 0e82 02E0     		b	.L117
 2284              	.L122:
 774:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       }
 775:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       return TRUE;
 2285              		.loc 1 775 0
 2286 0e84 0123     		movs	r3, #1
 2287 0e86 00E0     		b	.L117
 2288              	.L121:
 776:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 777:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 778:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    return FALSE;
 2289              		.loc 1 778 0
 2290 0e88 0023     		movs	r3, #0
 2291              	.L117:
 779:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** }
 2292              		.loc 1 779 0
 2293 0e8a 1846     		mov	r0, r3
 2294 0e8c 1437     		adds	r7, r7, #20
 2295              		.cfi_def_cfa_offset 4
 2296 0e8e BD46     		mov	sp, r7
 2297              		.cfi_def_cfa_register 13
 2298              		@ sp needed
 2299 0e90 5DF8047B 		ldr	r7, [sp], #4
 2300              		.cfi_restore 7
 2301              		.cfi_def_cfa_offset 0
 2302 0e94 7047     		bx	lr
 2303              		.cfi_endproc
 2304              	.LFE8:
 2306 0e96 00BF     		.align	2
 2307              		.global	IEEE802154_security_securityLevelDescriptorLookup
 2308              		.thumb
 2309              		.thumb_func
 2311              	IEEE802154_security_securityLevelDescriptorLookup:
 2312              	.LFB9:
 780:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 781:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** /**
 782:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** \brief Searching for the Security Level Descriptor.
 783:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** */
 784:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** m_securityLevelDescriptor* IEEE802154_security_securityLevelDescriptorLookup(uint8_t frameType,
 785:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                                              uint8_t cfi){
 2313              		.loc 1 785 0
 2314              		.cfi_startproc
 2315              		@ args = 0, pretend = 0, frame = 16
 2316              		@ frame_needed = 1, uses_anonymous_args = 0
 2317 0e98 80B5     		push	{r7, lr}
 2318              		.cfi_def_cfa_offset 8
 2319              		.cfi_offset 7, -8
 2320              		.cfi_offset 14, -4
 2321 0e9a 84B0     		sub	sp, sp, #16
 2322              		.cfi_def_cfa_offset 24
 2323 0e9c 00AF     		add	r7, sp, #0
 2324              		.cfi_def_cfa_register 7
 2325 0e9e 0346     		mov	r3, r0
 2326 0ea0 0A46     		mov	r2, r1
 2327 0ea2 FB71     		strb	r3, [r7, #7]
 2328 0ea4 1346     		mov	r3, r2
 2329 0ea6 BB71     		strb	r3, [r7, #6]
 786:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t i;
 787:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    INTERRUPT_DECLARATION();
 788:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    DISABLE_INTERRUPTS();
 2330              		.loc 1 788 0
 2331 0ea8 FFF7FEFF 		bl	IntMasterDisable
 789:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    for (i=0; i<4; i++){
 2332              		.loc 1 789 0
 2333 0eac 0023     		movs	r3, #0
 2334 0eae FB73     		strb	r3, [r7, #15]
 2335 0eb0 62E0     		b	.L124
 2336              	.L128:
 790:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if (ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i].FrameType != IE
 2337              		.loc 1 790 0
 2338 0eb2 FA7B     		ldrb	r2, [r7, #15]	@ zero_extendqisi2
 2339 0eb4 3549     		ldr	r1, .L129
 2340 0eb6 1346     		mov	r3, r2
 2341 0eb8 9B00     		lsls	r3, r3, #2
 2342 0eba 1344     		add	r3, r3, r2
 2343 0ebc 5B00     		lsls	r3, r3, #1
 2344 0ebe 1344     		add	r3, r3, r2
 2345 0ec0 0B44     		add	r3, r3, r1
 2346 0ec2 03F58663 		add	r3, r3, #1072
 2347 0ec6 DB78     		ldrb	r3, [r3, #3]	@ zero_extendqisi2
 2348 0ec8 032B     		cmp	r3, #3
 2349 0eca 1BD0     		beq	.L125
 791:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          && frameType == ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i].
 2350              		.loc 1 791 0
 2351 0ecc FA7B     		ldrb	r2, [r7, #15]	@ zero_extendqisi2
 2352 0ece 2F49     		ldr	r1, .L129
 2353 0ed0 1346     		mov	r3, r2
 2354 0ed2 9B00     		lsls	r3, r3, #2
 2355 0ed4 1344     		add	r3, r3, r2
 2356 0ed6 5B00     		lsls	r3, r3, #1
 2357 0ed8 1344     		add	r3, r3, r2
 2358 0eda 0B44     		add	r3, r3, r1
 2359 0edc 03F58663 		add	r3, r3, #1072
 2360 0ee0 DB78     		ldrb	r3, [r3, #3]	@ zero_extendqisi2
 2361 0ee2 FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 2362 0ee4 9A42     		cmp	r2, r3
 2363 0ee6 0DD1     		bne	.L125
 792:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 793:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          ENABLE_INTERRUPTS();
 2364              		.loc 1 793 0
 2365 0ee8 FFF7FEFF 		bl	IntMasterEnable
 794:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          return &ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i];
 2366              		.loc 1 794 0
 2367 0eec FA7B     		ldrb	r2, [r7, #15]	@ zero_extendqisi2
 2368 0eee 1346     		mov	r3, r2
 2369 0ef0 9B00     		lsls	r3, r3, #2
 2370 0ef2 1344     		add	r3, r3, r2
 2371 0ef4 5B00     		lsls	r3, r3, #1
 2372 0ef6 1344     		add	r3, r3, r2
 2373 0ef8 03F58663 		add	r3, r3, #1072
 2374 0efc 234A     		ldr	r2, .L129
 2375 0efe 1344     		add	r3, r3, r2
 2376 0f00 0333     		adds	r3, r3, #3
 2377 0f02 3FE0     		b	.L126
 2378              	.L125:
 795:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       }
 796:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 797:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if (ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i].FrameType == IE
 2379              		.loc 1 797 0
 2380 0f04 FA7B     		ldrb	r2, [r7, #15]	@ zero_extendqisi2
 2381 0f06 2149     		ldr	r1, .L129
 2382 0f08 1346     		mov	r3, r2
 2383 0f0a 9B00     		lsls	r3, r3, #2
 2384 0f0c 1344     		add	r3, r3, r2
 2385 0f0e 5B00     		lsls	r3, r3, #1
 2386 0f10 1344     		add	r3, r3, r2
 2387 0f12 0B44     		add	r3, r3, r1
 2388 0f14 03F58663 		add	r3, r3, #1072
 2389 0f18 DB78     		ldrb	r3, [r3, #3]	@ zero_extendqisi2
 2390 0f1a 032B     		cmp	r3, #3
 2391 0f1c 29D1     		bne	.L127
 798:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          && frameType == ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i].
 2392              		.loc 1 798 0
 2393 0f1e FA7B     		ldrb	r2, [r7, #15]	@ zero_extendqisi2
 2394 0f20 1A49     		ldr	r1, .L129
 2395 0f22 1346     		mov	r3, r2
 2396 0f24 9B00     		lsls	r3, r3, #2
 2397 0f26 1344     		add	r3, r3, r2
 2398 0f28 5B00     		lsls	r3, r3, #1
 2399 0f2a 1344     		add	r3, r3, r2
 2400 0f2c 0B44     		add	r3, r3, r1
 2401 0f2e 03F58663 		add	r3, r3, #1072
 2402 0f32 DB78     		ldrb	r3, [r3, #3]	@ zero_extendqisi2
 2403 0f34 FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 2404 0f36 9A42     		cmp	r2, r3
 2405 0f38 1BD1     		bne	.L127
 799:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          && cfi == ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i].Comman
 2406              		.loc 1 799 0
 2407 0f3a FA7B     		ldrb	r2, [r7, #15]	@ zero_extendqisi2
 2408 0f3c 1349     		ldr	r1, .L129
 2409 0f3e 1346     		mov	r3, r2
 2410 0f40 9B00     		lsls	r3, r3, #2
 2411 0f42 1344     		add	r3, r3, r2
 2412 0f44 5B00     		lsls	r3, r3, #1
 2413 0f46 1344     		add	r3, r3, r2
 2414 0f48 0B44     		add	r3, r3, r1
 2415 0f4a 03F58663 		add	r3, r3, #1072
 2416 0f4e 1B79     		ldrb	r3, [r3, #4]	@ zero_extendqisi2
 2417 0f50 BA79     		ldrb	r2, [r7, #6]	@ zero_extendqisi2
 2418 0f52 9A42     		cmp	r2, r3
 2419 0f54 0DD1     		bne	.L127
 800:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 801:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          ENABLE_INTERRUPTS();
 2420              		.loc 1 801 0
 2421 0f56 FFF7FEFF 		bl	IntMasterEnable
 802:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          return &ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i];
 2422              		.loc 1 802 0
 2423 0f5a FA7B     		ldrb	r2, [r7, #15]	@ zero_extendqisi2
 2424 0f5c 1346     		mov	r3, r2
 2425 0f5e 9B00     		lsls	r3, r3, #2
 2426 0f60 1344     		add	r3, r3, r2
 2427 0f62 5B00     		lsls	r3, r3, #1
 2428 0f64 1344     		add	r3, r3, r2
 2429 0f66 03F58663 		add	r3, r3, #1072
 2430 0f6a 084A     		ldr	r2, .L129
 2431 0f6c 1344     		add	r3, r3, r2
 2432 0f6e 0333     		adds	r3, r3, #3
 2433 0f70 08E0     		b	.L126
 2434              	.L127:
 789:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if (ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i].FrameType != IE
 2435              		.loc 1 789 0 discriminator 2
 2436 0f72 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 2437 0f74 0133     		adds	r3, r3, #1
 2438 0f76 FB73     		strb	r3, [r7, #15]
 2439              	.L124:
 789:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if (ieee802154_security_vars.MacSecurityLevelTable.SecurityDescriptorEntry[i].FrameType != IE
 2440              		.loc 1 789 0 is_stmt 0 discriminator 1
 2441 0f78 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 2442 0f7a 032B     		cmp	r3, #3
 2443 0f7c 99D9     		bls	.L128
 803:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       }
 804:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 805:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 806:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ENABLE_INTERRUPTS();
 2444              		.loc 1 806 0 is_stmt 1
 2445 0f7e FFF7FEFF 		bl	IntMasterEnable
 807:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    return NULL;
 2446              		.loc 1 807 0
 2447 0f82 0023     		movs	r3, #0
 2448              	.L126:
 808:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** }
 2449              		.loc 1 808 0
 2450 0f84 1846     		mov	r0, r3
 2451 0f86 1037     		adds	r7, r7, #16
 2452              		.cfi_def_cfa_offset 8
 2453 0f88 BD46     		mov	sp, r7
 2454              		.cfi_def_cfa_register 13
 2455              		@ sp needed
 2456 0f8a 80BD     		pop	{r7, pc}
 2457              	.L130:
 2458              		.align	2
 2459              	.L129:
 2460 0f8c 00000000 		.word	ieee802154_security_vars
 2461              		.cfi_endproc
 2462              	.LFE9:
 2464              		.align	2
 2465              		.global	IEEE802154_security_deviceDescriptorLookup
 2466              		.thumb
 2467              		.thumb_func
 2469              	IEEE802154_security_deviceDescriptorLookup:
 2470              	.LFB10:
 809:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 810:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** /**
 811:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** \brief Searching for the Device Descriptor.
 812:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** */
 813:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** m_deviceDescriptor* IEEE802154_security_deviceDescriptorLookup(open_addr_t* Address,
 814:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                                open_addr_t* PANId,
 815:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                                m_keyDescriptor* keyDescriptor){
 2471              		.loc 1 815 0
 2472              		.cfi_startproc
 2473              		@ args = 0, pretend = 0, frame = 24
 2474              		@ frame_needed = 1, uses_anonymous_args = 0
 2475 0f90 80B5     		push	{r7, lr}
 2476              		.cfi_def_cfa_offset 8
 2477              		.cfi_offset 7, -8
 2478              		.cfi_offset 14, -4
 2479 0f92 86B0     		sub	sp, sp, #24
 2480              		.cfi_def_cfa_offset 32
 2481 0f94 00AF     		add	r7, sp, #0
 2482              		.cfi_def_cfa_register 7
 2483 0f96 F860     		str	r0, [r7, #12]
 2484 0f98 B960     		str	r1, [r7, #8]
 2485 0f9a 7A60     		str	r2, [r7, #4]
 816:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t i;
 817:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    INTERRUPT_DECLARATION();
 818:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    DISABLE_INTERRUPTS();
 2486              		.loc 1 818 0
 2487 0f9c FFF7FEFF 		bl	IntMasterDisable
 819:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 820:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    for (i=0; i<MAXNUMNEIGHBORS; i++){
 2488              		.loc 1 820 0
 2489 0fa0 0023     		movs	r3, #0
 2490 0fa2 FB75     		strb	r3, [r7, #23]
 2491 0fa4 2DE0     		b	.L132
 2492              	.L135:
 821:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if ((packetfunctions_sameAddress(Address,
 822:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          &keyDescriptor->DeviceTable->DeviceDescriptorEntry[i].deviceAddress)== TRUE)
 2493              		.loc 1 822 0
 2494 0fa6 7B68     		ldr	r3, [r7, #4]
 2495 0fa8 996B     		ldr	r1, [r3, #56]
 2496 0faa FA7D     		ldrb	r2, [r7, #23]	@ zero_extendqisi2
 821:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if ((packetfunctions_sameAddress(Address,
 2497              		.loc 1 821 0
 2498 0fac 1346     		mov	r3, r2
 2499 0fae 5B00     		lsls	r3, r3, #1
 2500 0fb0 1344     		add	r3, r3, r2
 2501 0fb2 DB00     		lsls	r3, r3, #3
 2502 0fb4 9B1A     		subs	r3, r3, r2
 2503 0fb6 0B44     		add	r3, r3, r1
 2504 0fb8 F868     		ldr	r0, [r7, #12]
 2505 0fba 1946     		mov	r1, r3
 2506 0fbc FFF7FEFF 		bl	packetfunctions_sameAddress
 2507 0fc0 0346     		mov	r3, r0
 2508 0fc2 002B     		cmp	r3, #0
 2509 0fc4 1AD0     		beq	.L133
 823:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          &&(packetfunctions_sameAddress(PANId,
 824:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          &ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[i].KeyIdLookupList.PANId))
 2510              		.loc 1 824 0
 2511 0fc6 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 823:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          &&(packetfunctions_sameAddress(PANId,
 2512              		.loc 1 823 0
 2513 0fc8 5422     		movs	r2, #84
 2514 0fca 02FB03F3 		mul	r3, r2, r3
 2515 0fce 2833     		adds	r3, r3, #40
 2516 0fd0 114A     		ldr	r2, .L136
 2517 0fd2 1344     		add	r3, r3, r2
 2518 0fd4 0733     		adds	r3, r3, #7
 2519 0fd6 B868     		ldr	r0, [r7, #8]
 2520 0fd8 1946     		mov	r1, r3
 2521 0fda FFF7FEFF 		bl	packetfunctions_sameAddress
 2522 0fde 0346     		mov	r3, r0
 2523 0fe0 002B     		cmp	r3, #0
 2524 0fe2 0BD0     		beq	.L133
 825:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          ){
 826:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****             ENABLE_INTERRUPTS();
 2525              		.loc 1 826 0
 2526 0fe4 FFF7FEFF 		bl	IntMasterEnable
 827:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****             return &keyDescriptor->DeviceTable->DeviceDescriptorEntry[i];
 2527              		.loc 1 827 0
 2528 0fe8 7B68     		ldr	r3, [r7, #4]
 2529 0fea 996B     		ldr	r1, [r3, #56]
 2530 0fec FA7D     		ldrb	r2, [r7, #23]	@ zero_extendqisi2
 2531 0fee 1346     		mov	r3, r2
 2532 0ff0 5B00     		lsls	r3, r3, #1
 2533 0ff2 1344     		add	r3, r3, r2
 2534 0ff4 DB00     		lsls	r3, r3, #3
 2535 0ff6 9B1A     		subs	r3, r3, r2
 2536 0ff8 0B44     		add	r3, r3, r1
 2537 0ffa 08E0     		b	.L134
 2538              	.L133:
 820:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if ((packetfunctions_sameAddress(Address,
 2539              		.loc 1 820 0 discriminator 2
 2540 0ffc FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2541 0ffe 0133     		adds	r3, r3, #1
 2542 1000 FB75     		strb	r3, [r7, #23]
 2543              	.L132:
 820:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       if ((packetfunctions_sameAddress(Address,
 2544              		.loc 1 820 0 is_stmt 0 discriminator 1
 2545 1002 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2546 1004 092B     		cmp	r3, #9
 2547 1006 CED9     		bls	.L135
 828:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          }
 829:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 830:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 831:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ENABLE_INTERRUPTS();
 2548              		.loc 1 831 0 is_stmt 1
 2549 1008 FFF7FEFF 		bl	IntMasterEnable
 832:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    return NULL;
 2550              		.loc 1 832 0
 2551 100c 0023     		movs	r3, #0
 2552              	.L134:
 833:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** }
 2553              		.loc 1 833 0
 2554 100e 1846     		mov	r0, r3
 2555 1010 1837     		adds	r7, r7, #24
 2556              		.cfi_def_cfa_offset 8
 2557 1012 BD46     		mov	sp, r7
 2558              		.cfi_def_cfa_register 13
 2559              		@ sp needed
 2560 1014 80BD     		pop	{r7, pc}
 2561              	.L137:
 2562 1016 00BF     		.align	2
 2563              	.L136:
 2564 1018 00000000 		.word	ieee802154_security_vars
 2565              		.cfi_endproc
 2566              	.LFE10:
 2568              		.align	2
 2569              		.global	IEEE802154_security_keyDescriptorLookup
 2570              		.thumb
 2571              		.thumb_func
 2573              	IEEE802154_security_keyDescriptorLookup:
 2574              	.LFB11:
 834:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 835:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** /**
 836:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** \brief Searching for the Key Descriptor.
 837:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** */
 838:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** m_keyDescriptor* IEEE802154_security_keyDescriptorLookup(uint8_t      KeyIdMode,
 839:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                          open_addr_t* keySource,
 840:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                          uint8_t      KeyIndex,
 841:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                          open_addr_t* DeviceAddress,
 842:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                          open_addr_t* panID,
 843:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                                          uint8_t      frameType){
 2575              		.loc 1 843 0
 2576              		.cfi_startproc
 2577              		@ args = 8, pretend = 0, frame = 24
 2578              		@ frame_needed = 1, uses_anonymous_args = 0
 2579 101c 80B5     		push	{r7, lr}
 2580              		.cfi_def_cfa_offset 8
 2581              		.cfi_offset 7, -8
 2582              		.cfi_offset 14, -4
 2583 101e 86B0     		sub	sp, sp, #24
 2584              		.cfi_def_cfa_offset 32
 2585 1020 00AF     		add	r7, sp, #0
 2586              		.cfi_def_cfa_register 7
 2587 1022 B960     		str	r1, [r7, #8]
 2588 1024 7B60     		str	r3, [r7, #4]
 2589 1026 0346     		mov	r3, r0
 2590 1028 FB73     		strb	r3, [r7, #15]
 2591 102a 1346     		mov	r3, r2
 2592 102c BB73     		strb	r3, [r7, #14]
 844:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    uint8_t i;
 845:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    INTERRUPT_DECLARATION();
 846:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    DISABLE_INTERRUPTS();
 2593              		.loc 1 846 0
 2594 102e FFF7FEFF 		bl	IntMasterDisable
 847:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 848:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (KeyIdMode == IEEE154_ASH_KEYIDMODE_IMPLICIT){
 2595              		.loc 1 848 0
 2596 1032 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 2597 1034 002B     		cmp	r3, #0
 2598 1036 3BD1     		bne	.L139
 849:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       for (i=0; i<MAXNUMKEYS; i++ ){
 2599              		.loc 1 849 0
 2600 1038 0023     		movs	r3, #0
 2601 103a FB75     		strb	r3, [r7, #23]
 2602 103c 35E0     		b	.L140
 2603              	.L143:
 850:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          if (ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[i].KeyIdLookupList.Address.t
 2604              		.loc 1 850 0
 2605 103e FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2606 1040 784A     		ldr	r2, .L156
 2607 1042 5421     		movs	r1, #84
 2608 1044 01FB03F3 		mul	r3, r1, r3
 2609 1048 1344     		add	r3, r3, r2
 2610 104a 3833     		adds	r3, r3, #56
 2611 104c 1B7A     		ldrb	r3, [r3, #8]	@ zero_extendqisi2
 2612 104e 022B     		cmp	r3, #2
 2613 1050 28D1     		bne	.L141
 851:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****             if (packetfunctions_sameAddress(DeviceAddress,&ieee802154_security_vars.MacKeyTable.Key
 2614              		.loc 1 851 0
 2615 1052 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2616 1054 5422     		movs	r2, #84
 2617 1056 02FB03F3 		mul	r3, r2, r3
 2618 105a 3833     		adds	r3, r3, #56
 2619 105c 714A     		ldr	r2, .L156
 2620 105e 1344     		add	r3, r3, r2
 2621 1060 0833     		adds	r3, r3, #8
 2622 1062 7868     		ldr	r0, [r7, #4]
 2623 1064 1946     		mov	r1, r3
 2624 1066 FFF7FEFF 		bl	packetfunctions_sameAddress
 2625 106a 0346     		mov	r3, r0
 2626 106c 002B     		cmp	r3, #0
 2627 106e 19D0     		beq	.L141
 852:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                            &&packetfunctions_sameAddress(panID,
 853:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                            &ieee802154_security_vars.MacKeyTable.KeyDescriptorEleme
 2628              		.loc 1 853 0
 2629 1070 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 852:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                            &&packetfunctions_sameAddress(panID,
 2630              		.loc 1 852 0
 2631 1072 5422     		movs	r2, #84
 2632 1074 02FB03F3 		mul	r3, r2, r3
 2633 1078 2833     		adds	r3, r3, #40
 2634 107a 6A4A     		ldr	r2, .L156
 2635 107c 1344     		add	r3, r3, r2
 2636 107e 0733     		adds	r3, r3, #7
 2637 1080 386A     		ldr	r0, [r7, #32]
 2638 1082 1946     		mov	r1, r3
 2639 1084 FFF7FEFF 		bl	packetfunctions_sameAddress
 2640 1088 0346     		mov	r3, r0
 2641 108a 002B     		cmp	r3, #0
 2642 108c 0AD0     		beq	.L141
 854:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                ENABLE_INTERRUPTS();
 2643              		.loc 1 854 0
 2644 108e FFF7FEFF 		bl	IntMasterEnable
 855:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                return &ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[i];
 2645              		.loc 1 855 0
 2646 1092 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2647 1094 5422     		movs	r2, #84
 2648 1096 02FB03F3 		mul	r3, r2, r3
 2649 109a 1833     		adds	r3, r3, #24
 2650 109c 614A     		ldr	r2, .L156
 2651 109e 1344     		add	r3, r3, r2
 2652 10a0 0433     		adds	r3, r3, #4
 2653 10a2 BAE0     		b	.L142
 2654              	.L141:
 849:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          if (ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[i].KeyIdLookupList.Address.t
 2655              		.loc 1 849 0 discriminator 2
 2656 10a4 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2657 10a6 0133     		adds	r3, r3, #1
 2658 10a8 FB75     		strb	r3, [r7, #23]
 2659              	.L140:
 849:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          if (ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[i].KeyIdLookupList.Address.t
 2660              		.loc 1 849 0 is_stmt 0 discriminator 1
 2661 10aa FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2662 10ac 0A2B     		cmp	r3, #10
 2663 10ae C6D9     		bls	.L143
 2664              	.L139:
 856:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****              }
 857:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          }
 858:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       }
 859:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 860:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 861:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (KeyIdMode == IEEE154_ASH_KEYIDMODE_DEFAULTKEYSOURCE){
 2665              		.loc 1 861 0 is_stmt 1
 2666 10b0 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 2667 10b2 012B     		cmp	r3, #1
 2668 10b4 25D1     		bne	.L144
 862:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       for (i=0; i<MAXNUMKEYS; i++ ){
 2669              		.loc 1 862 0
 2670 10b6 0023     		movs	r3, #0
 2671 10b8 FB75     		strb	r3, [r7, #23]
 2672 10ba 1FE0     		b	.L145
 2673              	.L147:
 863:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          if (KeyIndex == ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[i].KeyIdLookupLi
 2674              		.loc 1 863 0
 2675 10bc FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2676 10be 594A     		ldr	r2, .L156
 2677 10c0 5421     		movs	r1, #84
 2678 10c2 01FB03F3 		mul	r3, r1, r3
 2679 10c6 1344     		add	r3, r3, r2
 2680 10c8 1833     		adds	r3, r3, #24
 2681 10ca 5B79     		ldrb	r3, [r3, #5]	@ zero_extendqisi2
 2682 10cc BA7B     		ldrb	r2, [r7, #14]	@ zero_extendqisi2
 2683 10ce 9A42     		cmp	r2, r3
 2684 10d0 11D1     		bne	.L146
 864:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****              && packetfunctions_sameAddress(keySource,&ieee802154_security_vars.m_macDefaultKeySour
 2685              		.loc 1 864 0
 2686 10d2 B868     		ldr	r0, [r7, #8]
 2687 10d4 5449     		ldr	r1, .L156+4
 2688 10d6 FFF7FEFF 		bl	packetfunctions_sameAddress
 2689 10da 0346     		mov	r3, r0
 2690 10dc 002B     		cmp	r3, #0
 2691 10de 0AD0     		beq	.L146
 865:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****             ENABLE_INTERRUPTS();
 2692              		.loc 1 865 0
 2693 10e0 FFF7FEFF 		bl	IntMasterEnable
 866:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****             return &ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[i];
 2694              		.loc 1 866 0
 2695 10e4 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2696 10e6 5422     		movs	r2, #84
 2697 10e8 02FB03F3 		mul	r3, r2, r3
 2698 10ec 1833     		adds	r3, r3, #24
 2699 10ee 4D4A     		ldr	r2, .L156
 2700 10f0 1344     		add	r3, r3, r2
 2701 10f2 0433     		adds	r3, r3, #4
 2702 10f4 91E0     		b	.L142
 2703              	.L146:
 862:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          if (KeyIndex == ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[i].KeyIdLookupLi
 2704              		.loc 1 862 0 discriminator 2
 2705 10f6 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2706 10f8 0133     		adds	r3, r3, #1
 2707 10fa FB75     		strb	r3, [r7, #23]
 2708              	.L145:
 862:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          if (KeyIndex == ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[i].KeyIdLookupLi
 2709              		.loc 1 862 0 is_stmt 0 discriminator 1
 2710 10fc FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2711 10fe 0A2B     		cmp	r3, #10
 2712 1100 DCD9     		bls	.L147
 2713              	.L144:
 867:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          }
 868:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       }
 869:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 870:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 871:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (KeyIdMode == IEEE154_ASH_KEYIDMODE_EXPLICIT_16){
 2714              		.loc 1 871 0 is_stmt 1
 2715 1102 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 2716 1104 022B     		cmp	r3, #2
 2717 1106 45D1     		bne	.L148
 872:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       for (i=0; i<MAXNUMKEYS; i++ ){
 2718              		.loc 1 872 0
 2719 1108 0023     		movs	r3, #0
 2720 110a FB75     		strb	r3, [r7, #23]
 2721 110c 3FE0     		b	.L149
 2722              	.L151:
 873:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          if (KeyIndex == ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[i].KeyIdLookupLi
 2723              		.loc 1 873 0
 2724 110e FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2725 1110 444A     		ldr	r2, .L156
 2726 1112 5421     		movs	r1, #84
 2727 1114 01FB03F3 		mul	r3, r1, r3
 2728 1118 1344     		add	r3, r3, r2
 2729 111a 1833     		adds	r3, r3, #24
 2730 111c 5B79     		ldrb	r3, [r3, #5]	@ zero_extendqisi2
 2731 111e BA7B     		ldrb	r2, [r7, #14]	@ zero_extendqisi2
 2732 1120 9A42     		cmp	r2, r3
 2733 1122 31D1     		bne	.L150
 874:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****             if (keySource->addr_16b[0] == ieee802154_security_vars.MacKeyTable.KeyDescriptorElement
 2734              		.loc 1 874 0
 2735 1124 BB68     		ldr	r3, [r7, #8]
 2736 1126 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 2737 1128 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2738 112a 3E49     		ldr	r1, .L156
 2739 112c 5420     		movs	r0, #84
 2740 112e 00FB03F3 		mul	r3, r0, r3
 2741 1132 0B44     		add	r3, r3, r1
 2742 1134 1833     		adds	r3, r3, #24
 2743 1136 DB79     		ldrb	r3, [r3, #7]	@ zero_extendqisi2
 2744 1138 9A42     		cmp	r2, r3
 2745 113a 25D1     		bne	.L150
 875:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                keySource->addr_16b[1] == ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[
 2746              		.loc 1 875 0 discriminator 1
 2747 113c BB68     		ldr	r3, [r7, #8]
 2748 113e 9A78     		ldrb	r2, [r3, #2]	@ zero_extendqisi2
 2749 1140 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2750 1142 3849     		ldr	r1, .L156
 2751 1144 5420     		movs	r0, #84
 2752 1146 00FB03F3 		mul	r3, r0, r3
 2753 114a 0B44     		add	r3, r3, r1
 2754 114c 1933     		adds	r3, r3, #25
 2755 114e DB79     		ldrb	r3, [r3, #7]	@ zero_extendqisi2
 874:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****             if (keySource->addr_16b[0] == ieee802154_security_vars.MacKeyTable.KeyDescriptorElement
 2756              		.loc 1 874 0 discriminator 1
 2757 1150 9A42     		cmp	r2, r3
 2758 1152 19D1     		bne	.L150
 876:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                && packetfunctions_sameAddress(panID, &ieee802154_security_vars.MacKeyTable.KeyDescr
 2759              		.loc 1 876 0
 2760 1154 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2761 1156 5422     		movs	r2, #84
 2762 1158 02FB03F3 		mul	r3, r2, r3
 2763 115c 2833     		adds	r3, r3, #40
 2764 115e 314A     		ldr	r2, .L156
 2765 1160 1344     		add	r3, r3, r2
 2766 1162 0733     		adds	r3, r3, #7
 2767 1164 386A     		ldr	r0, [r7, #32]
 2768 1166 1946     		mov	r1, r3
 2769 1168 FFF7FEFF 		bl	packetfunctions_sameAddress
 2770 116c 0346     		mov	r3, r0
 2771 116e 002B     		cmp	r3, #0
 2772 1170 0AD0     		beq	.L150
 877:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                ){
 878:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                ENABLE_INTERRUPTS();
 2773              		.loc 1 878 0
 2774 1172 FFF7FEFF 		bl	IntMasterEnable
 879:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                return &ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[i];
 2775              		.loc 1 879 0
 2776 1176 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2777 1178 5422     		movs	r2, #84
 2778 117a 02FB03F3 		mul	r3, r2, r3
 2779 117e 1833     		adds	r3, r3, #24
 2780 1180 284A     		ldr	r2, .L156
 2781 1182 1344     		add	r3, r3, r2
 2782 1184 0433     		adds	r3, r3, #4
 2783 1186 48E0     		b	.L142
 2784              	.L150:
 872:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          if (KeyIndex == ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[i].KeyIdLookupLi
 2785              		.loc 1 872 0 discriminator 2
 2786 1188 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2787 118a 0133     		adds	r3, r3, #1
 2788 118c FB75     		strb	r3, [r7, #23]
 2789              	.L149:
 872:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          if (KeyIndex == ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[i].KeyIdLookupLi
 2790              		.loc 1 872 0 is_stmt 0 discriminator 1
 2791 118e FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2792 1190 0A2B     		cmp	r3, #10
 2793 1192 BCD9     		bls	.L151
 2794              	.L148:
 880:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****             }
 881:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          }
 882:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       }
 883:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 884:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 885:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    if (KeyIdMode == IEEE154_ASH_KEYIDMODE_EXPLICIT_64){
 2795              		.loc 1 885 0 is_stmt 1
 2796 1194 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 2797 1196 032B     		cmp	r3, #3
 2798 1198 3CD1     		bne	.L152
 886:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       for (i=0; i<MAXNUMKEYS; i++ ){
 2799              		.loc 1 886 0
 2800 119a 0023     		movs	r3, #0
 2801 119c FB75     		strb	r3, [r7, #23]
 2802 119e 36E0     		b	.L153
 2803              	.L155:
 887:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          if (KeyIndex == ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[i].KeyIdLookupLi
 2804              		.loc 1 887 0
 2805 11a0 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2806 11a2 204A     		ldr	r2, .L156
 2807 11a4 5421     		movs	r1, #84
 2808 11a6 01FB03F3 		mul	r3, r1, r3
 2809 11aa 1344     		add	r3, r3, r2
 2810 11ac 1833     		adds	r3, r3, #24
 2811 11ae 5B79     		ldrb	r3, [r3, #5]	@ zero_extendqisi2
 2812 11b0 BA7B     		ldrb	r2, [r7, #14]	@ zero_extendqisi2
 2813 11b2 9A42     		cmp	r2, r3
 2814 11b4 28D1     		bne	.L154
 888:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****             if (packetfunctions_sameAddress(keySource,&ieee802154_security_vars.MacKeyTable.KeyDesc
 2815              		.loc 1 888 0
 2816 11b6 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2817 11b8 5422     		movs	r2, #84
 2818 11ba 02FB03F3 		mul	r3, r2, r3
 2819 11be 1833     		adds	r3, r3, #24
 2820 11c0 184A     		ldr	r2, .L156
 2821 11c2 1344     		add	r3, r3, r2
 2822 11c4 0633     		adds	r3, r3, #6
 2823 11c6 B868     		ldr	r0, [r7, #8]
 2824 11c8 1946     		mov	r1, r3
 2825 11ca FFF7FEFF 		bl	packetfunctions_sameAddress
 2826 11ce 0346     		mov	r3, r0
 2827 11d0 002B     		cmp	r3, #0
 2828 11d2 19D0     		beq	.L154
 889:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                 && packetfunctions_sameAddress(panID, &ieee802154_security_vars.MacKeyTable.KeyDesc
 2829              		.loc 1 889 0
 2830 11d4 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2831 11d6 5422     		movs	r2, #84
 2832 11d8 02FB03F3 		mul	r3, r2, r3
 2833 11dc 2833     		adds	r3, r3, #40
 2834 11de 114A     		ldr	r2, .L156
 2835 11e0 1344     		add	r3, r3, r2
 2836 11e2 0733     		adds	r3, r3, #7
 2837 11e4 386A     		ldr	r0, [r7, #32]
 2838 11e6 1946     		mov	r1, r3
 2839 11e8 FFF7FEFF 		bl	packetfunctions_sameAddress
 2840 11ec 0346     		mov	r3, r0
 2841 11ee 002B     		cmp	r3, #0
 2842 11f0 0AD0     		beq	.L154
 890:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                ){
 891:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                ENABLE_INTERRUPTS();
 2843              		.loc 1 891 0
 2844 11f2 FFF7FEFF 		bl	IntMasterEnable
 892:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                return &ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[i];
 2845              		.loc 1 892 0
 2846 11f6 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2847 11f8 5422     		movs	r2, #84
 2848 11fa 02FB03F3 		mul	r3, r2, r3
 2849 11fe 1833     		adds	r3, r3, #24
 2850 1200 084A     		ldr	r2, .L156
 2851 1202 1344     		add	r3, r3, r2
 2852 1204 0433     		adds	r3, r3, #4
 2853 1206 08E0     		b	.L142
 2854              	.L154:
 886:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          if (KeyIndex == ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[i].KeyIdLookupLi
 2855              		.loc 1 886 0 discriminator 2
 2856 1208 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2857 120a 0133     		adds	r3, r3, #1
 2858 120c FB75     		strb	r3, [r7, #23]
 2859              	.L153:
 886:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          if (KeyIndex == ieee802154_security_vars.MacKeyTable.KeyDescriptorElement[i].KeyIdLookupLi
 2860              		.loc 1 886 0 is_stmt 0 discriminator 1
 2861 120e FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 2862 1210 0A2B     		cmp	r3, #10
 2863 1212 C5D9     		bls	.L155
 2864              	.L152:
 893:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****             }
 894:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****          }
 895:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****       }
 896:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    }
 897:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 898:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    //no matches
 899:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    ENABLE_INTERRUPTS();
 2865              		.loc 1 899 0 is_stmt 1
 2866 1214 FFF7FEFF 		bl	IntMasterEnable
 900:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    return NULL;
 2867              		.loc 1 900 0
 2868 1218 0023     		movs	r3, #0
 2869              	.L142:
 901:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** }
 2870              		.loc 1 901 0
 2871 121a 1846     		mov	r0, r3
 2872 121c 1837     		adds	r7, r7, #24
 2873              		.cfi_def_cfa_offset 8
 2874 121e BD46     		mov	sp, r7
 2875              		.cfi_def_cfa_register 13
 2876              		@ sp needed
 2877 1220 80BD     		pop	{r7, pc}
 2878              	.L157:
 2879 1222 00BF     		.align	2
 2880              	.L156:
 2881 1224 00000000 		.word	ieee802154_security_vars
 2882 1228 09000000 		.word	ieee802154_security_vars+9
 2883              		.cfi_endproc
 2884              	.LFE11:
 2886              		.align	2
 2887              		.global	IEEE802154_security_getFrameCounter
 2888              		.thumb
 2889              		.thumb_func
 2891              	IEEE802154_security_getFrameCounter:
 2892              	.LFB12:
 902:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 903:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** /*
 904:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****  * Store in the array the reference value 
 905:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****  */
 906:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** void IEEE802154_security_getFrameCounter(macFrameCounter_t reference,
 907:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****                                         uint8_t*          array) {
 2893              		.loc 1 907 0
 2894              		.cfi_startproc
 2895              		@ args = 0, pretend = 0, frame = 16
 2896              		@ frame_needed = 1, uses_anonymous_args = 0
 2897              		@ link register save eliminated.
 2898 122c 80B4     		push	{r7}
 2899              		.cfi_def_cfa_offset 4
 2900              		.cfi_offset 7, -4
 2901 122e 85B0     		sub	sp, sp, #20
 2902              		.cfi_def_cfa_offset 24
 2903 1230 00AF     		add	r7, sp, #0
 2904              		.cfi_def_cfa_register 7
 2905 1232 07F10803 		add	r3, r7, #8
 2906 1236 83E80300 		stmia	r3, {r0, r1}
 2907 123a 7A60     		str	r2, [r7, #4]
 908:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** 
 909:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    array[0] = (reference.bytes0and1     & 0xff);
 2908              		.loc 1 909 0
 2909 123c B7F80B30 		ldrh	r3, [r7, #11]	@ unaligned
 2910 1240 9BB2     		uxth	r3, r3
 2911 1242 DAB2     		uxtb	r2, r3
 2912 1244 7B68     		ldr	r3, [r7, #4]
 2913 1246 1A70     		strb	r2, [r3]
 910:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    array[1] = (reference.bytes0and1/256 & 0xff);
 2914              		.loc 1 910 0
 2915 1248 7B68     		ldr	r3, [r7, #4]
 2916 124a 0133     		adds	r3, r3, #1
 2917 124c B7F80B20 		ldrh	r2, [r7, #11]	@ unaligned
 2918 1250 92B2     		uxth	r2, r2
 2919 1252 120A     		lsrs	r2, r2, #8
 2920 1254 92B2     		uxth	r2, r2
 2921 1256 D2B2     		uxtb	r2, r2
 2922 1258 1A70     		strb	r2, [r3]
 911:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    array[2] = (reference.bytes2and3     & 0xff);
 2923              		.loc 1 911 0
 2924 125a 7B68     		ldr	r3, [r7, #4]
 2925 125c 0233     		adds	r3, r3, #2
 2926 125e B7F80920 		ldrh	r2, [r7, #9]	@ unaligned
 2927 1262 92B2     		uxth	r2, r2
 2928 1264 D2B2     		uxtb	r2, r2
 2929 1266 1A70     		strb	r2, [r3]
 912:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    array[3] = (reference.bytes2and3/256 & 0xff);
 2930              		.loc 1 912 0
 2931 1268 7B68     		ldr	r3, [r7, #4]
 2932 126a 0333     		adds	r3, r3, #3
 2933 126c B7F80920 		ldrh	r2, [r7, #9]	@ unaligned
 2934 1270 92B2     		uxth	r2, r2
 2935 1272 120A     		lsrs	r2, r2, #8
 2936 1274 92B2     		uxth	r2, r2
 2937 1276 D2B2     		uxtb	r2, r2
 2938 1278 1A70     		strb	r2, [r3]
 913:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c ****    array[4] =  reference.byte4;
 2939              		.loc 1 913 0
 2940 127a 7B68     		ldr	r3, [r7, #4]
 2941 127c 0433     		adds	r3, r3, #4
 2942 127e 3A7A     		ldrb	r2, [r7, #8]	@ zero_extendqisi2
 2943 1280 1A70     		strb	r2, [r3]
 914:build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.c **** }
 2944              		.loc 1 914 0
 2945 1282 1437     		adds	r7, r7, #20
 2946              		.cfi_def_cfa_offset 4
 2947 1284 BD46     		mov	sp, r7
 2948              		.cfi_def_cfa_register 13
 2949              		@ sp needed
 2950 1286 5DF8047B 		ldr	r7, [sp], #4
 2951              		.cfi_restore 7
 2952              		.cfi_def_cfa_offset 0
 2953 128a 7047     		bx	lr
 2954              		.cfi_endproc
 2955              	.LFE12:
 2957              		.global	IEEE802154_security
 2958              		.section	.rodata
 2959              		.align	2
 2962              	IEEE802154_security:
 2963 0050 00000000 		.word	IEEE802154_security_init
 2964 0054 00000000 		.word	IEEE802154_security_prependAuxiliarySecurityHeader
 2965 0058 00000000 		.word	IEEE802154_security_retrieveAuxiliarySecurityHeader
 2966 005c 00000000 		.word	IEEE802154_security_outgoingFrameSecurity
 2967 0060 00000000 		.word	IEEE802154_security_incomingFrame
 2968 0064 00000000 		.word	IEEE802154_security_authLengthChecking
 2969 0068 00000000 		.word	IEEE802154_security_auxLengthChecking
 2970              		.text
 2971              	.Letext0:
 2972              		.file 2 "/usr/arm-none-eabi/include/machine/_default_types.h"
 2973              		.file 3 "/usr/arm-none-eabi/include/sys/_stdint.h"
 2974              		.file 4 "inc/opendefs.h"
 2975              		.file 5 "bsp/boards/crypto_engine.h"
 2976              		.file 6 "build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154.h"
 2977              		.file 7 "build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/ieee802154_security_driver.h"
 2978              		.file 8 "build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154_security.h"
 2979              		.file 9 "bsp/boards/OpenMote-CC2538/board_info.h"
 2980              		.file 10 "build/OpenMote-CC2538_armgcc/openstack/02a-MAClow/IEEE802154E.h"
 2981              		.file 11 "openstack/03b-IPv6/icmpv6rpl.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 IEEE802154_security.c
     /tmp/cczAOn0f.s:19     .rodata:0000000000000000 $d
     /tmp/cczAOn0f.s:22     .rodata:0000000000000000 rreg_uriquery
     /tmp/cczAOn0f.s:27     .rodata:0000000000000008 infoBoardname
     /tmp/cczAOn0f.s:32     .rodata:0000000000000010 infouCName
     /tmp/cczAOn0f.s:37     .rodata:0000000000000018 infoRadioName
     /tmp/cczAOn0f.s:42     .rodata:0000000000000024 infoStackName
     /tmp/cczAOn0f.s:47     .rodata:0000000000000030 chTemplate_default
     /tmp/cczAOn0f.s:67     .rodata:0000000000000040 all_routers_multicast
                            *COM*:000000000000048c ieee802154_security_vars
     /tmp/cczAOn0f.s:86     .text:0000000000000000 $t
     /tmp/cczAOn0f.s:91     .text:0000000000000000 IEEE802154_security_init
     /tmp/cczAOn0f.s:262    .text:0000000000000130 $d
     /tmp/cczAOn0f.s:266    .text:0000000000000138 $t
     /tmp/cczAOn0f.s:623    .text:00000000000003d8 $d
     /tmp/cczAOn0f.s:633    .text:00000000000003f4 $t
     /tmp/cczAOn0f.s:638    .text:00000000000003f4 IEEE802154_security_prependAuxiliarySecurityHeader
     /tmp/cczAOn0f.s:1908   .text:0000000000000cb4 IEEE802154_security_authLengthChecking
     /tmp/cczAOn0f.s:1987   .text:0000000000000d14 IEEE802154_security_auxLengthChecking
     /tmp/cczAOn0f.s:722    .text:000000000000047c $d
     /tmp/cczAOn0f.s:726    .text:000000000000048c $t
     /tmp/cczAOn0f.s:881    .text:0000000000000580 $d
     /tmp/cczAOn0f.s:886    .text:0000000000000588 $t
     /tmp/cczAOn0f.s:891    .text:0000000000000588 IEEE802154_security_outgoingFrameSecurity
     /tmp/cczAOn0f.s:2573   .text:000000000000101c IEEE802154_security_keyDescriptorLookup
     /tmp/cczAOn0f.s:2891   .text:000000000000122c IEEE802154_security_getFrameCounter
     /tmp/cczAOn0f.s:1064   .text:00000000000006e4 $d
     /tmp/cczAOn0f.s:1071   .text:0000000000000700 $t
     /tmp/cczAOn0f.s:1205   .text:00000000000007e8 $d
     /tmp/cczAOn0f.s:1209   .text:00000000000007ec $t
     /tmp/cczAOn0f.s:1214   .text:00000000000007ec IEEE802154_security_retrieveAuxiliarySecurityHeader
     /tmp/cczAOn0f.s:1386   .text:000000000000090c $d
     /tmp/cczAOn0f.s:1390   .text:000000000000091c $t
     /tmp/cczAOn0f.s:1523   .text:00000000000009f0 $d
     /tmp/cczAOn0f.s:1528   .text:00000000000009f8 $t
     /tmp/cczAOn0f.s:1533   .text:00000000000009f8 IEEE802154_security_incomingFrame
     /tmp/cczAOn0f.s:2469   .text:0000000000000f90 IEEE802154_security_deviceDescriptorLookup
     /tmp/cczAOn0f.s:2311   .text:0000000000000e98 IEEE802154_security_securityLevelDescriptorLookup
     /tmp/cczAOn0f.s:2202   .text:0000000000000e18 IEEE802154_security_incomingSecurityLevelChecking
     /tmp/cczAOn0f.s:2095   .text:0000000000000d90 IEEE802154_security_incomingKeyUsagePolicyChecking
     /tmp/cczAOn0f.s:1756   .text:0000000000000ba8 $d
     /tmp/cczAOn0f.s:1763   .text:0000000000000bc4 $t
     /tmp/cczAOn0f.s:1899   .text:0000000000000cb0 $d
     /tmp/cczAOn0f.s:1903   .text:0000000000000cb4 $t
     /tmp/cczAOn0f.s:1932   .text:0000000000000ccc $d
     /tmp/cczAOn0f.s:1940   .text:0000000000000cec $t
     /tmp/cczAOn0f.s:2037   .text:0000000000000d50 $d
     /tmp/cczAOn0f.s:2041   .text:0000000000000d60 $t
     /tmp/cczAOn0f.s:2460   .text:0000000000000f8c $d
     /tmp/cczAOn0f.s:2464   .text:0000000000000f90 $t
     /tmp/cczAOn0f.s:2564   .text:0000000000001018 $d
     /tmp/cczAOn0f.s:2568   .text:000000000000101c $t
     /tmp/cczAOn0f.s:2881   .text:0000000000001224 $d
     /tmp/cczAOn0f.s:2886   .text:000000000000122c $t
     /tmp/cczAOn0f.s:2962   .rodata:0000000000000050 IEEE802154_security
                     .debug_frame:0000000000000010 $d
                           .group:0000000000000000 wm4.0.59116071098782a37a9183a8102fe91b
                           .group:0000000000000000 wm4.features.h.22.2e382148a0560adabf236cddd4e880f4
                           .group:0000000000000000 wm4._default_types.h.15.933e8edd27a65e0b69af4a865eb623d2
                           .group:0000000000000000 wm4._intsup.h.10.35a45952db64d30146faa63a55c20c1c
                           .group:0000000000000000 wm4._stdint.h.10.f76354baea1c7088202064e6f3d4f5e3
                           .group:0000000000000000 wm4.stdint.h.23.373a9d32a9e4c2e88fd347156532d281
                           .group:0000000000000000 wm4.toolchain_defs.h.2.e4ebbe6e0a48032a9b79077dc42e1ffd
                           .group:0000000000000000 wm4.newlib.h.8.2702bca278809460f0af6fba1d84eb68
                           .group:0000000000000000 wm4.config.h.220.a09b0b0de3c25be3f39d71990e617bff
                           .group:0000000000000000 wm4._ansi.h.23.84af8eb8cd468d25cc5f45f5eb13ec51
                           .group:0000000000000000 wm4.stddef.h.39.daafd3d79fe2f3a84d2d73d7d4e706f8
                           .group:0000000000000000 wm4.lock.h.2.9bc98482741e5e2a9450b12934a684ea
                           .group:0000000000000000 wm4._types.h.54.d3d34a3b7f3cc230cd159baf022b4b08
                           .group:0000000000000000 wm4.stddef.h.158.61317cdbfb4026324507d123a50b0fd6
                           .group:0000000000000000 wm4.reent.h.17.8bd9e4098e0428508c282cad794fae43
                           .group:0000000000000000 wm4.cdefs.h.47.e6563c1c3863188ba4ac4eaa2c85b6f1
                           .group:0000000000000000 wm4.string.h.15.dab3980bf35408a4c507182805e2de3a
                           .group:0000000000000000 wm4.stddef.h.158.a7efb00f6cbc6f43213b50e183c9830c
                           .group:0000000000000000 wm4.stdbool.h.29.1c9ee6859ce8145f7838a4f2549ccec2
                           .group:0000000000000000 wm4.hw_types.h.67.b10589a0806dcc2d274d6fab6b736519
                           .group:0000000000000000 wm4.interrupt.h.41.272fc4ec0e276feb439e7974d0f77eaf
                           .group:0000000000000000 wm4.board_info.h.22.aeb00002354a4949fff54190040e37af
                           .group:0000000000000000 wm4.opendefs.h.23.bdaf9c024be66ead04de21e3ce3dfaf2
                           .group:0000000000000000 wm4.crypto_engine.h.8.a3dd976cbcb92c44f852cc7aa252f659
                           .group:0000000000000000 wm4.schedule.h.2.80d40225a0ebadc3afa75a6755f49055
                           .group:0000000000000000 wm4.processIE.h.2.08a2f2ba75e9146930605c9ce967d701
                           .group:0000000000000000 wm4.IEEE802154E.h.25.7e65f5c386a4972498bd1c3f001ddfd0
                           .group:0000000000000000 wm4.idmanager.h.2.8c0e2159b32ef3125cbb1e984805cbfe
                           .group:0000000000000000 wm4.openserial.h.8.a9fe077ce3323e4f6730d3ecdff542cc
                           .group:0000000000000000 wm4.ieee802154_security_driver.h.7.3d8cd4c24aef7be2d5a63f05eff366e1
                           .group:0000000000000000 wm4.opentimers.h.8.044f2d040a134cdb0ddb58adfc2508be
                           .group:0000000000000000 wm4.icmpv6rpl.h.15.0573bca2230f8b0d62a096dd795549d0
                           .group:0000000000000000 wm4.neighbors.h.15.9f35f180a0332d1bc442efb0ec51905c

UNDEFINED SYMBOLS
memset
idmanager_getMyID
memcpy
packetfunctions_reserveHeaderSize
packetfunctions_writeAddress
openserial_printError
ieee154e_getAsn
packetfunctions_reserveFooterSize
board_crypto_engine
packetfunctions_readAddress
packetfunctions_tossFooter
IntMasterDisable
IntMasterEnable
packetfunctions_sameAddress
